<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <!-- MULTI-DEVICE WIDTH -->
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <!-- SITE DESCRIPTION -->
    
    <meta content="  The five rules of Scheme  The primitive car is defined only for non-empty lists.  The primitive cdr is defined only for non-empty lists.The cdr of any non-..." name="description"/>
    <!-- REFERER FOR 3RD-PART IMAGES-->
    <meta content="no-referrer" name="referrer"/>
    <!-- SITE TITLE -->
    <title>
        
            The Little Schemer
        
    </title>
    <!-- GLOBAL SCRIPT-->
    <script src="http://localhost:4000/src/assets/js/main.js" async></script>
    <!-- SITE ICON -->
    <link href="http://localhost:4000/src/assets/img/rubbish.png" rel="shortcut icon bookmark" type="image/x-icon"/>
    <!-- GLOBAL STYLESHEET -->
    <link rel="stylesheet" href="http://localhost:4000/src/assets/css/main.css" type="text/css"/> 
    <!-- SJCL -->
    <script src="http://localhost:4000/src/assets/js/sjcl.js" async></script>   
    <!-- FONTAWESOME < 4.7.0 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css"/>    
    <!-- FONTAWESOME > 4.7.0 -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.0/css/all.min.css" type="text/css"/> -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.0/css/svg-with-js.min.css" type="text/css"/> -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.0/css/regular.min.css" type="text/css"/> -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.0/css/solid.min.css" type="text/css"/> -->
    <!-- MATHJAX -->
    
    <!-- KATEX -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},    // $$ ... $$
                {left: '$', right: '$', display: false},     // $ ... $
                {left: '\\(', right: '\\)', display: false}, // \( ... \)
                {left: '\\[', right: '\\]', display: true},  // \[ ... \]
            ],
            ignoredTags: ["script", "noscript", "style", "textarea", "pre", "code", "option"], // ignore some html tags
            throwOnError: false
        });
    });
    </script>
    
    <!-- MERMAID -->
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.12.0/mermaid.min.js"></script>
    <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
    mermaid.initialize({
        startOnLoad: true,
        theme: 'dark',
        flowchart: { htmlLabels: true }
    });
    // 强制触发一次扫描，针对代码块
    await mermaid.run({
        querySelector: '.language-mermaid',
    });
    </script>
    
    <!-- The tag `feed_meta` is unrecognized by Github Pages -->
    <!-- Copy Code Button -->
    <script type="module">
        document.querySelectorAll('pre.highlight, .highlight pre').forEach((codeBox) => {
        // 1. 创建按钮
        const copyBtn = document.createElement('button');
        copyBtn.className = 'copy-code-button';
        copyBtn.type = 'button';
        copyBtn.innerText = 'Copy';

        // 2. 挂载按钮：通常挂载在 pre 的父级以便定位
        const container = codeBox.parentNode;
        container.style.position = 'relative'; 
        container.appendChild(copyBtn);

        // 3. 剪切板逻辑
        copyBtn.addEventListener('click', () => {
            const code = codeBox.innerText;
            window.navigator.clipboard.writeText(code).then(() => {
            copyBtn.innerText = 'Copied!';
            setTimeout(() => { copyBtn.innerText = 'Copy'; }, 2000);
            });
        });
        });
    </script>
    <!-- Bilingual.js -->
    
</head>
  <body class="page">
    <!-- background animations -->
<div class="div_bg">
    <canvas id="c"></canvas>
</div>
<script>
var c = document.getElementById("c");
var ctx = c.getContext("2d");
c.height = window.innerHeight;
c.width = window.innerWidth;
var txts = "αβγδεζηθικλμνξοπρστυφχψω∝∞∑∏∪∩∈∵∴⊥∠⊙≌∽√∀∂∆∇⋈∅∫∬∳∯∱∲ℂℍℚℝℕℙℤⅈⅉⅇℼℽℵ";
txts = txts.split("");
var font_size = 12;
var columns = c.width / font_size;
var drops = [];
for (var x = 0; x < columns; x++) drops[x] = 1;

function draw() {
  ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
  ctx.fillRect(0, 0, c.width, c.height);
  ctx.fillStyle = "#490";
  ctx.font = font_size + "px arial";
  for (var i = 0; i < drops.length; i++) {
    var text = txts[Math.floor(Math.random() * txts.length)];
    ctx.fillText(text, i * font_size, drops[i] * font_size);
    if (drops[i] * font_size > c.height || Math.random() > 0.98) drops[i] = 0;
    drops[i]++;
  }
}
setInterval(draw, 20);
</script>
    <!-- collection list, shown by click "archive" buttom in header -->
<div class="collection_list_container"  id="the_collection_list">
<div class="collection_list_background"  onclick="close_collection_list()"></div>
<div class="collection_list" onload="none">
    <div class="collection_list_header">
        <!-- TODO: search post -->
                                            <!-- <a class="search_btn">
      <i class="fa fa-search"> Search</i>
    </a>
    &nbsp; -->
        <table class="collection_list_header_title">
            <tr>
                <td>Archive:</td>
                <td id="clh_title"></td>
            </tr>
        </table>
        <div class="close_btn" onclick="close_collection_list()">
            <a class="close_btn_icon">
                <i class="fa fa-times"></i>
            </a>
        </div>
    </div>
    <div class="collection_name_list">
        <table class="vertical_center_table">
            <tr>
                <td>
                    <ul>
                        <!-- show all collections -->
                        <li>
                            <a class="a_collection_label" onclick="show_collection('all')">ALL
                            </a>
                        </li>
                        <!-- show a simple collection -->
                        
                            
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('phil')">
                                                
                                                    PHIL
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            
                                
                                    
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('litr')">
                                                
                                                    LITR
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('hist')">
                                                
                                                    HIST
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('psyc')">
                                                
                                                    PSYC
                                                
                                            </a>
                                        </li>
                                    
                                
                            
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('math')">
                                                
                                                    MATH
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('comp')">
                                                
                                                    COMP
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('phys')">
                                                
                                                    PHYS
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                            
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('misc')">
                                                
                                                    MISC
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            
                        
                    </ul>
                </td>
            </tr>
        </table>
    </div>
    <div class="posts_by_cate">
        <!-- post list in all collections -->
        <div class="post_list_in_1_collection" id="all">
            <table class="vertical_center_table">
                <tr>
                    <td>
                        <ul>
                            
                                
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    PHIL
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/n.intro.to.phil/">Introduction to Western Philosophy</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/prime/p.phil/">Western Philosophy - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/sheet/s.all-isms/">A Comprehesive Summary of All -ism in Western Tradition</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/annal/a.paradigm.shift/">Paradigm Shift of Western Philosophy</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/n.en.history.of.phil/">Outline of History of Western Philosophy</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/n.zh.history.of.phil/">西方哲学史大纲</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/t.kenny/">A New History of Western Philosophy</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/s.phil.language/">Quick Tutorial of Philosophy Language</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/s.phil.methodology/">Methodology of Philosophy</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/t.toolkit/">The Philosophier's Toolkit</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/n.epistemology/">Modern Epistemology</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/sheet/n.thinking.models/">A List of Thinking Models and Cognitive Structures</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/t.ctk/">Contemporary Theories of Knowledge</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/n.phenomenology/">Phenomenology</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/n.semiotics/">符号学笔记</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/p.marxism/">马克思主义的基础结构和发展</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/p-intro.to.analytic.phil/">Introduction to Analytic Philosophy</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/t.n.sayings/">Quotes and Original text of Philosophiers</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/t.online/">网络哲学文章</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/t.phil/">中文社区哲学学习辅助资料</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                                    
                                        
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    LITR
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/notes/n.lit.ontology/">Ontology of Literature</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/prime/p.lit/">Literature - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/annal/a.hist.literature.and.theory/">Timeline of the History of Literature and Literary Theory</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/annal/a.lit.works/">Timelines of Development of Western Literature</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/sheet/a.motifs/">Motifs of World Literature Tradition</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/notes/n.hist.lit/">History of Western Literature</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/notes/n.ideas.by.authors/">不同作家对于文学创作的理论和倾向</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/notes/n.lit.theory/">Western Literary Theory</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/prime/p.lit.theory/">Basic Problems in Literary Theory and Literary Criticism</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/notes/n.myths/">世界神话体系故事、神表和社会意识形态分析</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/notes/n.religion/">世界各宗教世界观、主张和主要经典</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/notes/n.narratology/">Narratology - the Theory of Narrative</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/prime/p.linguistics/">Linguistics - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/notes/n.characters/">How to Create Characters with Rich Inner Depth</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/notes/n.modernizing/">Modernizing Ancient Novels - A Comprehensive Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/sheet/s.variables/">写作者可操控变量的分层总结</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/notes/n.deep.reading.methods/">Deep Reading Methods for Literary Analysis and Craft</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/prime/s.reading.list/">文学阅读计划</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/texts/t.lolita.annotated/">The Annotated Lolita</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/texts/t.mocangli/">孤鸿寄语默苍离主要剧情</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/litr/texts/t.writing.principles/">Writing Principles of Talented Writers - A Personal Collection</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    HIST
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/prime/p.hist/">History - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/sheet/re.historical.division/">historical Division of World History</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/notes/n.history.of.historiography/">History of Weastern Historiography</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/a.global/">Highlighted Events in World History</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/a.egypt/">古代埃及史大纲</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/a.jp.timeline/">日本古代史时间线</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/a.middle.asia/">中亚古代史时间线</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/notes/n.cn.dynasty.and.idea/">中国历代主要思想观念及其对后世影响研究</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/o.eastern.asia/">东亚古代史时间线</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/notes/s.cn.historical.materials/">中国历代主要文字史料及其效力评判</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/a.acient.europe/">古代欧洲史时间线</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/a.europe/">Key Milestones in European History</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/s.eu.historical.division/">Historical Divisions of European History</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    PSYC
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/prime/p.psyc/">Psychology - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.1.sigmund.freud/">The Theory Architecture of Sigmund Freud</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.2.karl.young/">The Theory Architecture of Karl Young</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.3.alfred.adler/">The Theory Architecture of Alfred Adler</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.4.anna.freud/">The Theory Architecture of Anna Freud</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.5.melanie.klein/">The Theory Architecture of Anna Freud</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.6.donald.winnicott/">The Theory Architecture of Donald Winnicott</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.7.jacques.lacan/">The Theory Architecture of Jacques Lacan</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/prime/p.psychoanalysis/">Psychoanalysis - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/sheet/s.tips.for.better.human/">增加人类学习和工作能力的神经心理学和脑科学小技巧</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/texts/t.learning.how.to.learn/">Learning how to Learn</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/sheet/n.fallacies_n_bias/">Logical Fallacies and Cognitive Bias</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.low.latent.inhibition/">Low Latent Inhibition - Neurocognitive Mechanisms, Psychopathology, and Creativity</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.psychopathology.and.treatment/">常见心理疾病的介绍和精神药物简介</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.five.factor.model/">大五人格维度简介</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.male.displays/">Sexual Dysfunction and Compensatory Masculinity Performance</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    MATH
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/annal/a.history.math/">数学史和数学思想</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/prime/p.math/">Mathematics - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/prime/p.math.tools/">Learn Mathematics with Modern Tools and Workflow</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/sheet/s.elementary.mathematics/">基础数学速查表</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/sheet/s.latex/">Writing Mathematical Formulas in LaTeX</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/sheet/s.zh-en.terminology/">数学术语速查表</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/sheet/zh-en.termin/">数学术语速查表2</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.complex.analysis/">Complex Analysis</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.functional.analysis/">Funtioncal Analysis</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.math.analysis/">Mathematical Analysis</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.ode/">Ordinary Differential Equation</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.pde/">Partial Differential Equation</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.real.analysis/">Real Analysis</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.abstract.algebra/">Abstract Algebra</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.advanced.algebra/">Advanced Algebra</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.commutative.algebra/">Commutative Algebra</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.homological.algebra/">Homological Algebra</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.lie.algebra/">Lie Algebra</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.algebraic.geometry/">Algebraic Geometry</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.category.theory/">Category Theory</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.mathematical.logic/">Mathematical Logic</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.model.theory/">Model Theory</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.proof.theory/">Proof Theory</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.recursive.theory/">Recursive Theory</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.set.theory/">Axiomatic Set Theory</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    COMP
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.missing.semester.of.cs/">MIT Null, The Missing Semester of Your CS Education</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/prime/p.comp/">Computer Science - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.resources/">Learning Resource</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.win11.tweak.tools/">Best Windows 11 Tweak Tools</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.regex/">Regex - Basic Syntax and Practical Usage</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.tsql/">T-SQL Quick Reference and Usage</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.useful.ascii.art/">Useful ASCII Art</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.hardware.spec/">Linux - Check Hardware infomation and Specification</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.ibus.french.ime/">French Input Methods with ibus</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.linux.ai.utilities/">Linux Utilities and AI Tools</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.manjaro.i3wm/">Build Efficient working Environment with Manjaro and i3wm</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.nas.tutorial/">Low Power-Comsumption NAS Crafting</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.awk/">awk - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.find/">find - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.git/">git - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.grep/">grep - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/s.grub.conf/">Grub Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.i3wm/">awk - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.markdown/">markdown - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.sed/">sed - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.shell/">Linux Shell - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.xargs/">xargs - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.aesthetic/">Coding Aesthetic</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.debug/">Coding Debug Tips</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.emacs/">Emacs Quick Reference</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.ctmcp/">Concepts, Techniques, and Models of Computer Programming</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.eopl/">Essentials of Programming Languages</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.scheme.sicp/">Structure and Interpretation of Computer Programs</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.sicp/">Structure and Interpretation of Computer Programs</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.csapp/">Computer Systems, a Programmer's Perspective</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/texts/t.sf/">Software Foundations</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.css.js/">Web Development, HTML, CSS and Javascript</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.gpt.learning.booster/">Using ChatGPT as a Learning Assistant</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.prompt.engineering/">LLM Prompt Engineering for Study Assistance</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.chatgpt.prompts/">Frequently Used Prompts of ChatGPT for Learning and Research</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/python.tips/">Python Using Tips</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.pcl/">Practical Common Lisp</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.tls/">The Little Schemer</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.java/">Outdated Java Notes</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    PHYS
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/prime/n.classical.physics/">Classical Physics</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/prime/p.phys/">Physics - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/notes/n.cp/">宇宙学原理 Cosmological Principle</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/notes/n.fermi.paradox/">费米悖论 Fermi Paradox</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/sheet/n.nebula/">宇宙中美丽的星云</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/prime/p.cosmology/">Cosmology - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/sheet/s.cosmos/">宇宙中都有什么</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/sheet/s.star.atlas/">天区图 Sky Chart 和星图 Star Atlas</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/sheet/s.units.in.astronomy.and.cosmology/">Commonly Used Units in Astronomy and Cosmology</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    MISC
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/misc/notes/n.en.long.sentences.n.expressions/">Long Sentences in English</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/misc/notes/n.en.word.subtle.diff/">Subtle Differences Between English Words</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/misc/sheet/s.en.grammer/">英语语法速查表</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/misc/sheet/s.en.idioms/">English Collocations and Idioms</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/misc/sheet/s.en.latin.words/">Latin Words in English</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/misc/sheet/s.en.surnames.origins/">Surnames and Their Origins in English</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/misc/notes/t.en.elden.ring/">Elden Ring Dialogue in Order</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/misc/sheet/s.fr.grammar/">法语语法速查表</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/misc/sheet/s.fr.pronounce/">French Pronouncation Tips</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/misc/sheet/s.jp.grammer/">日语语法速查表</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                            
                        </ul>
                    </td>
                </tr>
            </table>
        </div>
        <!-- post list in a collection -->
        
            <div class="post_list_in_1_collection" id="comp">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.missing.semester.of.cs/">MIT Null, The Missing Semester of Your CS Education</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/prime/p.comp/">Computer Science - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.resources/">Learning Resource</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.win11.tweak.tools/">Best Windows 11 Tweak Tools</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.regex/">Regex - Basic Syntax and Practical Usage</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.tsql/">T-SQL Quick Reference and Usage</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.useful.ascii.art/">Useful ASCII Art</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.hardware.spec/">Linux - Check Hardware infomation and Specification</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.ibus.french.ime/">French Input Methods with ibus</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.linux.ai.utilities/">Linux Utilities and AI Tools</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.manjaro.i3wm/">Build Efficient working Environment with Manjaro and i3wm</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.nas.tutorial/">Low Power-Comsumption NAS Crafting</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.awk/">awk - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.find/">find - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.git/">git - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.grep/">grep - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/s.grub.conf/">Grub Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.i3wm/">awk - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.markdown/">markdown - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.sed/">sed - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.shell/">Linux Shell - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.xargs/">xargs - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.aesthetic/">Coding Aesthetic</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.debug/">Coding Debug Tips</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.emacs/">Emacs Quick Reference</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.ctmcp/">Concepts, Techniques, and Models of Computer Programming</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.eopl/">Essentials of Programming Languages</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.scheme.sicp/">Structure and Interpretation of Computer Programs</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.sicp/">Structure and Interpretation of Computer Programs</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.csapp/">Computer Systems, a Programmer's Perspective</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/texts/t.sf/">Software Foundations</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.css.js/">Web Development, HTML, CSS and Javascript</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.gpt.learning.booster/">Using ChatGPT as a Learning Assistant</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.prompt.engineering/">LLM Prompt Engineering for Study Assistance</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.chatgpt.prompts/">Frequently Used Prompts of ChatGPT for Learning and Research</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/python.tips/">Python Using Tips</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.pcl/">Practical Common Lisp</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.tls/">The Little Schemer</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.java/">Outdated Java Notes</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="hist">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/prime/p.hist/">History - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/sheet/re.historical.division/">historical Division of World History</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/notes/n.history.of.historiography/">History of Weastern Historiography</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/a.global/">Highlighted Events in World History</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/a.egypt/">古代埃及史大纲</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/a.jp.timeline/">日本古代史时间线</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/a.middle.asia/">中亚古代史时间线</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/notes/n.cn.dynasty.and.idea/">中国历代主要思想观念及其对后世影响研究</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/o.eastern.asia/">东亚古代史时间线</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/notes/s.cn.historical.materials/">中国历代主要文字史料及其效力评判</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/a.acient.europe/">古代欧洲史时间线</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/a.europe/">Key Milestones in European History</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/s.eu.historical.division/">Historical Divisions of European History</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="litr">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/notes/n.lit.ontology/">Ontology of Literature</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/prime/p.lit/">Literature - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/annal/a.hist.literature.and.theory/">Timeline of the History of Literature and Literary Theory</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/annal/a.lit.works/">Timelines of Development of Western Literature</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/sheet/a.motifs/">Motifs of World Literature Tradition</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/notes/n.hist.lit/">History of Western Literature</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/notes/n.ideas.by.authors/">不同作家对于文学创作的理论和倾向</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/notes/n.lit.theory/">Western Literary Theory</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/prime/p.lit.theory/">Basic Problems in Literary Theory and Literary Criticism</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/notes/n.myths/">世界神话体系故事、神表和社会意识形态分析</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/notes/n.religion/">世界各宗教世界观、主张和主要经典</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/notes/n.narratology/">Narratology - the Theory of Narrative</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/prime/p.linguistics/">Linguistics - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/notes/n.characters/">How to Create Characters with Rich Inner Depth</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/notes/n.modernizing/">Modernizing Ancient Novels - A Comprehensive Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/sheet/s.variables/">写作者可操控变量的分层总结</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/notes/n.deep.reading.methods/">Deep Reading Methods for Literary Analysis and Craft</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/prime/s.reading.list/">文学阅读计划</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/texts/t.lolita.annotated/">The Annotated Lolita</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/texts/t.mocangli/">孤鸿寄语默苍离主要剧情</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/litr/texts/t.writing.principles/">Writing Principles of Talented Writers - A Personal Collection</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="math">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/math/annal/a.history.math/">数学史和数学思想</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/math/prime/p.math/">Mathematics - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/math/prime/p.math.tools/">Learn Mathematics with Modern Tools and Workflow</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/math/sheet/s.elementary.mathematics/">基础数学速查表</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/math/sheet/s.latex/">Writing Mathematical Formulas in LaTeX</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/math/sheet/s.zh-en.terminology/">数学术语速查表</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/math/sheet/zh-en.termin/">数学术语速查表2</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.complex.analysis/">Complex Analysis</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.functional.analysis/">Funtioncal Analysis</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.math.analysis/">Mathematical Analysis</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.ode/">Ordinary Differential Equation</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.pde/">Partial Differential Equation</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.real.analysis/">Real Analysis</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.abstract.algebra/">Abstract Algebra</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.advanced.algebra/">Advanced Algebra</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.commutative.algebra/">Commutative Algebra</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.homological.algebra/">Homological Algebra</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.lie.algebra/">Lie Algebra</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.algebraic.geometry/">Algebraic Geometry</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.category.theory/">Category Theory</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.mathematical.logic/">Mathematical Logic</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.model.theory/">Model Theory</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.proof.theory/">Proof Theory</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.recursive.theory/">Recursive Theory</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.set.theory/">Axiomatic Set Theory</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="misc">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/misc/notes/n.en.long.sentences.n.expressions/">Long Sentences in English</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/misc/notes/n.en.word.subtle.diff/">Subtle Differences Between English Words</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/misc/sheet/s.en.grammer/">英语语法速查表</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/misc/sheet/s.en.idioms/">English Collocations and Idioms</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/misc/sheet/s.en.latin.words/">Latin Words in English</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/misc/sheet/s.en.surnames.origins/">Surnames and Their Origins in English</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/misc/notes/t.en.elden.ring/">Elden Ring Dialogue in Order</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/misc/sheet/s.fr.grammar/">法语语法速查表</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/misc/sheet/s.fr.pronounce/">French Pronouncation Tips</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/misc/sheet/s.jp.grammer/">日语语法速查表</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="phil">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/n.intro.to.phil/">Introduction to Western Philosophy</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/prime/p.phil/">Western Philosophy - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/sheet/s.all-isms/">A Comprehesive Summary of All -ism in Western Tradition</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/annal/a.paradigm.shift/">Paradigm Shift of Western Philosophy</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/n.en.history.of.phil/">Outline of History of Western Philosophy</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/n.zh.history.of.phil/">西方哲学史大纲</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/t.kenny/">A New History of Western Philosophy</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/s.phil.language/">Quick Tutorial of Philosophy Language</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/s.phil.methodology/">Methodology of Philosophy</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/t.toolkit/">The Philosophier's Toolkit</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/n.epistemology/">Modern Epistemology</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/sheet/n.thinking.models/">A List of Thinking Models and Cognitive Structures</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/t.ctk/">Contemporary Theories of Knowledge</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/n.phenomenology/">Phenomenology</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/n.semiotics/">符号学笔记</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/p.marxism/">马克思主义的基础结构和发展</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/p-intro.to.analytic.phil/">Introduction to Analytic Philosophy</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/t.n.sayings/">Quotes and Original text of Philosophiers</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/t.online/">网络哲学文章</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/t.phil/">中文社区哲学学习辅助资料</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="phys">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/prime/n.classical.physics/">Classical Physics</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/prime/p.phys/">Physics - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/notes/n.cp/">宇宙学原理 Cosmological Principle</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/notes/n.fermi.paradox/">费米悖论 Fermi Paradox</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/sheet/n.nebula/">宇宙中美丽的星云</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/prime/p.cosmology/">Cosmology - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/sheet/s.cosmos/">宇宙中都有什么</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/sheet/s.star.atlas/">天区图 Sky Chart 和星图 Star Atlas</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/sheet/s.units.in.astronomy.and.cosmology/">Commonly Used Units in Astronomy and Cosmology</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="posts">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E9%80%86%E6%97%B6%E9%97%B4/">逆时间</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[散文随笔]</a>
                                            <a class="a_title" href="http://localhost:4000/%E4%B8%8D%E8%A6%81%E9%9A%8F%E4%BE%BF%E4%BA%A4%E6%9C%8B%E5%8F%8B/">嘿！不要随便交朋友</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[散文随笔]</a>
                                            <a class="a_title" href="http://localhost:4000/%E4%B8%BA%E4%BB%80%E4%B9%88%E7%88%B1%E8%AE%B2%E9%81%93%E7%90%86/">为什么那么多人喜欢讲道理</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E7%AD%89%E5%BE%85%E7%9D%80%E7%9A%84%E5%A5%B3%E5%AD%A9/">等待着的女孩</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E5%9F%8E%E5%A0%A1%E9%87%8C%E7%9A%84%E7%8C%AB%E5%92%8C%E9%AD%94%E6%B3%95%E6%AF%9B%E7%BA%BF%E7%90%83/">城堡里的猫和魔法毛线球</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E9%97%AE%E5%89%91%E5%B4%96%E4%B8%8A/">问剑崖上</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E7%99%BD%E7%BE%8A%E6%95%B0%E5%92%8C%E4%BC%90%E6%9C%A8%E5%B7%A5/">白羊树和伐木工</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E9%B8%A1%E8%9B%8B%E5%92%8C%E9%94%A4%E5%AD%90/">鸡蛋和锤子</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E6%9C%A8%E5%81%B6%E5%92%8C%E6%93%8D%E5%81%B6%E5%B8%88/">木偶和木偶戏演员</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[原文摘录]</a>
                                            <a class="a_title" href="http://localhost:4000/%E6%95%99%E5%91%98%E7%9A%84%E9%A1%B6%E7%BA%A7%E8%AE%A4%E7%9F%A5%E6%8F%90%E5%8D%87%E6%96%B9%E6%B3%95/">教员的顶级认知提升方法</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[学习方法]</a>
                                            <a class="a_title" href="http://localhost:4000/%E7%89%B9%E7%A7%8D%E5%85%B5%E5%AD%A6%E4%B9%A0/">一个高度理想化的“特种兵”学习流程</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[阅读笔记]</a>
                                            <a class="a_title" href="http://localhost:4000/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%E4%BC%A4%E9%80%9D/">鲁迅《伤逝》阅读笔记</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[阅读笔记]</a>
                                            <a class="a_title" href="http://localhost:4000/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%E7%B4%A0%E9%A3%9F%E8%80%85/">韩江《素食者》三部曲阅读笔记</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[学习方法]</a>
                                            <a class="a_title" href="http://localhost:4000/%E5%BA%94%E8%AF%95%E6%95%B0%E5%AD%A6%E7%9A%84%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/">应试数学的学习方法</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[散文随笔]</a>
                                            <a class="a_title" href="http://localhost:4000/%E6%8A%80%E8%83%BD%E4%BA%94%E5%AD%90%E6%A3%8B/">《技能五子棋》的喜剧内核是年轻人对东亚困境的反叛</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[散文随笔]</a>
                                            <a class="a_title" href="http://localhost:4000/%E4%B8%96%E7%95%8C%E5%90%84%E7%A7%8D%E7%B1%BB%E4%BA%BA%E6%89%8D%E7%9A%84%E8%B0%83%E6%9F%A5%E6%8A%A5%E5%91%8A/">世界各种类人才的调查报告</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[学习方法]</a>
                                            <a class="a_title" href="http://localhost:4000/%E8%B5%9B%E5%8D%9A%E6%99%AE%E7%BD%97%E7%B1%B3%E4%BF%AE%E6%96%AF/">赛博普罗米修斯：程序员掌握先进生产力</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[社会观察]</a>
                                            <a class="a_title" href="http://localhost:4000/OCE/">组织层级指数、组织形态谱及其哲学原理</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="psyc">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/prime/p.psyc/">Psychology - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.1.sigmund.freud/">The Theory Architecture of Sigmund Freud</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.2.karl.young/">The Theory Architecture of Karl Young</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.3.alfred.adler/">The Theory Architecture of Alfred Adler</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.4.anna.freud/">The Theory Architecture of Anna Freud</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.5.melanie.klein/">The Theory Architecture of Anna Freud</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.6.donald.winnicott/">The Theory Architecture of Donald Winnicott</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.7.jacques.lacan/">The Theory Architecture of Jacques Lacan</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/prime/p.psychoanalysis/">Psychoanalysis - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/sheet/s.tips.for.better.human/">增加人类学习和工作能力的神经心理学和脑科学小技巧</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/texts/t.learning.how.to.learn/">Learning how to Learn</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/sheet/n.fallacies_n_bias/">Logical Fallacies and Cognitive Bias</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.low.latent.inhibition/">Low Latent Inhibition - Neurocognitive Mechanisms, Psychopathology, and Creativity</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.psychopathology.and.treatment/">常见心理疾病的介绍和精神药物简介</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.five.factor.model/">大五人格维度简介</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.male.displays/">Sexual Dysfunction and Compensatory Masculinity Performance</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
    </div>
</div>
</div>
    <div class="container" id="ctner">
       <div class="header">
  <table class="vertical_center_table">
    <tr>
      <td>
        <nav class="nav_bar">
          <ul>
            <!-- left header -->
            <li class="li_left">
              <!-- open collection tree -->
              
              <a class="header_btn" onclick="open_collection_list()">
                <i class="fa fa-trash btn_icon"></i>
                  
                  <p class="btn_text">Rubbish</p>
                  
              </a>
              
              <!-- home -->
              
              <a class="header_btn" href="http://localhost:4000">
                <i class="fa fa-home btn_icon"></i>
                  
                  <p class="btn_text">Bin</p>
                  
              </a>
              
              <!-- bilingual -->
              
              <!-- maximize -->
              
              <a class="header_btn" id="mxmz_btn" onclick="toggle_maximize()">
                <i class="fa fa-window-maximize btn_icon"></i>
                  
                  <p class="btn_text" id="mxmz_text">Maximize</p>
                  
              </a>
              
              <!-- access token -->
              
            </li>
            <!-- right header -->
            <span class="span_right">
              
               <!-- back to top -->
               <a class="header_btn" id="back_to_top_btn" href="#top_hook">
                <i class="fa fa-fast-backward btn_icon"></i>
                  
                  <p class="btn_text">Top</p>
                  
              </a>
              <!-- scroll up -->
              <a class="header_btn" onclick="scroll_percentage(-0.88)">
                <i class="fa fa-backward btn_icon"></i>
                  
                  <p class="btn_text">Prev</p>
                  
              </a>
              <!-- scroll down -->
              <a class="header_btn" onclick="scroll_percentage(0.88)">
                <i class="fa fa-forward btn_icon"></i>
                  
                  <p class="btn_text">Next</p>
                  
              </a>
              <!-- popup table of content -->
              <a class="header_btn popup_btn" onclick="toggle_toc()">
                <i class="fa fa-list btn_icon"></i>
                  
                  <p class="btn_text">Index</p>
                  
              </a>
              
            </span>
          </ul>
        </nav>
        <!-- <hr /> -->
      </td>
    </tr>
  </table>
</div>
<!-- table of content -->

<div class="div_toc toc" id="popup_toc">
  
  <!-- generate toc -->
  <ul class="ul_toc" id="ul_toc"><li><a href="#chapter-2-do-it-again">Chapter 2 Do It Again</a></li><li><a href="#chapter-3-cons-the-magnificents">Chapter 3 Cons The Magnificents</a></li><li><a href="#chapter-4-numbers-games">Chapter 4 Numbers Games</a></li><li><a href="#chapter-5-its-full-of-stars">Chapter 5 It’s Full of Stars</a></li><li><a href="#chapter-6-shadows">Chapter 6 Shadows</a></li><li><a href="#chapter-8-lambda-the-ultimate">Chapter 8 Lambda the Ultimate</a><ul><li><a href="#explaination-of-continuation-in-chapter-8">explaination-of-continuation-in-chapter-8</a></li></ul></li><li><a href="#chapter-9-and-again-and-again-and-again-">Chapter 9 …and Again, and Again, and Again, …</a></li><li><a href="#chapter-10-what-is-the-value-of-all-this">Chapter 10 What Is the Value of All This?</a></li></ul>
</div>

<!-- toggle maximize -->

<script>
  var ctner_state = 0;
  var ctner = document.getElementById("ctner");
</script>

<!-- encrypt and decrypt -->


      <div class="div_article" id="div_atcl">
        <div class="hook" id="top_hook"></div>
        <article
          id="main_atcl"
          itemscope
          itemtype="http://schema.org/BlogPosting"
        >
          <h1 id="The Little Schemer">The Little Schemer</h1>
<div class="post_info">
  <!-- author -->
  
  <!-- date -->
  
  <!-- category -->
  
  <span>
    <i class="fa fa-archive"></i>
      Notes
  </span>
  
  <!-- tags -->
  
  <span>
    <i class="fa fa-tag"></i>
    
        Lisp
      
    
  </span>
  
</div>
<!-- abstract -->


<br />
<div class="content">
<ol>
  <li>The five rules of Scheme</li>
  <li>The primitive car is defined only for non-empty lists.</li>
  <li>The primitive cdr is defined only for non-empty lists.The cdr of any non-empty list is always another list.</li>
  <li>The primitive cons takes two arguments. The second argument to cons must be a list. The result is a list.</li>
  <li>The primitive null? is defined ONLY FOR LISTS.</li>
  <li>
    <p>The primitive eq? takes two arguments.Each must be a non-numeric atom.</p>
  </li>
  <li>The ten commandments</li>
  <li>Recurring
    * When recurring on a list of atoms, lat, ask two questions about it: (null? lat) and else.
    * When recurring on a number, n, ask two questions about it: (zero? n) and else.
    * When recurring on a list of S-expressions, l, ask three questions about it: (null? l), (atom? (car l)), and else.</li>
  <li>Use cons to build lists.</li>
  <li>When building a list, describe the first typical elemetn, and then cons it onto the nutural recursion.</li>
  <li>Always change at least one argument while recurring.
    * When recurring on a list of atoms, lat, use (cdr lat).
    * When recurring on an number, n, use (sub1 n).
    * When recurring on a list of S-expressions, l, use (car l) and (cdr l) if neither (null? l) nor (atom? (car l)) are ture.</li>
  <li>It must be changed to be closer to termination.The changing argument must be tested in termination condition:
    * When using car, test termination with null?
    * When using sub1, test termination with zero?.</li>
  <li>Building a value:
    * When building a value with +, always use 0 for the value of the terminating lien, for adding 0 does not change the value of an addition.
    * When building a value with *, always use 1 for the value of the terminating line, for multiplying by 1 does not change the value of a multiplication.
    * When building a value with cons, always consider () for the value of the terminating line.</li>
  <li>Simplify only after the function is correct.</li>
  <li>Recur on the subparts that are of the same nature:
    * On the sublist of a list.
    * On the subexpression of an arithmetic expression.</li>
  <li>Use help functions to abstract from representations.</li>
  <li>Abstract common patterns with a new function.</li>
  <li>Build functions to collect more than one values at a time.</li>
</ol>

<h2 id="chapter-2-do-it-again">Chapter 2 Do It Again</h2>

<div class="language-scheme highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">define</span> <span class="nv">atom?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">x</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">lat?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">lat?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else</span> <span class="no">#f</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">member?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
                <span class="p">(</span><span class="nf">member?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>
</code></pre></div></div>
<h2 id="chapter-3-cons-the-magnificents">Chapter 3 Cons The Magnificents</h2>

<div class="language-scheme highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;; Remove Member</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">rember</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span>
                  <span class="p">(</span><span class="nf">rember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">firsts</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">firsts</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>

<span class="p">(</span><span class="nf">firsts</span> <span class="o">'</span><span class="p">((</span><span class="nf">apple</span> <span class="nv">peach</span> <span class="nv">pumpkin</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">plum</span> <span class="nv">pear</span> <span class="nv">cherry</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">grape</span> <span class="nv">raisin</span> <span class="nv">pea</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">bean</span> <span class="nv">carrot</span> <span class="nv">eggplant</span><span class="p">)))</span>      <span class="c1">; Returns: '(apple plum grape bean)</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">insertR</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">insertR</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">insertL</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">insertL</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="c1">;; Substitute</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">subst</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">subst</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">subst2</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">o1</span> <span class="nv">o2</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="k">or</span> <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">o1</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">o2</span><span class="p">))</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">subst</span> <span class="nv">new</span> <span class="nv">o1</span> <span class="nv">o2</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">multirember</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">multirember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">multirember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">multiinsertR</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nf">multiinsertR</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">multiinsertR</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">multiinsertL</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">old</span> <span class="p">(</span><span class="nf">multiinsertL</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">multiinsertL</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">multisubst</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nf">multisubst</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">multisubst</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>
</code></pre></div></div>

<h2 id="chapter-4-numbers-games">Chapter 4 Numbers Games</h2>

<div class="language-scheme highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">define</span> <span class="nv">add1</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">sub1</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">o+</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="nv">m</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">o+</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">o-</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="nv">m</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">sub1</span> <span class="p">(</span><span class="nf">o-</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">addtup</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">tup</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">tup</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">o+</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">tup</span><span class="p">)</span> <span class="p">(</span><span class="nf">addtup</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">tup</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">o*</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="nv">m</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">o+</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">o*</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">tup+</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">tup1</span> <span class="nv">tup2</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
     <span class="p">((</span><span class="nb">null?</span> <span class="nv">tup1</span><span class="p">)</span> <span class="nv">tup2</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">null?</span> <span class="nv">tup2</span><span class="p">)</span> <span class="nv">tup1</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else</span>
      <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">o+</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">tup2</span><span class="p">))</span>
            <span class="p">(</span><span class="nf">tup+</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">tup2</span><span class="p">)))))))</span>

<span class="p">(</span><span class="nf">tup+</span> <span class="o">'</span><span class="p">(</span><span class="nf">3</span> <span class="mi">7</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">4</span> <span class="mi">6</span> <span class="mi">8</span> <span class="mi">1</span><span class="p">))</span>            <span class="c1">; '(7 13 8 1)</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">o&gt;</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="nv">n</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="nv">m</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">o&gt;</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">o&lt;</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="nv">m</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="nv">n</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">o&lt;</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">o=</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">o&gt;</span> <span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="nf">o&lt;</span> <span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="no">#t</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">o^</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="nv">m</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">o*</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">o^</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">o/</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">o&lt;</span> <span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">o/</span> <span class="p">(</span><span class="nf">o-</span> <span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="nv">m</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">olength</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">olength</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">pick</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">pick</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">rempick</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">rempick</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">no-nums</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">number?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nf">no-nums</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">no-nums</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">all-nums</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">number?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">all-nums</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">all-nums</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">eqan?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a1</span> <span class="nv">a2</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">a1</span><span class="p">)</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">a2</span><span class="p">))</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">a1</span> <span class="nv">a2</span><span class="p">))</span>
      <span class="p">((</span><span class="k">or</span>  <span class="p">(</span><span class="nb">number?</span> <span class="nv">a1</span><span class="p">)</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">a2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">eq?</span> <span class="nv">a1</span> <span class="nv">a2</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">occur</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">occur</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">occur</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">one?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">rempick-one</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">one?</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">rempick-one</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="nf">rempick-one</span> <span class="mi">4</span> <span class="o">'</span><span class="p">(</span><span class="nf">hotdogs</span> <span class="nv">with</span> <span class="nv">hot</span> <span class="nv">mustard</span><span class="p">))</span>     <span class="c1">; '(hotdogs with mustard)</span>

</code></pre></div></div>
<h2 id="chapter-5-its-full-of-stars">Chapter 5 It’s Full of Stars</h2>

<div class="language-scheme highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">; * means can delete things in parathesis</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">rember*</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
       <span class="p">(</span><span class="k">cond</span>
         <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))</span>
         <span class="p">(</span><span class="k">else</span>
           <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">insertR*</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
       <span class="p">(</span><span class="k">cond</span>
         <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">cons</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))</span>
         <span class="p">(</span><span class="k">else</span>
           <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">occur*</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
       <span class="p">(</span><span class="k">cond</span>
         <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">occur*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))</span>
         <span class="p">(</span><span class="k">else</span>
           <span class="p">(</span><span class="nf">occur*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">occur*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">occur*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">insertL*</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
       <span class="p">(</span><span class="k">cond</span>
         <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">old</span> <span class="p">(</span><span class="nf">insertL*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))</span>
         <span class="p">(</span><span class="k">else</span>
           <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">insertL*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">insertL*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">insertL*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">member*</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
       <span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">member*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="nf">member*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
            <span class="p">(</span><span class="nf">member*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">leftmost</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">leftmost</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">eqlist?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l1</span> <span class="nv">l2</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="c1">; case 1: l1 is empty, l2 is empty, atom, list</span>
      <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">l2</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l2</span><span class="p">)))</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l1</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="c1">; case 2: l1 is atom, l2 is empty, atom, list</span>
      <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l1</span><span class="p">))</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">l2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l1</span><span class="p">))</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l2</span><span class="p">)))</span>
       <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l2</span><span class="p">))</span>
            <span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l2</span><span class="p">))))</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l1</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
      <span class="c1">; case 3: l1 is a list, l2 is empty, atom, list</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l2</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l2</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l2</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">eqlist2?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l1</span> <span class="nv">l2</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="c1">; case 1: l1 is empty, l2 is empty, atom, list</span>
      <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">l2</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">((</span><span class="k">or</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">l2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
      <span class="c1">; case 2: l1 is atom, l2 is empty, atom, list</span>
      <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l1</span><span class="p">))</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l2</span><span class="p">)))</span>
       <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l2</span><span class="p">))</span>
            <span class="p">(</span><span class="nf">eqlist2?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l2</span><span class="p">))))</span>
      <span class="p">((</span><span class="k">or</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l1</span><span class="p">))</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l2</span><span class="p">)))</span>
       <span class="no">#f</span><span class="p">)</span>
      <span class="c1">; case 3: l1 is a list, l2 is empty, atom, list</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">eqlist2?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l2</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">eqlist2?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l2</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">equal??</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
     <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nf">atom?</span> <span class="nv">s1</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom?</span> <span class="nv">s2</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">eq?</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">))</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="nv">s1</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="nv">s2</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">eqlist?</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">equal2??</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nf">atom?</span> <span class="nv">s1</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom?</span> <span class="nv">s2</span><span class="p">))</span>
       <span class="p">(</span><span class="nb">eq?</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">))</span>
      <span class="p">((</span><span class="k">or</span> <span class="p">(</span><span class="nf">atom?</span> <span class="nv">s1</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom?</span> <span class="nv">s2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">eqlist?</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">eqlist3?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l1</span> <span class="nv">l2</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="k">and</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">l2</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">((</span><span class="k">or</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">l2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">equal2??</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l2</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">equal2??</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l2</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">rember</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">s</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
     <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
     <span class="p">((</span><span class="nf">equal2??</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">rember</span> <span class="nv">s</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>
</code></pre></div></div>

<h2 id="chapter-6-shadows">Chapter 6 Shadows</h2>

<div class="language-scheme highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">define</span> <span class="nv">numbered?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">aexp</span><span class="p">)</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">aexp</span><span class="p">))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">))</span> <span class="ss">'o+</span><span class="p">)</span>
       <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">numbered?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">aexp</span><span class="p">))</span>
            <span class="p">(</span><span class="nf">numbered?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">))))))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">))</span> <span class="ss">'ox</span><span class="p">)</span>
       <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">numbered?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">aexp</span><span class="p">))</span>
            <span class="p">(</span><span class="nf">numbered?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">))))))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">))</span> <span class="ss">'o^</span><span class="p">)</span>
       <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">numbered?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">aexp</span><span class="p">))</span>
            <span class="p">(</span><span class="nf">numbered?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">))))))</span>
      <span class="p">(</span><span class="k">else</span> <span class="no">#f</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">numbered?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">aexp</span><span class="p">)</span> <span class="p">(</span><span class="nb">number?</span> <span class="nv">aexp</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nf">numbered?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">aexp</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">numbered?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">)))))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">value</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">nexp</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">nexp</span><span class="p">)</span> <span class="nv">nexp</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))</span> <span class="ss">'o+</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">nexp</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))))))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))</span> <span class="ss">'o*</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">nexp</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))))))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))</span> <span class="ss">'o^</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">expt</span> <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">nexp</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))))))</span>
      <span class="p">(</span><span class="k">else</span> <span class="no">#f</span><span class="p">))))</span>

<span class="c1">; Examples of value</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">value</span> <span class="mi">13</span><span class="p">)</span>                                   <span class="c1">; 13</span>
<span class="p">(</span><span class="nf">value</span> <span class="o">'</span><span class="p">(</span><span class="nf">1</span> <span class="nv">o+</span> <span class="mi">3</span><span class="p">))</span>                            <span class="c1">; 4</span>
<span class="p">(</span><span class="nf">value</span> <span class="o">'</span><span class="p">(</span><span class="nf">1</span> <span class="nv">o+</span> <span class="p">(</span><span class="nf">3</span> <span class="nv">o^</span> <span class="mi">4</span><span class="p">)))</span>                     <span class="c1">; 82</span>

<span class="c1">; The value function for prefix notation</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">value-prefix</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">nexp</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">nexp</span><span class="p">)</span> <span class="nv">nexp</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">nexp</span><span class="p">)</span> <span class="ss">'o+</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">value-prefix</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">)))</span>
          <span class="p">(</span><span class="nf">value-prefix</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))))))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">nexp</span><span class="p">)</span> <span class="ss">'o*</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">value-prefix</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">)))</span>
          <span class="p">(</span><span class="nf">value-prefix</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))))))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">nexp</span><span class="p">)</span> <span class="ss">'o^</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">expt</span> <span class="p">(</span><span class="nf">value-prefix</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">)))</span>
             <span class="p">(</span><span class="nf">value-prefix</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))))))</span>
      <span class="p">(</span><span class="k">else</span> <span class="no">#f</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="mi">1</span><span class="nv">st-sub-exp</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="mi">2</span><span class="nv">nd-sub-exp</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">operator</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="nv">aexp</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">value-prefix-helper</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">nexp</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">nexp</span><span class="p">)</span> <span class="nv">nexp</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nf">operator</span> <span class="nv">nexp</span><span class="p">)</span> <span class="ss">'o+</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">value-prefix</span> <span class="p">(</span><span class="nf">1st-sub-exp</span> <span class="nv">nexp</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">value-prefix</span> <span class="p">(</span><span class="nf">2nd-sub-exp</span> <span class="nv">nexp</span><span class="p">))))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">nexp</span><span class="p">)</span> <span class="ss">'o*</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">value-prefix</span> <span class="p">(</span><span class="nf">1st-sub-exp</span> <span class="nv">nexp</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">value-prefix</span> <span class="p">(</span><span class="nf">2nd-sub-exp</span> <span class="nv">nexp</span><span class="p">))))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">nexp</span><span class="p">)</span> <span class="ss">'o^</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">expt</span> <span class="p">(</span><span class="nf">value-prefix</span> <span class="p">(</span><span class="nf">1st-sub-exp</span> <span class="nv">nexp</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">value-prefix</span> <span class="p">(</span><span class="nf">2nd-sub-exp</span> <span class="nv">nexp</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">else</span> <span class="no">#f</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="mi">1</span><span class="nv">st-sub-exp</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="nv">aexp</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="mi">2</span><span class="nv">nd-sub-exp</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">operator</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">sero?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">null?</span> <span class="nv">n</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">edd1</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cons</span> <span class="o">'</span><span class="p">()</span> <span class="nv">n</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">zub1</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cdr</span> <span class="nv">n</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="o">.</span><span class="nv">+</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">sero?</span> <span class="nv">m</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">edd1</span> <span class="p">(</span><span class="o">.</span><span class="nv">+</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">zub1</span> <span class="nv">m</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">tat?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">tat?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else</span> <span class="no">#f</span><span class="p">))))</span>
</code></pre></div></div>

<h2 id="chapter-8-lambda-the-ultimate">Chapter 8 Lambda the Ultimate</h2>

<div class="language-scheme highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">define</span> <span class="nv">atom?</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">x</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">eq?-c</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span><span class="p">)</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">eq?</span> <span class="nv">a</span> <span class="nv">x</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">rember-f</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">test?</span><span class="p">)</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span>
        <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
        <span class="p">((</span><span class="nf">test?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="p">((</span><span class="nf">rember-f</span> <span class="nv">test?</span><span class="p">)</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">rember-eq?</span> <span class="p">(</span><span class="nf">rember-f</span> <span class="nv">eq?</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">insertL-f</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">test?</span><span class="p">)</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span>
        <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
        <span class="p">((</span><span class="nf">test?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
         <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="p">((</span><span class="nf">insertL-f</span> <span class="nv">test?</span><span class="p">)</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">insertR-f</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">test?</span><span class="p">)</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span>
        <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
        <span class="p">((</span><span class="nf">test?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
         <span class="p">(</span><span class="nb">cons</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="p">((</span><span class="nf">insertR-f</span> <span class="nv">test?</span><span class="p">)</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">seqR</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cons</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="nv">l</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">insert-g</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">seq</span><span class="p">)</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span>
        <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
        <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">seq</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="p">((</span><span class="nf">insert-g</span> <span class="nv">seq</span><span class="p">)</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">seqL</span> <span class="ss">'TODO</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">insertL</span> <span class="p">(</span><span class="nf">insert-g</span> <span class="nv">seqL</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">insertR</span> <span class="p">(</span><span class="nf">insert-g</span> <span class="nv">seqR</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">insertL</span>
  <span class="p">(</span><span class="nf">insert-g</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">subst-f</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">subst</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">seqS</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="nv">l</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">subst</span> <span class="p">(</span><span class="nf">insert-g</span> <span class="nv">seqS</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">yyy</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">((</span><span class="nf">insert-g</span> <span class="nv">seqrem</span><span class="p">)</span> <span class="no">#f</span> <span class="nv">a</span> <span class="nv">l</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">seqrem</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
    <span class="nv">l</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">value</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">nexp</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">nexp</span><span class="p">)</span> <span class="nv">nexp</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))</span> <span class="ss">'o+</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">nexp</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))))))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))</span> <span class="ss">'o*</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">nexp</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))))))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))</span> <span class="ss">'o^</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">expt</span> <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">nexp</span><span class="p">))</span>
             <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">nexp</span><span class="p">))))))</span>
      <span class="p">(</span><span class="k">else</span> <span class="no">#f</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">atom-to-function</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">atom</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">atom</span> <span class="ss">'o+</span><span class="p">)</span> <span class="nv">+</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">atom</span> <span class="ss">'o*</span><span class="p">)</span> <span class="nv">*</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">atom</span> <span class="ss">'o^</span><span class="p">)</span> <span class="nv">expt</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="no">#f</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">operator</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="nv">aexp</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">value</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">nexp</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">nexp</span><span class="p">)</span> <span class="nv">nexp</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">((</span><span class="nf">atom-to-function</span> <span class="p">(</span><span class="nf">operator</span> <span class="nv">nexp</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nf">1st-sub-exp</span> <span class="nv">nexp</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nf">2nd-sub-exp</span> <span class="nv">nexp</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="mi">1</span><span class="nv">st-sub-exp</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="mi">2</span><span class="nv">nd-sub-exp</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">aexp</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">multirember</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">multirember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">multirember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">multirember-f</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">test?</span><span class="p">)</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span>
        <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
        <span class="p">((</span><span class="nf">test?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
         <span class="p">((</span><span class="nf">multirember-f</span> <span class="nv">test?</span><span class="p">)</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="p">((</span><span class="nf">multirember-f</span> <span class="nv">test?</span><span class="p">)</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">multirember-eq?</span> <span class="p">(</span><span class="nf">multirember-f</span> <span class="nv">eq?</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">multiremberT</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">test?</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nf">test?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">multiremberT</span> <span class="nv">test?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">multiremberT</span> <span class="nv">test?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">eq?-tuna</span>
  <span class="p">(</span><span class="nf">eq?-c</span> <span class="ss">'tuna</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">multiremember&amp;co</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">col</span> <span class="o">'</span><span class="p">()</span> <span class="o">'</span><span class="p">()))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">multiremember&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)</span>
       <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">col</span> <span class="nv">newlat</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">seen</span><span class="p">)))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">multiremember&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)</span>
                          <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
                            <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">)</span> <span class="nv">seen</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">a-friend</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">null?</span> <span class="nv">y</span><span class="p">)))</span>


<span class="p">(</span><span class="k">define</span> <span class="nv">new-friend</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">a-friend</span> <span class="nv">newlat</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'tuna</span> <span class="nv">seen</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">last-friend</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">length</span> <span class="nv">x</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">multiinsertLR</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">oldL</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span>
             <span class="p">(</span><span class="nb">cons</span> <span class="nv">oldL</span>
                   <span class="p">(</span><span class="nf">multiinsertLR</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">oldR</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="nv">oldR</span>
             <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span>
                   <span class="p">(</span><span class="nf">multiinsertLR</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span>
          <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">multiinsertLR</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">multiinsertLR&amp;co</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">col</span> <span class="o">'</span><span class="p">()</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">oldL</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">multiinsertLR&amp;co</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)</span>
                         <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)</span>
                           <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">oldL</span> <span class="nv">newlat</span><span class="p">))</span>
                                <span class="p">(</span><span class="nb">+</span> <span class="mi">1</span> <span class="nv">L</span><span class="p">)</span> <span class="nv">R</span><span class="p">))))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">oldR</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">multiinsertLR&amp;co</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)</span>
                         <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)</span>
                           <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">new</span> <span class="nv">newlat</span><span class="p">))</span>
                                <span class="nv">L</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">1</span> <span class="nv">R</span><span class="p">)))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">multiinsertLR&amp;co</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">)</span>
                          <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)</span>
                            <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">)</span>
                                 <span class="nv">L</span> <span class="nv">R</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">col1</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">lat</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)</span>
    <span class="nv">lat</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">col2</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">lat</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)</span>
    <span class="nv">L</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">col3</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">lat</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)</span>
    <span class="nv">R</span><span class="p">))</span>

<span class="c1">; Examples of multiinsertLR&amp;co</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">multiinsertLR&amp;co</span>
  <span class="ss">'salty</span>
  <span class="ss">'fish</span>
  <span class="ss">'chips</span>
  <span class="o">'</span><span class="p">(</span><span class="nf">chips</span> <span class="nv">and</span> <span class="nv">fish</span> <span class="nv">or</span> <span class="nv">fish</span> <span class="nv">and</span> <span class="nv">chips</span><span class="p">)</span>
  <span class="nv">col1</span><span class="p">)</span>
<span class="c1">; ==&gt; '(chips salty and salty fish or salty fish and chips salty)</span>
<span class="p">(</span><span class="nf">multiinsertLR&amp;co</span>
  <span class="ss">'salty</span>
  <span class="ss">'fish</span>
  <span class="ss">'chips</span>
  <span class="o">'</span><span class="p">(</span><span class="nf">chips</span> <span class="nv">and</span> <span class="nv">fish</span> <span class="nv">or</span> <span class="nv">fish</span> <span class="nv">and</span> <span class="nv">chips</span><span class="p">)</span>
  <span class="nv">col2</span><span class="p">)</span>
<span class="c1">; ==&gt; 2</span>
<span class="p">(</span><span class="nf">multiinsertLR&amp;co</span>
  <span class="ss">'salty</span>
  <span class="ss">'fish</span>
  <span class="ss">'chips</span>
  <span class="o">'</span><span class="p">(</span><span class="nf">chips</span> <span class="nv">and</span> <span class="nv">fish</span> <span class="nv">or</span> <span class="nv">fish</span> <span class="nv">and</span> <span class="nv">chips</span><span class="p">)</span>
  <span class="nv">col3</span><span class="p">)</span>
<span class="c1">; ==&gt; 2</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">evens-only*</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
       <span class="p">(</span><span class="k">cond</span>
         <span class="p">((</span><span class="nb">even?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
          <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span>
                <span class="p">(</span><span class="nf">evens-only*</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))</span>
         <span class="p">(</span><span class="k">else</span>
           <span class="p">(</span><span class="nf">evens-only*</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">evens-only*</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
              <span class="p">(</span><span class="nf">evens-only*</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">evens-only*&amp;co</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">col</span> <span class="o">'</span><span class="p">()</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
       <span class="p">(</span><span class="k">cond</span>
         <span class="p">((</span><span class="nb">even?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">evens-only*&amp;co</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)</span>
                          <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newl</span> <span class="nv">p</span> <span class="nv">s</span><span class="p">)</span>
                            <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">newl</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">p</span><span class="p">)</span> <span class="nv">s</span><span class="p">))))</span>
         <span class="p">(</span><span class="k">else</span>
           <span class="p">(</span><span class="nf">evens-only*&amp;co</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)</span>
                           <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newl</span> <span class="nv">p</span> <span class="nv">s</span><span class="p">)</span>
                             <span class="p">(</span><span class="nf">col</span> <span class="nv">newl</span> <span class="nv">p</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">s</span><span class="p">)))))))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">evens-only*&amp;co</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">l</span><span class="p">)</span>
                        <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">al</span> <span class="nv">ap</span> <span class="nv">as</span><span class="p">)</span>
                          <span class="p">(</span><span class="nf">evens-only*&amp;co</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)</span>
                                          <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">dl</span> <span class="nv">dp</span> <span class="nv">ds</span><span class="p">)</span>
                                            <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">al</span> <span class="nv">dl</span><span class="p">)</span>
                                                 <span class="p">(</span><span class="nb">*</span> <span class="nv">ap</span> <span class="nv">dp</span><span class="p">)</span>
                                                 <span class="p">(</span><span class="nb">+</span> <span class="nv">as</span> <span class="nv">ds</span><span class="p">))))))))))</span>

<span class="c1">; evens-friend returns collected evens</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">evens-friend</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span> <span class="nv">p</span> <span class="nv">s</span><span class="p">)</span>
    <span class="nv">e</span><span class="p">))</span>

<span class="c1">; Example of evens-friend used</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">evens-only*&amp;co</span>
  <span class="o">'</span><span class="p">((</span><span class="nf">9</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">8</span><span class="p">)</span> <span class="mi">3</span> <span class="mi">10</span> <span class="p">((</span><span class="nf">9</span> <span class="mi">9</span><span class="p">)</span> <span class="mi">7</span> <span class="mi">6</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
  <span class="nv">evens-friend</span><span class="p">)</span>
<span class="c1">; ==&gt; '((2 8) 10 (() 6) 2)</span>

<span class="c1">; evens-product-friend returns the product of evens</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">evens-product-friend</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span> <span class="nv">p</span> <span class="nv">s</span><span class="p">)</span>
    <span class="nv">p</span><span class="p">))</span>

<span class="c1">; Example of evens-product-friend used</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">evens-only*&amp;co</span>
  <span class="o">'</span><span class="p">((</span><span class="nf">9</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">8</span><span class="p">)</span> <span class="mi">3</span> <span class="mi">10</span> <span class="p">((</span><span class="nf">9</span> <span class="mi">9</span><span class="p">)</span> <span class="mi">7</span> <span class="mi">6</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
  <span class="nv">evens-product-friend</span><span class="p">)</span>
<span class="c1">; ==&gt; 1920</span>

<span class="c1">; evens-sum-friend returns the sum of odds</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">evens-sum-friend</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span> <span class="nv">p</span> <span class="nv">s</span><span class="p">)</span>
    <span class="nv">s</span><span class="p">))</span>

<span class="c1">; Example of evens-sum-friend used</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">evens-only*&amp;co</span>
  <span class="o">'</span><span class="p">((</span><span class="nf">9</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">8</span><span class="p">)</span> <span class="mi">3</span> <span class="mi">10</span> <span class="p">((</span><span class="nf">9</span> <span class="mi">9</span><span class="p">)</span> <span class="mi">7</span> <span class="mi">6</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
  <span class="nv">evens-sum-friend</span><span class="p">)</span>
<span class="c1">; ==&gt; 38</span>

<span class="c1">; the-last-friend returns sum, product and the list of evens consed together</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">the-last-friend</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span> <span class="nv">p</span> <span class="nv">s</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cons</span> <span class="nv">s</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">p</span> <span class="nv">e</span><span class="p">))))</span>

<span class="c1">; Example of the-last-friend</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">evens-only*&amp;co</span>
  <span class="o">'</span><span class="p">((</span><span class="nf">9</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">8</span><span class="p">)</span> <span class="mi">3</span> <span class="mi">10</span> <span class="p">((</span><span class="nf">9</span> <span class="mi">9</span><span class="p">)</span> <span class="mi">7</span> <span class="mi">6</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
  <span class="nv">the-last-friend</span><span class="p">)</span>
<span class="c1">; ==&gt; '(38 1920 (2 8) 10 (() 6) 2)</span>

</code></pre></div></div>
<h3 id="explaination-of-continuation-in-chapter-8">explaination-of-continuation-in-chapter-8</h3>

<p>Let’s step through an example; maybe that will help. :-) For simplicity, I’m just going to use listas the collector/continuation, which will just return a list with the arguments to the continuation.</p>

<div class="language-scheme highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nf">multirember&amp;co</span> <span class="ss">'foo</span> <span class="o">'</span><span class="p">(</span><span class="nf">foo</span> <span class="nv">bar</span><span class="p">)</span> <span class="nv">list</span><span class="p">)</span>
<span class="nv">At</span> <span class="nv">the</span> <span class="nv">start,a</span> <span class="nv">=</span> <span class="ss">'foo</span>
<span class="nv">lat</span> <span class="nv">=</span> <span class="o">'</span><span class="p">(</span><span class="nf">foo</span> <span class="nv">bar</span><span class="p">)</span>
<span class="nv">col</span> <span class="nv">=</span> <span class="nv">list</span>
<span class="nv">At</span> <span class="nv">the</span> <span class="nv">first</span> <span class="nv">iteration,</span> <span class="nv">the</span> <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">condition</span> <span class="nv">matches,</span> <span class="nv">since</span> <span class="nv">lat</span> <span class="nv">is</span> <span class="nv">not</span> <span class="nv">empty,</span> <span class="nv">and</span> <span class="nv">the</span> <span class="nv">first</span> <span class="nv">element</span> <span class="nv">of</span> <span class="nv">lat</span> <span class="nv">is</span> <span class="ss">'foo</span><span class="o">.</span> <span class="nv">This</span> <span class="nv">sets</span> <span class="nv">up</span> <span class="nv">the</span> <span class="nv">next</span> <span class="nv">recursion</span> <span class="nv">to</span> <span class="nv">multirember&amp;co</span> <span class="nv">thusly:a</span> <span class="nv">=</span> <span class="ss">'foo</span>
<span class="nv">lat</span> <span class="nv">=</span> <span class="o">'</span><span class="p">(</span><span class="nf">bar</span><span class="p">)</span>
<span class="nv">col</span> <span class="nv">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">list</span> <span class="nv">newlat</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'foo</span> <span class="nv">seen</span><span class="p">))</span>
<span class="nv">At</span> <span class="nv">the</span> <span class="nv">next</span> <span class="nv">iteration,</span> <span class="nv">the</span> <span class="nv">else</span> <span class="nv">matches:</span> <span class="nv">since</span> <span class="nv">lat</span> <span class="nv">is</span> <span class="nv">not</span> <span class="nv">empty,</span> <span class="nv">and</span> <span class="nv">the</span> <span class="nv">first</span> <span class="nv">element</span> <span class="nv">of</span> <span class="nv">lat</span> <span class="nv">is</span> <span class="ss">'bar</span> <span class="p">(</span><span class="k">and</span> <span class="nv">not</span> <span class="ss">'foo</span><span class="p">)</span><span class="o">.</span> <span class="nv">Thus,</span> <span class="nv">for</span> <span class="nv">the</span> <span class="nv">next</span> <span class="nv">recursion,</span> <span class="nv">we</span> <span class="nv">then</span> <span class="nv">have:a</span> <span class="nv">=</span> <span class="ss">'foo</span>
<span class="nv">lat</span> <span class="nv">=</span> <span class="o">'</span><span class="p">()</span>
<span class="nv">col</span> <span class="nv">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
        <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
           <span class="p">(</span><span class="nb">list</span> <span class="nv">newlat</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'foo</span> <span class="nv">seen</span><span class="p">)))</span>
         <span class="p">(</span><span class="nb">cons</span> <span class="ss">'bar</span> <span class="nv">newlat</span><span class="p">)</span>
         <span class="nv">seen</span><span class="p">))</span>
<span class="nv">For</span> <span class="nv">ease</span> <span class="nv">of</span> <span class="nv">human</span> <span class="nv">reading</span> <span class="p">(</span><span class="k">and</span> <span class="nv">avoid</span> <span class="nv">confusion</span><span class="p">)</span><span class="o">,</span> <span class="nv">we</span> <span class="nv">can</span> <span class="nv">rename</span> <span class="nv">the</span> <span class="nv">parameters</span> <span class="p">(</span><span class="nf">due</span> <span class="nv">to</span> <span class="nv">lexical</span> <span class="nv">scoping</span><span class="p">)</span><span class="o">,</span> <span class="nv">without</span> <span class="nv">any</span> <span class="nv">change</span> <span class="nv">to</span> <span class="nv">the</span> <span class="nv">program</span><span class="ss">'s</span> <span class="nv">semantics:col</span> <span class="nv">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat1</span> <span class="nv">seen1</span><span class="p">)</span>
        <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat2</span> <span class="nv">seen2</span><span class="p">)</span>
           <span class="p">(</span><span class="nb">list</span> <span class="nv">newlat2</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'foo</span> <span class="nv">seen2</span><span class="p">)))</span>
         <span class="p">(</span><span class="nb">cons</span> <span class="ss">'bar</span> <span class="nv">newlat1</span><span class="p">)</span>
         <span class="nv">seen1</span><span class="p">))</span>
<span class="nv">Finally,</span> <span class="nv">the</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">clause</span> <span class="nv">matches,</span> <span class="nv">since</span> <span class="nv">lat</span> <span class="nv">is</span> <span class="nv">now</span> <span class="nv">empty</span><span class="o">.</span> <span class="nv">So</span> <span class="nv">we</span> <span class="nv">call</span><span class="p">(</span><span class="nf">col</span> <span class="o">'</span><span class="p">()</span> <span class="o">'</span><span class="p">())</span>
<span class="nv">which</span> <span class="nv">expands</span> <span class="nv">to:</span><span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat1</span> <span class="nv">seen1</span><span class="p">)</span>
   <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat2</span> <span class="nv">seen2</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">list</span> <span class="nv">newlat2</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'foo</span> <span class="nv">seen2</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">cons</span> <span class="ss">'bar</span> <span class="nv">newlat1</span><span class="p">)</span>
    <span class="nv">seen1</span><span class="p">))</span>
 <span class="o">'</span><span class="p">()</span> <span class="o">'</span><span class="p">())</span>
<span class="nv">which</span> <span class="p">(</span><span class="nf">when</span> <span class="nv">substituting</span> <span class="nv">newlat1</span> <span class="nv">=</span> <span class="o">'</span><span class="p">()</span> <span class="nv">and</span> <span class="nv">seen1</span> <span class="nv">=</span> <span class="o">'</span><span class="p">())</span> <span class="nv">becomes</span><span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat2</span> <span class="nv">seen2</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">list</span> <span class="nv">newlat2</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'foo</span> <span class="nv">seen2</span><span class="p">)))</span>
 <span class="p">(</span><span class="nb">cons</span> <span class="ss">'bar</span> <span class="o">'</span><span class="p">())</span>
 <span class="o">'</span><span class="p">())</span>
<span class="nv">or</span> <span class="p">(</span><span class="nf">evaluating</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'bar</span> <span class="o">'</span><span class="p">()))((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">newlat2</span> <span class="nv">seen2</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">list</span> <span class="nv">newlat2</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'foo</span> <span class="nv">seen2</span><span class="p">)))</span>
 <span class="o">'</span><span class="p">(</span><span class="nf">bar</span><span class="p">)</span>
 <span class="o">'</span><span class="p">())</span>
<span class="nv">Now,</span> <span class="nv">substituting</span> <span class="nv">the</span> <span class="nv">values</span> <span class="nv">newlat2</span> <span class="nv">=</span> <span class="o">'</span><span class="p">(</span><span class="nf">bar</span><span class="p">)</span> <span class="nv">and</span> <span class="nv">seen2</span> <span class="nv">=</span> <span class="o">'</span><span class="p">()</span><span class="o">,</span> <span class="nv">we</span> <span class="nv">get</span><span class="p">(</span><span class="nb">list</span> <span class="o">'</span><span class="p">(</span><span class="nf">bar</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'foo</span> <span class="o">'</span><span class="p">()))</span>
<span class="nv">or,</span> <span class="nv">in</span> <span class="nv">other</span> <span class="nv">words,</span><span class="p">(</span><span class="nb">list</span> <span class="o">'</span><span class="p">(</span><span class="nf">bar</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">foo</span><span class="p">))</span>
<span class="nv">to</span> <span class="nv">give</span> <span class="nv">our</span> <span class="nv">final</span> <span class="nv">result</span> <span class="nv">of</span><span class="o">'</span><span class="p">((</span><span class="nf">bar</span><span class="p">)</span> <span class="p">(</span><span class="nf">foo</span><span class="p">))</span>
</code></pre></div></div>

<h2 id="chapter-9-and-again-and-again-and-again-">Chapter 9 …and Again, and Again, and Again, …</h2>

<div class="language-scheme highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">; The pick function returns the n-th element in a lat</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">pick</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">pick</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))))))</span>

<span class="c1">; Functions like looking are called partial functions.</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">looking</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">keep-looking</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">pick</span> <span class="mi">1</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">lat</span><span class="p">)))</span>

<span class="c1">; Example of looking</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">looking</span> <span class="ss">'caviar</span> <span class="o">'</span><span class="p">(</span><span class="nf">6</span> <span class="mi">2</span> <span class="mi">4</span> <span class="nv">caviar</span> <span class="mi">5</span> <span class="mi">7</span> <span class="mi">3</span><span class="p">))</span>         <span class="c1">; #t</span>
<span class="p">(</span><span class="nf">looking</span> <span class="ss">'caviar</span> <span class="o">'</span><span class="p">(</span><span class="nf">6</span> <span class="mi">2</span> <span class="nv">grits</span> <span class="nv">caviar</span> <span class="mi">5</span> <span class="mi">7</span> <span class="mi">3</span><span class="p">))</span>     <span class="c1">; #f</span>

<span class="c1">; It does not recur on a part of lat.</span>
<span class="c1">; It is truly unnatural.</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">keep-looking</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">sorn</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">number?</span> <span class="nv">sorn</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">keep-looking</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">pick</span> <span class="nv">sorn</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nb">eq?</span> <span class="nv">sorn</span> <span class="nv">a</span> <span class="p">)))))</span>

<span class="c1">; It is the most partial function.</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">eternity</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">eternity</span> <span class="nv">x</span><span class="p">)))</span>

<span class="c1">; Helper functions for working with pairs</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">first</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">p</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="nv">p</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">second</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">p</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">p</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">build</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cons</span> <span class="nv">s1</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">s2</span> <span class="o">'</span><span class="p">()))))</span>

<span class="c1">; The function shift takes a pair whose first component is a pair</span>
<span class="c1">; and builds a pair by shifting the second part of the first component</span>
<span class="c1">; into the second component</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">shift</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">pair</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">first</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pair</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">second</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pair</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">second</span> <span class="nv">pair</span><span class="p">)))))</span>

<span class="c1">; Example of shift</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">shift</span> <span class="o">'</span><span class="p">((</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">c</span><span class="p">))</span>                            <span class="c1">; '(a (b c))</span>
<span class="p">(</span><span class="nf">shift</span> <span class="o">'</span><span class="p">((</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))</span>                        <span class="c1">; '(a (b (c d)))</span>

<span class="c1">; The a-pair? function determines if it's a pair</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">a-pair?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">x</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">x</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">x</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">x</span><span class="p">)))</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="no">#f</span><span class="p">))))</span>

<span class="c1">; We first need to define atom? for Scheme as it's not a primitive</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">atom?</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">x</span><span class="p">)))))</span>

<span class="c1">; align is not a partial function, because it yields a value for every argument.</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">align</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">pora</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">pora</span><span class="p">)</span> <span class="nv">pora</span><span class="p">)</span>
      <span class="p">((</span><span class="nf">a-pair?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pora</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">align</span> <span class="p">(</span><span class="nf">shift</span> <span class="nv">pora</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pora</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">align</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">pora</span><span class="p">)))))))</span>

<span class="c1">; counts the number of atoms in align's arguments</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">length*</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">pora</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">pora</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">length*</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pora</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">length*</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">pora</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">weight*</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">pora</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">pora</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">weight*</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pora</span><span class="p">))</span> <span class="mi">2</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">weight*</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">pora</span><span class="p">)))))))</span>

<span class="c1">; Example of weight*</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">weight*</span> <span class="o">'</span><span class="p">((</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">c</span><span class="p">))</span>                          <span class="c1">; 7</span>
<span class="p">(</span><span class="nf">weight*</span> <span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="p">(</span><span class="nf">b</span> <span class="nv">c</span><span class="p">))</span>                           <span class="c1">; 5</span>

<span class="c1">; Let's simplify revrel by using inventing revpair that reverses a pair</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">revpair</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">p</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">p</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">shuffle</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">pora</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">pora</span><span class="p">)</span> <span class="nv">pora</span><span class="p">)</span>
      <span class="p">((</span><span class="nf">a-pair?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pora</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">shuffle</span> <span class="p">(</span><span class="nf">revpair</span> <span class="nv">pora</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pora</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">shuffle</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">pora</span><span class="p">)))))))</span>

<span class="c1">; Example of shuffle</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">shuffle</span> <span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="p">(</span><span class="nf">b</span> <span class="nv">c</span><span class="p">)))</span>                          <span class="c1">; '(a (b c))</span>
<span class="p">(</span><span class="nf">shuffle</span> <span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">))</span>                              <span class="c1">; '(a b)</span>
<span class="p">(</span><span class="nf">shuffle</span> <span class="o">'</span><span class="p">((</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))</span>                      <span class="c1">; infinite swap pora  Ctrl + c  to break and input q to exit</span>

<span class="c1">; The one? function is true when n=1</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">one?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>

<span class="c1">; not total function</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">C</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">one?</span> <span class="nv">n</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="k">cond</span>
          <span class="p">((</span><span class="nb">even?</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">C</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">)))</span>
          <span class="p">(</span><span class="k">else</span>
            <span class="p">(</span><span class="nf">C</span> <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">*</span> <span class="mi">3</span> <span class="nv">n</span><span class="p">)))))))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">A</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">add1</span> <span class="nv">m</span><span class="p">))</span>
      <span class="p">((</span><span class="nb">zero?</span> <span class="nv">m</span><span class="p">)</span> <span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">A</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">)))))))</span>

<span class="c1">; Example of A</span>
<span class="p">(</span><span class="nf">A</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span>                                       <span class="c1">; 2</span>
<span class="p">(</span><span class="nf">A</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span>                                       <span class="c1">; 3</span>
<span class="p">(</span><span class="nf">A</span> <span class="mi">2</span> <span class="mi">2</span><span class="p">)</span>                                       <span class="c1">; 7</span>

<span class="c1">; length0</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span>
    <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">(</span><span class="k">else</span>
      <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">eternity</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))</span>

<span class="c1">; length&lt;=1</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span>
    <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">(</span><span class="k">else</span>
      <span class="p">(</span><span class="nf">add1</span>
        <span class="p">((</span><span class="k">lambda</span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
           <span class="p">(</span><span class="k">cond</span>
             <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
             <span class="p">(</span><span class="k">else</span>
               <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">eternity</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))</span>
         <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))</span>

<span class="c1">; All these programs contain a function that looks like length.</span>
<span class="c1">; Perhaps we should abstract out this function.</span>

<span class="c1">; rewrite length0</span>
<span class="c1">;</span>
<span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nb">length</span><span class="p">)</span>
   <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
     <span class="p">(</span><span class="k">cond</span>
       <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
       <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">length</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>
 <span class="nv">eternity</span><span class="p">)</span>

<span class="c1">; rewrite length&lt;=1</span>
<span class="c1">;</span>
<span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">f</span><span class="p">)</span>
   <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
     <span class="p">(</span><span class="k">cond</span>
       <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
       <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>
 <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">g</span><span class="p">)</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span>
        <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">g</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>
  <span class="nv">eternity</span><span class="p">))</span>

<span class="c1">; make length</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">eternity</span><span class="p">))</span>

<span class="c1">; rewrite length&lt;=1</span>
<span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
   <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
     <span class="p">(</span><span class="k">cond</span>
       <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
       <span class="p">(</span><span class="k">else</span>
         <span class="p">(</span><span class="nf">add1</span>
           <span class="p">((</span><span class="nf">mk-length</span> <span class="nv">eternity</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))))</span>

<span class="c1">; It's (length '(1 2 3 4 5))</span>
<span class="c1">;</span>
<span class="p">(((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
   <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
     <span class="p">(</span><span class="k">cond</span>
       <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
       <span class="p">(</span><span class="k">else</span>
         <span class="p">(</span><span class="nf">add1</span>
           <span class="p">((</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))))</span>
 <span class="o">'</span><span class="p">(</span><span class="nf">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1">; 5</span>


<span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
   <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nb">length</span><span class="p">)</span>
      <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
        <span class="p">(</span><span class="k">cond</span>
          <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
          <span class="p">(</span><span class="k">else</span>
            <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">length</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))))</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
      <span class="p">((</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))))</span>

<span class="c1">; move out length function</span>
<span class="c1">;</span>
<span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">le</span><span class="p">)</span>
   <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">le</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
            <span class="p">((</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">)</span> <span class="nv">x</span><span class="p">))))))</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nb">length</span><span class="p">)</span>
   <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
     <span class="p">(</span><span class="k">cond</span>
       <span class="p">((</span><span class="nb">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
       <span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">length</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">))))))))</span>

<span class="c1">; Y</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">le</span><span class="p">)</span>
  <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
   <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">le</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
           <span class="p">((</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">)</span> <span class="nv">x</span><span class="p">))))))</span>

<span class="c1">; it is called the applicative-order Y combinator.</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">Y</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">le</span><span class="p">)</span>
    <span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">f</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">f</span><span class="p">))</span>
     <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">f</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">le</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">((</span><span class="nf">f</span> <span class="nv">f</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))))))</span>

</code></pre></div></div>
<h2 id="chapter-10-what-is-the-value-of-all-this">Chapter 10 What Is the Value of All This?</h2>

<div class="language-scheme highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">define</span> <span class="nv">atom?</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">and</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">x</span><span class="p">)))))</span>
<span class="c1">; An entry is a pair of lists whose first list is a set. The two lists must be</span>
<span class="c1">; of equal length.</span>
<span class="c1">; Here are some entry examples.</span>
<span class="c1">;</span>
<span class="o">'</span><span class="p">((</span><span class="nf">appetizer</span> <span class="nv">entree</span> <span class="nv">bevarage</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">pate</span> <span class="nv">boeuf</span> <span class="nv">vin</span><span class="p">))</span>
<span class="o">'</span><span class="p">((</span><span class="nf">appetizer</span> <span class="nv">entree</span> <span class="nv">bevarage</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">beer</span> <span class="nv">beer</span> <span class="nv">beer</span><span class="p">))</span>
<span class="o">'</span><span class="p">((</span><span class="nf">bevarage</span> <span class="nv">dessert</span><span class="p">)</span>
  <span class="p">((</span><span class="nf">food</span> <span class="nv">is</span><span class="p">)</span> <span class="p">(</span><span class="nf">number</span> <span class="nv">one</span> <span class="nv">with</span> <span class="nv">us</span><span class="p">)))</span>

<span class="c1">; Let's build entries with build from chapter 7 (07-friends-and-relations.ss)</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">build</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cons</span> <span class="nv">s1</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">s2</span> <span class="o">'</span><span class="p">()))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">new-entry</span> <span class="nv">build</span><span class="p">)</span>

<span class="c1">; Test it out and build the example entries above</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">build</span> <span class="o">'</span><span class="p">(</span><span class="nf">appetizer</span> <span class="nv">entree</span> <span class="nv">bevarage</span><span class="p">)</span>
       <span class="o">'</span><span class="p">(</span><span class="nf">pate</span> <span class="nv">boeuf</span> <span class="nv">vin</span><span class="p">))</span>
<span class="p">(</span><span class="nf">build</span> <span class="o">'</span><span class="p">(</span><span class="nf">appetizer</span> <span class="nv">entree</span> <span class="nv">bevarage</span><span class="p">)</span>
       <span class="o">'</span><span class="p">(</span><span class="nf">beer</span> <span class="nv">beer</span> <span class="nv">beer</span><span class="p">))</span>
<span class="p">(</span><span class="nf">build</span> <span class="o">'</span><span class="p">(</span><span class="nf">bevarage</span> <span class="nv">dessert</span><span class="p">)</span>
       <span class="o">'</span><span class="p">((</span><span class="nf">food</span> <span class="nv">is</span><span class="p">)</span> <span class="p">(</span><span class="nf">number</span> <span class="nv">one</span> <span class="nv">with</span> <span class="nv">us</span><span class="p">)))</span>

<span class="c1">; We'll need first and second functions from chapter 7</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">first</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">p</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="nv">p</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">second</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">p</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">p</span><span class="p">))))</span>

<span class="c1">; And also third, later.</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">third</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">l</span><span class="p">)))))</span>

<span class="c1">; The lookup-in-entry function looks in an entry to find the value by name</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">lookup-in-entry</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">name</span> <span class="nv">entry</span> <span class="nv">entry-f</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">lookup-in-entry-help</span>
      <span class="nv">name</span>
      <span class="p">(</span><span class="nf">first</span> <span class="nv">entry</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">second</span> <span class="nv">entry</span><span class="p">)</span>
      <span class="nv">entry-f</span><span class="p">)))</span>

<span class="c1">; lookup-in-entry uses lookup-in-entry-help helper function</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">lookup-in-entry-help</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">name</span> <span class="nv">names</span> <span class="nv">values</span> <span class="nv">entry-f</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">names</span><span class="p">)</span> <span class="p">(</span><span class="nf">entry-f</span> <span class="nv">name</span><span class="p">))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">names</span><span class="p">)</span> <span class="nv">name</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">values</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">lookup-in-entry-help</span>
          <span class="nv">name</span>
          <span class="p">(</span><span class="nb">cdr</span> <span class="nv">names</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">cdr</span> <span class="nv">values</span><span class="p">)</span>
          <span class="nv">entry-f</span><span class="p">)))))</span>

<span class="c1">; Let's try out lookup-in-entry</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">lookup-in-entry</span>
  <span class="ss">'entree</span>
  <span class="o">'</span><span class="p">((</span><span class="nf">appetizer</span> <span class="nv">entree</span> <span class="nv">bevarage</span><span class="p">)</span> <span class="p">(</span><span class="nf">pate</span> <span class="nv">boeuf</span> <span class="nv">vin</span><span class="p">))</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span> <span class="o">'</span><span class="p">()))</span>
<span class="c1">; ==&gt; 'boeuf</span>

<span class="p">(</span><span class="nf">lookup-in-entry</span>
  <span class="ss">'no-such-item</span>
  <span class="o">'</span><span class="p">((</span><span class="nf">appetizer</span> <span class="nv">entree</span> <span class="nv">bevarage</span><span class="p">)</span> <span class="p">(</span><span class="nf">pate</span> <span class="nv">boeuf</span> <span class="nv">vin</span><span class="p">))</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span> <span class="o">'</span><span class="p">()))</span>
<span class="c1">; ==&gt; '()</span>

<span class="c1">; A table (also called an environment) is a list of entries. Here are some</span>
<span class="c1">; examples.</span>
<span class="c1">;</span>
<span class="o">'</span><span class="p">()</span>
<span class="o">'</span><span class="p">(((</span><span class="nf">appetizer</span> <span class="nv">entree</span> <span class="nv">beverage</span><span class="p">)</span> <span class="p">(</span><span class="nf">pate</span> <span class="nv">boeuf</span> <span class="nv">vin</span><span class="p">))</span>
  <span class="p">((</span><span class="nf">beverage</span> <span class="nv">dessert</span><span class="p">)</span> <span class="p">((</span><span class="nf">food</span> <span class="nv">is</span><span class="p">)</span> <span class="p">(</span><span class="nf">number</span> <span class="nv">one</span> <span class="nv">with</span> <span class="nv">us</span><span class="p">))))</span>

<span class="c1">; The extend-table function takes an entry and a table and adds entry to the</span>
<span class="c1">; table</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">extend-table</span> <span class="nv">cons</span><span class="p">)</span>

<span class="c1">; lookup-in-table finds an entry in a table</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">lookup-in-table</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">name</span> <span class="nv">table</span> <span class="nv">table-f</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">table</span><span class="p">)</span> <span class="p">(</span><span class="nf">table-f</span> <span class="nv">name</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">lookup-in-entry</span>
          <span class="nv">name</span>
          <span class="p">(</span><span class="nb">car</span> <span class="nv">table</span><span class="p">)</span>
          <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">name</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">lookup-in-table</span>
              <span class="nv">name</span>
              <span class="p">(</span><span class="nb">cdr</span> <span class="nv">table</span><span class="p">)</span>
              <span class="nv">table-f</span><span class="p">)))))))</span>

<span class="c1">; Let's try lookup-in-table</span>
<span class="c1">;</span>
<span class="p">(</span><span class="nf">lookup-in-table</span>
  <span class="ss">'beverage</span>
  <span class="o">'</span><span class="p">(((</span><span class="nf">entree</span> <span class="nv">dessert</span><span class="p">)</span> <span class="p">(</span><span class="nf">spaghetti</span> <span class="nv">spumoni</span><span class="p">))</span>
    <span class="p">((</span><span class="nf">appetizer</span> <span class="nv">entree</span> <span class="nv">beverage</span><span class="p">)</span> <span class="p">(</span><span class="nf">food</span> <span class="nv">tastes</span> <span class="nv">good</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">n</span><span class="p">)</span> <span class="o">'</span><span class="p">()))</span>
<span class="c1">; ==&gt; 'good</span>

<span class="c1">; Expressions to actions</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">expression-to-action</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom-to-action</span> <span class="nv">e</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">list-to-action</span> <span class="nv">e</span><span class="p">)))))</span>

<span class="c1">; Atom to action</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">atom-to-action</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">number?</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="no">#t</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="no">#f</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="ss">'cons</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="ss">'car</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="ss">'cdr</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="ss">'null?</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="ss">'eq?</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="ss">'atom?</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="ss">'zero?</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="ss">'add1</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="ss">'sub1</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="ss">'number?</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="nv">*identifier</span><span class="p">))))</span>

<span class="c1">; List to action</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">list-to-action</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">e</span><span class="p">))</span>
       <span class="p">(</span><span class="k">cond</span>
         <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">e</span><span class="p">)</span> <span class="ss">'quote</span><span class="p">)</span> <span class="nv">*quote</span><span class="p">)</span>
         <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">e</span><span class="p">)</span> <span class="ss">'lambda</span><span class="p">)</span> <span class="nv">*lambda</span><span class="p">)</span>
         <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">e</span><span class="p">)</span> <span class="ss">'cond</span><span class="p">)</span> <span class="nv">*cond</span><span class="p">)</span>
         <span class="p">(</span><span class="k">else</span> <span class="nv">*application</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else</span> <span class="nv">*application</span><span class="p">))))</span>

<span class="c1">; The value function takes an expression and evaulates it</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">value</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">meaning</span> <span class="nv">e</span> <span class="o">'</span><span class="p">())))</span>

<span class="c1">; The meaning function translates an expression to its meaning</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">meaning</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
    <span class="p">((</span><span class="nf">expression-to-action</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">)))</span>

<span class="c1">; Now the various actions. Let's start with *const</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">*const</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">number?</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">e</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="no">#t</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">e</span> <span class="no">#f</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">build</span> <span class="ss">'primitive</span> <span class="nv">e</span><span class="p">)))))</span>

<span class="c1">; *quote: (quote text)</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">*quote</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">text-of</span> <span class="nv">e</span><span class="p">)))</span>

<span class="c1">; text-of</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">text-of</span> <span class="nv">second</span><span class="p">)</span>

<span class="c1">; *identifier</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">*identifier</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">lookup-in-table</span> <span class="nv">e</span> <span class="nv">table</span> <span class="nv">initial-table</span><span class="p">)))</span>

<span class="c1">; initial-table</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">initial-table</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">name</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car</span> <span class="o">'</span><span class="p">())))</span>    <span class="c1">; let's hope we don't take this path</span>

<span class="c1">; *lambda</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">*lambda</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">build</span> <span class="ss">'non-primitive</span>
           <span class="p">(</span><span class="nb">cons</span> <span class="nv">table</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">e</span><span class="p">)))))</span>

<span class="c1">; Let's add helper functions</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">table-of</span> <span class="nv">first</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">formals-of</span> <span class="nv">second</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">body-of</span> <span class="nv">third</span><span class="p">)</span>

<span class="c1">; cond takes lines, and returns the value for the first true line</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">evcon</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">lines</span> <span class="nv">table</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">else?</span> <span class="p">(</span><span class="nf">question-of</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lines</span><span class="p">)))</span>
       <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">answer-of</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lines</span><span class="p">))</span> <span class="nv">table</span><span class="p">))</span>
      <span class="p">((</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">question-of</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lines</span><span class="p">))</span> <span class="nv">table</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">answer-of</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lines</span><span class="p">))</span> <span class="nv">table</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nf">evcon</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lines</span><span class="p">)</span> <span class="nv">table</span><span class="p">)))))</span>    <span class="c1">; we don't ask null?, better one of cond lines be true!</span>

<span class="c1">; evcon needs else?, question-of and answer-of</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">else?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq?</span> <span class="nv">x</span> <span class="ss">'else</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else</span> <span class="no">#f</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">question-of</span> <span class="nv">first</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">answer-of</span> <span class="nv">second</span><span class="p">)</span>

<span class="c1">; Now we can write the real *cond</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">*cond</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">evcon</span> <span class="p">(</span><span class="nf">cond-lines-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">cond-lines-of</span> <span class="nv">cdr</span><span class="p">)</span>

<span class="c1">; evlis finds meaning of arguments</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">evlis</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">args</span> <span class="nv">table</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">args</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
      <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">args</span><span class="p">)</span> <span class="nv">table</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">evlis</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">args</span><span class="p">)</span> <span class="nv">table</span><span class="p">))))))</span>

<span class="c1">; Finally the *application</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">*application</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">applyz</span>
      <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">function-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">evlis</span> <span class="p">(</span><span class="nf">arguments-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">function-of</span> <span class="nv">car</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">arguments-of</span> <span class="nv">cdr</span><span class="p">)</span>

<span class="c1">; Is the function a primitive?</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">primitive?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">l</span><span class="p">)</span> <span class="ss">'primitive</span><span class="p">)))</span>

<span class="c1">; Is the function a non-primitive?</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">non-primitive?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">l</span><span class="p">)</span> <span class="ss">'non-primitive</span><span class="p">)))</span>

<span class="c1">; Apply!</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">applyz</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">fun</span> <span class="nv">vals</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">primitive?</span> <span class="nv">fun</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">apply-primitive</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">fun</span><span class="p">)</span> <span class="nv">vals</span><span class="p">))</span>
      <span class="p">((</span><span class="nf">non-primitive?</span> <span class="nv">fun</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">apply-closure</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">fun</span><span class="p">)</span> <span class="nv">vals</span><span class="p">)))))</span>

<span class="c1">; apply-primitive</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">apply-primitive</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">name</span> <span class="nv">vals</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">name</span> <span class="ss">'cons</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">vals</span><span class="p">)))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">name</span> <span class="ss">'car</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">name</span> <span class="ss">'cdr</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">name</span> <span class="ss">'null?</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">null?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">name</span> <span class="ss">'eq?</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">eq?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">vals</span><span class="p">)))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">name</span> <span class="ss">'atom?</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">:atom?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">name</span> <span class="ss">'zero?</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">zero?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">name</span> <span class="ss">'add1</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">+</span> <span class="mi">1</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">name</span> <span class="ss">'sub1</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">-</span> <span class="mi">1</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="nv">name</span> <span class="ss">'number?</span><span class="p">)</span>
       <span class="p">(</span><span class="nb">number?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">))))))</span>

<span class="c1">; :atom?</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">:atom?</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">x</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">null?</span> <span class="nv">x</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">)</span> <span class="ss">'primitive</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq?</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">)</span> <span class="ss">'non-primitive</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else</span> <span class="no">#f</span><span class="p">))))</span>

<span class="c1">; apply-closure</span>
<span class="c1">;</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">apply-closure</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">closure</span> <span class="nv">vals</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">meaning</span>
      <span class="p">(</span><span class="nf">body-of</span> <span class="nv">closure</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">extend-table</span> <span class="p">(</span><span class="nf">new-entry</span>
                      <span class="p">(</span><span class="nf">formals-of</span> <span class="nv">closure</span><span class="p">)</span>
                      <span class="nv">vals</span><span class="p">)</span>
                    <span class="p">(</span><span class="nf">table-of</span> <span class="nv">closure</span><span class="p">)))))</span>

<span class="c1">;</span>
<span class="c1">; Let's try out our brand new Scheme interpreter!</span>
<span class="c1">;</span>

<span class="p">(</span><span class="nf">value</span> <span class="o">'</span><span class="p">(</span><span class="nf">add1</span> <span class="mi">6</span><span class="p">))</span>                           <span class="c1">; 7</span>
<span class="p">(</span><span class="nf">value</span> <span class="o">'</span><span class="p">(</span><span class="k">quote</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)))</span>                    <span class="c1">; '(a b c)</span>
<span class="p">(</span><span class="nf">value</span> <span class="o">'</span><span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="k">quote</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))))</span>              <span class="c1">; 'a</span>
<span class="p">(</span><span class="nf">value</span> <span class="o">'</span><span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="k">quote</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))))</span>              <span class="c1">; '(b c)</span>
<span class="p">(</span><span class="nf">value</span>
  <span class="o">'</span><span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">cons</span> <span class="nv">x</span> <span class="p">(</span><span class="k">quote</span> <span class="p">())))</span>
    <span class="p">(</span><span class="k">quote</span> <span class="p">(</span><span class="nf">foo</span> <span class="nv">bar</span> <span class="nv">baz</span><span class="p">))))</span>                 <span class="c1">; '((foo bar baz))</span>
<span class="p">(</span><span class="nf">value</span>
  <span class="o">'</span><span class="p">((</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span>
      <span class="p">(</span><span class="k">cond</span>
        <span class="p">(</span><span class="nf">x</span> <span class="p">(</span><span class="k">quote</span> <span class="nv">true</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span>
          <span class="p">(</span><span class="k">quote</span> <span class="nv">false</span><span class="p">))))</span>
    <span class="no">#t</span><span class="p">))</span>                                    <span class="c1">; 'true</span>

<span class="c1">;;; Recursion</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">recur-fib</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">)</span>
      <span class="nv">n</span>
      <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">recur-fib</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nf">recur-fib</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">)))))</span>

<span class="c1">;;; Tail-Recursion (Iteration)</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">tail-fib</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fib-nested</span> <span class="nv">n</span> <span class="nv">c1</span> <span class="nv">c2</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">[(</span><span class="nb">&lt;</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">n</span><span class="p">]</span>
          <span class="p">[(</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">c1</span> <span class="nv">c2</span><span class="p">)]</span>
          <span class="p">[</span><span class="ss">'t</span> <span class="p">(</span><span class="nf">fib-nested</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">c1</span> <span class="nv">c2</span><span class="p">)</span> <span class="nv">c1</span><span class="p">)]))</span>
  <span class="p">(</span><span class="nf">fib-ex</span> <span class="nv">n</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))</span>

<span class="c1">;;; Continuation-Passing Style Recursion</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fib-cps</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fib-nested</span> <span class="nv">n</span> <span class="nv">f</span><span class="p">)</span>
    <span class="p">(</span><span class="k">cond</span> <span class="p">[(</span><span class="nb">&lt;</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)]</span>
          <span class="p">[</span><span class="ss">'t</span> <span class="p">(</span><span class="nf">fib-nested</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">)</span>
                          <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span>  <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">fib-nested</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)</span>
                                                         <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span> <span class="nv">x</span><span class="p">))))]))</span>
  <span class="p">(</span><span class="nf">fib-nested</span> <span class="nv">n</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))</span>
  
</code></pre></div></div>

</div> <div class="post_list">

</div> 

        </article>
        
      </div>
    </div>
  </body>
</html>
