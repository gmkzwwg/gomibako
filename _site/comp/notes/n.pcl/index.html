<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <!-- MULTI-DEVICE WIDTH -->
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <!-- SITE DESCRIPTION -->
    
    <meta content="Chapter 4" name="description"/>
    <!-- REFERER FOR 3RD-PART IMAGES-->
    <meta content="no-referrer" name="referrer"/>
    <!-- SITE TITLE -->
    <title>
        
            Practical Common Lisp
        
    </title>
    <!-- GLOBAL SCRIPT-->
    <script src="http://localhost:4000/src/assets/js/main.js" async></script>
    <!-- SITE ICON -->
    <link href="http://localhost:4000/src/assets/img/rubbish.png" rel="shortcut icon bookmark" type="image/x-icon"/>
    <!-- GLOBAL STYLESHEET -->
    <link rel="stylesheet" href="http://localhost:4000/src/assets/css/main.css" type="text/css"/> 
    <!-- SJCL -->
    <script src="http://localhost:4000/src/assets/js/sjcl.js" async></script>   
    <!-- FONTAWESOME < 4.7.0 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css"/>    
    <!-- FONTAWESOME > 4.7.0 -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.0/css/all.min.css" type="text/css"/> -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.0/css/svg-with-js.min.css" type="text/css"/> -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.0/css/regular.min.css" type="text/css"/> -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.0/css/solid.min.css" type="text/css"/> -->
    <!-- MATHJAX -->
    
    <!-- KATEX -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},    // $$ ... $$
                {left: '$', right: '$', display: false},     // $ ... $
                {left: '\\(', right: '\\)', display: false}, // \( ... \)
                {left: '\\[', right: '\\]', display: true},  // \[ ... \]
            ],
            ignoredTags: ["script", "noscript", "style", "textarea", "pre", "code", "option"], // ignore some html tags
            throwOnError: false
        });
    });
    </script>
    
    <!-- MERMAID -->
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.12.0/mermaid.min.js"></script>
    <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
    mermaid.initialize({
        startOnLoad: true,
        theme: 'dark',
        flowchart: { htmlLabels: true }
    });
    // 强制触发一次扫描，针对代码块
    await mermaid.run({
        querySelector: '.language-mermaid',
    });
    </script>
    
    <!-- The tag `feed_meta` is unrecognized by Github Pages -->
    <!-- Copy Code Button -->
    <script type="module">
        document.querySelectorAll('pre.highlight, .highlight pre').forEach((codeBox) => {
        // 1. 创建按钮
        const copyBtn = document.createElement('button');
        copyBtn.className = 'copy-code-button';
        copyBtn.type = 'button';
        copyBtn.innerText = 'Copy';

        // 2. 挂载按钮：通常挂载在 pre 的父级以便定位
        const container = codeBox.parentNode;
        container.style.position = 'relative'; 
        container.appendChild(copyBtn);

        // 3. 剪切板逻辑
        copyBtn.addEventListener('click', () => {
            const code = codeBox.innerText;
            window.navigator.clipboard.writeText(code).then(() => {
            copyBtn.innerText = 'Copied!';
            setTimeout(() => { copyBtn.innerText = 'Copy'; }, 2000);
            });
        });
        });
    </script>
    <!-- Bilingual.js -->
    
</head>
  <body class="page">
    <!-- background animations -->
<div class="div_bg">
    <canvas id="c"></canvas>
</div>
<script>
var c = document.getElementById("c");
var ctx = c.getContext("2d");
c.height = window.innerHeight;
c.width = window.innerWidth;
var txts = "αβγδεζηθικλμνξοπρστυφχψω∝∞∑∏∪∩∈∵∴⊥∠⊙≌∽√∀∂∆∇⋈∅∫∬∳∯∱∲ℂℍℚℝℕℙℤⅈⅉⅇℼℽℵ";
txts = txts.split("");
var font_size = 12;
var columns = c.width / font_size;
var drops = [];
for (var x = 0; x < columns; x++) drops[x] = 1;

function draw() {
  ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
  ctx.fillRect(0, 0, c.width, c.height);
  ctx.fillStyle = "#490";
  ctx.font = font_size + "px arial";
  for (var i = 0; i < drops.length; i++) {
    var text = txts[Math.floor(Math.random() * txts.length)];
    ctx.fillText(text, i * font_size, drops[i] * font_size);
    if (drops[i] * font_size > c.height || Math.random() > 0.98) drops[i] = 0;
    drops[i]++;
  }
}
setInterval(draw, 20);
</script>
    <!-- collection list, shown by click "archive" buttom in header -->
<div class="collection_list_container"  id="the_collection_list">
<div class="collection_list_background"  onclick="close_collection_list()"></div>
<div class="collection_list" onload="none">
    <div class="collection_list_header">
        <!-- TODO: search post -->
                                            <!-- <a class="search_btn">
      <i class="fa fa-search"> Search</i>
    </a>
    &nbsp; -->
        <table class="collection_list_header_title">
            <tr>
                <td>Archive:</td>
                <td id="clh_title"></td>
            </tr>
        </table>
        <div class="close_btn" onclick="close_collection_list()">
            <a class="close_btn_icon">
                <i class="fa fa-times"></i>
            </a>
        </div>
    </div>
    <div class="collection_name_list">
        <table class="vertical_center_table">
            <tr>
                <td>
                    <ul>
                        <!-- show all collections -->
                        <li>
                            <a class="a_collection_label" onclick="show_collection('all')">All
                            </a>
                        </li>
                        <!-- show a simple collection -->
                        
                            
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('phil')">
                                                
                                                    PHIL
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('lit')">
                                                
                                                    LIT
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('hist')">
                                                
                                                    HIST
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('psyc')">
                                                
                                                    PSYC
                                                
                                            </a>
                                        </li>
                                    
                                
                            
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('math')">
                                                
                                                    MATH
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('comp')">
                                                
                                                    COMP
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('phys')">
                                                
                                                    PHYS
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                            
                                
                                    
                                
                                    
                                
                                    
                                        <li>
                                            <a class="a_collection_label" onclick="show_collection('lang')">
                                                
                                                    LANG
                                                
                                            </a>
                                        </li>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            
                        
                    </ul>
                </td>
            </tr>
        </table>
    </div>
    <div class="posts_by_cate">
        <!-- post list in all collections -->
        <div class="post_list_in_1_collection" id="all">
            <table class="vertical_center_table">
                <tr>
                    <td>
                        <ul>
                            
                                
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    PHIL
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/n.intro.to.phil/">Introduction to Western Philosophy</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/prime/p.phil/">Western Philosophy - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/sheet/s.all-isms/">A Comprehesive Summary of All -ism in Western Tradition</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/annal/a.paradigm.shift/">Paradigm Shift of Western Philosophy</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/n.en.history.of.phil/">Outline of History of Western Philosophy</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/n.zh.history.of.phil/">西方哲学史大纲</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/t.kenny/">A New History of Western Philosophy</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/s.phil.language/">Quick Tutorial of Philosophy Language</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/s.phil.methodology/">Methodology of Philosophy</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/t.toolkit/">The Philosophier's Toolkit</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/n.epistemology/">Modern Epistemology</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/sheet/n.thinking.models/">A List of Thinking Models and Cognitive Structures</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/t.ctk/">Contemporary Theories of Knowledge</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/n.phenomenology/">Phenomenology</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/n.semiotics/">符号学笔记</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/p.marxism/">马克思主义的基础结构和发展</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/notes/p-intro.to.analytic.phil/">Introduction to Analytic Philosophy</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/t.n.sayings/">Quotes and Original text of Philosophiers</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/t.online/">网络哲学文章</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/phil/texts/t.phil/">中文社区哲学学习辅助资料</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    LIT
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/notes/n.lit.ontology/">Ontology of Literature</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/prime/p.lit/">Literature - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/annal/a.hist.literature.and.theory/">Timeline of the History of Literature and Literary Theory</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/annal/a.lit.works/">Timelines of Development of Western Literature</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/sheet/a.motifs/">Motifs of World Literature Tradition</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/notes/n.hist.lit/">History of Western Literature</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/notes/n.ideas.by.authors/">不同作家对于文学创作的理论和倾向</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/notes/n.lit.theory/">Western Literary Theory</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/prime/p.lit.theory/">Basic Problems in Literary Theory and Literary Criticism</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/notes/n.myths/">世界神话体系故事、神表和社会意识形态分析</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/notes/n.religion/">世界各宗教世界观、主张和主要经典</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/notes/n.narratology/">Narratology - the Theory of Narrative</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/notes/n.characters/">How to Create Characters with Rich Inner Depth</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/notes/n.modernizing/">Modernizing Ancient Novels - A Comprehensive Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/sheet/s.variables/">写作者可操控变量的分层总结</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/notes/n.deep.reading.methods/">Deep Reading Methods for Literary Analysis and Craft</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/prime/s.reading.list/">文学阅读计划</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/texts/t.lolita.annotated/">The Annotated Lolita</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/texts/t.mocangli/">孤鸿寄语默苍离主要剧情</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/lit/texts/t.writing.principles/">Writing Principles of Talented Writers - A Personal Collection</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    HIST
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/prime/p.hist/">History - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/sheet/re.historical.division/">historical Division of World History</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/notes/n.history.of.historiography/">History of Weastern Historiography</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/a.global/">Highlighted Events in World History</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/a.egypt/">古代埃及史大纲</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/a.jp.timeline/">日本古代史时间线</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/a.middle.asia/">中亚古代史时间线</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/notes/n.cn.dynasty.and.idea/">中国历代主要思想观念及其对后世影响研究</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/o.eastern.asia/">东亚古代史时间线</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/notes/s.cn.historical.materials/">中国历代主要文字史料及其效力评判</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/a.acient.europe/">古代欧洲史时间线</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/a.europe/">Key Milestones in European History</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/hist/annal/s.eu.historical.division/">Historical Divisions of European History</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    PSYC
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/prime/p.psyc/">Psychology - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.1.sigmund.freud/">The Theory Architecture of Sigmund Freud</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.2.karl.young/">The Theory Architecture of Karl Young</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.3.alfred.adler/">The Theory Architecture of Alfred Adler</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.4.anna.freud/">The Theory Architecture of Anna Freud</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.5.melanie.klein/">The Theory Architecture of Anna Freud</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.6.donald.winnicott/">The Theory Architecture of Donald Winnicott</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.7.jacques.lacan/">The Theory Architecture of Jacques Lacan</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/prime/p.psychoanalysis/">Psychoanalysis - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/sheet/s.tips.for.better.human/">增加人类学习和工作能力的神经心理学和脑科学小技巧</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/texts/t.learning.how.to.learn/">Learning how to Learn</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/sheet/n.fallacies_n_bias/">Logical Fallacies and Cognitive Bias</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.low.latent.inhibition/">Low Latent Inhibition - Neurocognitive Mechanisms, Psychopathology, and Creativity</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.psychopathology.and.treatment/">常见心理疾病的介绍和精神药物简介</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.five.factor.model/">大五人格维度简介</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/psyc/notes/n.male.displays/">Sexual Dysfunction and Compensatory Masculinity Performance</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    MATH
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/annal/a.history.math/">数学史和数学思想</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/prime/p.math/">Mathematics - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/prime/p.math.tools/">Learn Mathematics with Modern Tools and Workflow</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/sheet/s.elementary.mathematics/">基础数学速查表</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/sheet/s.latex/">Writing Mathematical Formulas in LaTeX</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/sheet/s.zh-en.terminology/">数学术语速查表</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/sheet/zh-en.termin/">数学术语速查表2</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.complex.analysis/">Complex Analysis</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.functional.analysis/">Funtioncal Analysis</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.math.analysis/">Mathematical Analysis</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.ode/">Ordinary Differential Equation</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.pde/">Partial Differential Equation</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.real.analysis/">Real Analysis</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.abstract.algebra/">Abstract Algebra</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.advanced.algebra/">Advanced Algebra</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.commutative.algebra/">Commutative Algebra</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.homological.algebra/">Homological Algebra</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.lie.algebra/">Lie Algebra</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.algebraic.geometry/">Algebraic Geometry</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.category.theory/">Category Theory</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.mathematical.logic/">Mathematical Logic</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.model.theory/">Model Theory</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.proof.theory/">Proof Theory</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.recursive.theory/">Recursive Theory</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/math/notes/n.set.theory/">Axiomatic Set Theory</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    COMP
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.missing.semester.of.cs/">MIT Null, The Missing Semester of Your CS Education</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/prime/p.comp/">Computer Science - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.resources/">Learning Resource</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.win11.tweak.tools/">Best Windows 11 Tweak Tools</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.regex/">Regex - Basic Syntax and Practical Usage</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.tsql/">T-SQL Quick Reference and Usage</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.useful.ascii.art/">Useful ASCII Art</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.hardware.spec/">Linux - Check Hardware infomation and Specification</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.ibus.french.ime/">French Input Methods with ibus</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.linux.ai.utilities/">Linux Utilities and AI Tools</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.manjaro.i3wm/">Build Efficient working Environment with Manjaro and i3wm</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.nas.tutorial/">Low Power-Comsumption NAS Crafting</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.awk/">awk - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.find/">find - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.git/">git - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.grep/">grep - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/s.grub.conf/">Grub Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.i3wm/">awk - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.markdown/">markdown - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.sed/">sed - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.shell/">Linux Shell - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.xargs/">xargs - Quick Reference and Minimal Tutorial</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.aesthetic/">Coding Aesthetic</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.debug/">Coding Debug Tips</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.emacs/">Emacs Quick Reference</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.ctmcp/">Concepts, Techniques, and Models of Computer Programming</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.eopl/">Essentials of Programming Languages</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.scheme.sicp/">Structure and Interpretation of Computer Programs</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.sicp/">Structure and Interpretation of Computer Programs</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.csapp/">Computer Systems, a Programmer's Perspective</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/texts/t.sf/">Software Foundations</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.css.js/">Web Development, HTML, CSS and Javascript</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.gpt.learning.booster/">Using ChatGPT as a Learning Assistant</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.prompt.engineering/">LLM Prompt Engineering for Study Assistance</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/sheet/s.chatgpt.prompts/">Frequently Used Prompts of ChatGPT for Learning and Research</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/python.tips/">Python Using Tips</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.pcl/">Practical Common Lisp</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.tls/">The Little Schemer</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/comp/notes/n.java/">Outdated Java Notes</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    PHYS
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/prime/n.classical.physics/">Classical Physics</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/prime/p.phys/">Physics - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/notes/n.cp/">宇宙学原理 Cosmological Principle</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/notes/n.fermi.paradox/">费米悖论 Fermi Paradox</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/prime/p.cosmology/">Cosmology - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/sheet/s.cosmos/">宇宙中都有什么</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/sheet/s.star.atlas/">天区图 Sky Chart 和星图 Star Atlas</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/phys/sheet/s.units.in.astronomy.and.cosmology/">Commonly Used Units in Astronomy and Cosmology</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                
                                    
                                        
                                    
                                        
                                    
                                        
                                            <p class="h_collection_label">
                                                
                                                    LANG
                                                
                                            </p>
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                                        <a class="a_title" href="http://localhost:4000/lang/prime/p.linguistics/">Linguistics - Its Roadmap and Knowledge Architecture</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lang/notes/n.en.long.sentences.n.expressions/">Long Sentences in English</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lang/notes/n.en.word.subtle.diff/">Subtle Differences Between English Words</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/lang/sheet/s.en.grammer/">英语语法速查表</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/lang/sheet/s.en.idioms/">English Collocations and Idioms</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/lang/sheet/s.en.latin.words/">Latin Words in English</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/lang/sheet/s.en.surnames.origins/">Surnames and Their Origins in English</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                                        <a class="a_title" href="http://localhost:4000/lang/notes/t.en.elden.ring/">Elden Ring Dialogue in Order</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/lang/sheet/s.fr.grammar/">法语语法速查表</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/lang/sheet/s.fr.pronounce/">French Pronouncation Tips</a>
                                                    </li>
                                                
                                            
                                                
                                                    <li>
                                                        <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                                        <a class="a_title" href="http://localhost:4000/lang/sheet/s.jp.grammer/">日语语法速查表</a>
                                                    </li>
                                                
                                            
                                            <br/>
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                            
                        </ul>
                    </td>
                </tr>
            </table>
        </div>
        <!-- post list in a collection -->
        
            <div class="post_list_in_1_collection" id="comp">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.missing.semester.of.cs/">MIT Null, The Missing Semester of Your CS Education</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/prime/p.comp/">Computer Science - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.resources/">Learning Resource</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.win11.tweak.tools/">Best Windows 11 Tweak Tools</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.regex/">Regex - Basic Syntax and Practical Usage</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.tsql/">T-SQL Quick Reference and Usage</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.useful.ascii.art/">Useful ASCII Art</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.hardware.spec/">Linux - Check Hardware infomation and Specification</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.ibus.french.ime/">French Input Methods with ibus</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.linux.ai.utilities/">Linux Utilities and AI Tools</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.manjaro.i3wm/">Build Efficient working Environment with Manjaro and i3wm</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.nas.tutorial/">Low Power-Comsumption NAS Crafting</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.awk/">awk - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.find/">find - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.git/">git - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.grep/">grep - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/s.grub.conf/">Grub Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.i3wm/">awk - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.markdown/">markdown - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.sed/">sed - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.shell/">Linux Shell - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.xargs/">xargs - Quick Reference and Minimal Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.aesthetic/">Coding Aesthetic</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.debug/">Coding Debug Tips</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.emacs/">Emacs Quick Reference</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.ctmcp/">Concepts, Techniques, and Models of Computer Programming</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.eopl/">Essentials of Programming Languages</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.scheme.sicp/">Structure and Interpretation of Computer Programs</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.sicp/">Structure and Interpretation of Computer Programs</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.csapp/">Computer Systems, a Programmer's Perspective</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/texts/t.sf/">Software Foundations</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.css.js/">Web Development, HTML, CSS and Javascript</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.gpt.learning.booster/">Using ChatGPT as a Learning Assistant</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.prompt.engineering/">LLM Prompt Engineering for Study Assistance</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/sheet/s.chatgpt.prompts/">Frequently Used Prompts of ChatGPT for Learning and Research</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/python.tips/">Python Using Tips</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.pcl/">Practical Common Lisp</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.tls/">The Little Schemer</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/comp/notes/n.java/">Outdated Java Notes</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="hist">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/prime/p.hist/">History - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/sheet/re.historical.division/">historical Division of World History</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/notes/n.history.of.historiography/">History of Weastern Historiography</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/a.global/">Highlighted Events in World History</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/a.egypt/">古代埃及史大纲</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/a.jp.timeline/">日本古代史时间线</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/a.middle.asia/">中亚古代史时间线</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/notes/n.cn.dynasty.and.idea/">中国历代主要思想观念及其对后世影响研究</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/o.eastern.asia/">东亚古代史时间线</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/notes/s.cn.historical.materials/">中国历代主要文字史料及其效力评判</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/a.acient.europe/">古代欧洲史时间线</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/a.europe/">Key Milestones in European History</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/hist/annal/s.eu.historical.division/">Historical Divisions of European History</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="lang">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/lang/prime/p.linguistics/">Linguistics - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lang/notes/n.en.long.sentences.n.expressions/">Long Sentences in English</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lang/notes/n.en.word.subtle.diff/">Subtle Differences Between English Words</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/lang/sheet/s.en.grammer/">英语语法速查表</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/lang/sheet/s.en.idioms/">English Collocations and Idioms</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/lang/sheet/s.en.latin.words/">Latin Words in English</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/lang/sheet/s.en.surnames.origins/">Surnames and Their Origins in English</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lang/notes/t.en.elden.ring/">Elden Ring Dialogue in Order</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/lang/sheet/s.fr.grammar/">法语语法速查表</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/lang/sheet/s.fr.pronounce/">French Pronouncation Tips</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/lang/sheet/s.jp.grammer/">日语语法速查表</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="lit">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/notes/n.lit.ontology/">Ontology of Literature</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/prime/p.lit/">Literature - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/annal/a.hist.literature.and.theory/">Timeline of the History of Literature and Literary Theory</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/annal/a.lit.works/">Timelines of Development of Western Literature</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/sheet/a.motifs/">Motifs of World Literature Tradition</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/notes/n.hist.lit/">History of Western Literature</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/notes/n.ideas.by.authors/">不同作家对于文学创作的理论和倾向</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/notes/n.lit.theory/">Western Literary Theory</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/prime/p.lit.theory/">Basic Problems in Literary Theory and Literary Criticism</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/notes/n.myths/">世界神话体系故事、神表和社会意识形态分析</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/notes/n.religion/">世界各宗教世界观、主张和主要经典</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/notes/n.narratology/">Narratology - the Theory of Narrative</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/notes/n.characters/">How to Create Characters with Rich Inner Depth</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/notes/n.modernizing/">Modernizing Ancient Novels - A Comprehensive Tutorial</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/sheet/s.variables/">写作者可操控变量的分层总结</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/notes/n.deep.reading.methods/">Deep Reading Methods for Literary Analysis and Craft</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/prime/s.reading.list/">文学阅读计划</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/texts/t.lolita.annotated/">The Annotated Lolita</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/texts/t.mocangli/">孤鸿寄语默苍离主要剧情</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/lit/texts/t.writing.principles/">Writing Principles of Talented Writers - A Personal Collection</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="math">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/math/annal/a.history.math/">数学史和数学思想</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/math/prime/p.math/">Mathematics - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/math/prime/p.math.tools/">Learn Mathematics with Modern Tools and Workflow</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/math/sheet/s.elementary.mathematics/">基础数学速查表</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/math/sheet/s.latex/">Writing Mathematical Formulas in LaTeX</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/math/sheet/s.zh-en.terminology/">数学术语速查表</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/math/sheet/zh-en.termin/">数学术语速查表2</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.complex.analysis/">Complex Analysis</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.functional.analysis/">Funtioncal Analysis</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.math.analysis/">Mathematical Analysis</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.ode/">Ordinary Differential Equation</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.pde/">Partial Differential Equation</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.real.analysis/">Real Analysis</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.abstract.algebra/">Abstract Algebra</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.advanced.algebra/">Advanced Algebra</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.commutative.algebra/">Commutative Algebra</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.homological.algebra/">Homological Algebra</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.lie.algebra/">Lie Algebra</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.algebraic.geometry/">Algebraic Geometry</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.category.theory/">Category Theory</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.mathematical.logic/">Mathematical Logic</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.model.theory/">Model Theory</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.proof.theory/">Proof Theory</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.recursive.theory/">Recursive Theory</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/math/notes/n.set.theory/">Axiomatic Set Theory</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="phil">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/n.intro.to.phil/">Introduction to Western Philosophy</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/prime/p.phil/">Western Philosophy - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/sheet/s.all-isms/">A Comprehesive Summary of All -ism in Western Tradition</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Annal]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/annal/a.paradigm.shift/">Paradigm Shift of Western Philosophy</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/n.en.history.of.phil/">Outline of History of Western Philosophy</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/n.zh.history.of.phil/">西方哲学史大纲</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/t.kenny/">A New History of Western Philosophy</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/s.phil.language/">Quick Tutorial of Philosophy Language</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/s.phil.methodology/">Methodology of Philosophy</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/t.toolkit/">The Philosophier's Toolkit</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/n.epistemology/">Modern Epistemology</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/sheet/n.thinking.models/">A List of Thinking Models and Cognitive Structures</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/t.ctk/">Contemporary Theories of Knowledge</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/n.phenomenology/">Phenomenology</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/n.semiotics/">符号学笔记</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/p.marxism/">马克思主义的基础结构和发展</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/notes/p-intro.to.analytic.phil/">Introduction to Analytic Philosophy</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/t.n.sayings/">Quotes and Original text of Philosophiers</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/t.online/">网络哲学文章</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/phil/texts/t.phil/">中文社区哲学学习辅助资料</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="phys">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/prime/n.classical.physics/">Classical Physics</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/prime/p.phys/">Physics - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/notes/n.cp/">宇宙学原理 Cosmological Principle</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/notes/n.fermi.paradox/">费米悖论 Fermi Paradox</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/prime/p.cosmology/">Cosmology - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/sheet/s.cosmos/">宇宙中都有什么</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/sheet/s.star.atlas/">天区图 Sky Chart 和星图 Star Atlas</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/phys/sheet/s.units.in.astronomy.and.cosmology/">Commonly Used Units in Astronomy and Cosmology</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="posts">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E9%80%86%E6%97%B6%E9%97%B4/">逆时间</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[散文随笔]</a>
                                            <a class="a_title" href="http://localhost:4000/%E4%B8%8D%E8%A6%81%E9%9A%8F%E4%BE%BF%E4%BA%A4%E6%9C%8B%E5%8F%8B/">嘿！不要随便交朋友</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[散文随笔]</a>
                                            <a class="a_title" href="http://localhost:4000/%E4%B8%BA%E4%BB%80%E4%B9%88%E7%88%B1%E8%AE%B2%E9%81%93%E7%90%86/">为什么那么多人喜欢讲道理</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E7%AD%89%E5%BE%85%E7%9D%80%E7%9A%84%E5%A5%B3%E5%AD%A9/">等待着的女孩</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E5%9F%8E%E5%A0%A1%E9%87%8C%E7%9A%84%E7%8C%AB%E5%92%8C%E9%AD%94%E6%B3%95%E6%AF%9B%E7%BA%BF%E7%90%83/">城堡里的猫和魔法毛线球</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E9%97%AE%E5%89%91%E5%B4%96%E4%B8%8A/">问剑崖上</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E7%99%BD%E7%BE%8A%E6%95%B0%E5%92%8C%E4%BC%90%E6%9C%A8%E5%B7%A5/">白羊树和伐木工</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E9%B8%A1%E8%9B%8B%E5%92%8C%E9%94%A4%E5%AD%90/">鸡蛋和锤子</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[短篇小说]</a>
                                            <a class="a_title" href="http://localhost:4000/%E6%9C%A8%E5%81%B6%E5%92%8C%E6%93%8D%E5%81%B6%E5%B8%88/">木偶和木偶戏演员</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[原文摘录]</a>
                                            <a class="a_title" href="http://localhost:4000/%E6%95%99%E5%91%98%E7%9A%84%E9%A1%B6%E7%BA%A7%E8%AE%A4%E7%9F%A5%E6%8F%90%E5%8D%87%E6%96%B9%E6%B3%95/">教员的顶级认知提升方法</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[]</a>
                                            <a class="a_title" href="http://localhost:4000/%E7%88%B1%E5%81%9A%E7%99%BD%E6%97%A5%E6%A2%A6%E7%9A%84%E5%A0%82%E5%90%89%E8%AF%83%E5%BE%B7%E7%9A%84%E6%90%9E%E7%AC%91%E5%86%B2%E9%94%8B/">爱做白日梦的堂吉诃德的搞笑冲锋</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[学习方法]</a>
                                            <a class="a_title" href="http://localhost:4000/%E7%89%B9%E7%A7%8D%E5%85%B5%E5%AD%A6%E4%B9%A0/">一个高度理想化的“特种兵”学习流程</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[阅读笔记]</a>
                                            <a class="a_title" href="http://localhost:4000/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%E4%BC%A4%E9%80%9D/">鲁迅《伤逝》阅读笔记</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[阅读笔记]</a>
                                            <a class="a_title" href="http://localhost:4000/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%E7%B4%A0%E9%A3%9F%E8%80%85/">韩江《素食者》三部曲阅读笔记</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[学习方法]</a>
                                            <a class="a_title" href="http://localhost:4000/%E5%BA%94%E8%AF%95%E6%95%B0%E5%AD%A6%E7%9A%84%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/">应试数学的学习方法</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[散文随笔]</a>
                                            <a class="a_title" href="http://localhost:4000/%E6%8A%80%E8%83%BD%E4%BA%94%E5%AD%90%E6%A3%8B/">《技能五子棋》的喜剧内核是年轻人对东亚困境的反叛</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[散文随笔]</a>
                                            <a class="a_title" href="http://localhost:4000/%E4%B8%96%E7%95%8C%E5%90%84%E7%A7%8D%E7%B1%BB%E4%BA%BA%E6%89%8D%E7%9A%84%E8%B0%83%E6%9F%A5%E6%8A%A5%E5%91%8A/">世界各种类人才的调查报告</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[学习方法]</a>
                                            <a class="a_title" href="http://localhost:4000/%E8%B5%9B%E5%8D%9A%E6%99%AE%E7%BD%97%E7%B1%B3%E4%BF%AE%E6%96%AF/">赛博普罗米修斯：程序员掌握先进生产力</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[社会观察]</a>
                                            <a class="a_title" href="http://localhost:4000/OCE/">组织层级指数、组织形态谱及其哲学原理</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
            <div class="post_list_in_1_collection" id="psyc">
                <table class="vertical_center_table">
                    <tr>
                        <td>
                            <ul>
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/prime/p.psyc/">Psychology - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.1.sigmund.freud/">The Theory Architecture of Sigmund Freud</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.2.karl.young/">The Theory Architecture of Karl Young</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.3.alfred.adler/">The Theory Architecture of Alfred Adler</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.4.anna.freud/">The Theory Architecture of Anna Freud</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.5.melanie.klein/">The Theory Architecture of Anna Freud</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.6.donald.winnicott/">The Theory Architecture of Donald Winnicott</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.7.jacques.lacan/">The Theory Architecture of Jacques Lacan</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Prime]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/prime/p.psychoanalysis/">Psychoanalysis - Its Roadmap and Knowledge Architecture</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/sheet/s.tips.for.better.human/">增加人类学习和工作能力的神经心理学和脑科学小技巧</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Texts]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/texts/t.learning.how.to.learn/">Learning how to Learn</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Sheet]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/sheet/n.fallacies_n_bias/">Logical Fallacies and Cognitive Bias</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.low.latent.inhibition/">Low Latent Inhibition - Neurocognitive Mechanisms, Psychopathology, and Creativity</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.psychopathology.and.treatment/">常见心理疾病的介绍和精神药物简介</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.five.factor.model/">大五人格维度简介</a>
                                        </li>
                                    
                                
                                    
                                        <li>
                                            <a class="a_categories" href="http://localhost:4000\categories">[Notes]</a>
                                            <a class="a_title" href="http://localhost:4000/psyc/notes/n.male.displays/">Sexual Dysfunction and Compensatory Masculinity Performance</a>
                                        </li>
                                    
                                
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>
        
    </div>
</div>
</div>
    <div class="container" id="ctner">
       <div class="header">
  <table class="vertical_center_table">
    <tr>
      <td>
        <nav class="nav_bar">
          <ul>
            <!-- left header -->
            <li class="li_left">
              <!-- open collection tree -->
              
              <a class="header_btn" onclick="open_collection_list()">
                <i class="fa fa-trash btn_icon"></i>
                  
                  <p class="btn_text">Rubbish</p>
                  
              </a>
              
              <!-- home -->
              
              <a class="header_btn" href="http://localhost:4000">
                <i class="fa fa-home btn_icon"></i>
                  
                  <p class="btn_text">Bin</p>
                  
              </a>
              
              <!-- bilingual -->
              
              <!-- maximize -->
              
              <a class="header_btn" id="mxmz_btn" onclick="toggle_maximize()">
                <i class="fa fa-window-maximize btn_icon"></i>
                  
                  <p class="btn_text" id="mxmz_text">Maximize</p>
                  
              </a>
              
              <!-- access token -->
              
            </li>
            <!-- right header -->
            <span class="span_right">
              
               <!-- back to top -->
               <a class="header_btn" id="back_to_top_btn" href="#top_hook">
                <i class="fa fa-fast-backward btn_icon"></i>
                  
                  <p class="btn_text">Top</p>
                  
              </a>
              <!-- scroll up -->
              <a class="header_btn" onclick="scroll_percentage(-0.88)">
                <i class="fa fa-backward btn_icon"></i>
                  
                  <p class="btn_text">Prev</p>
                  
              </a>
              <!-- scroll down -->
              <a class="header_btn" onclick="scroll_percentage(0.88)">
                <i class="fa fa-forward btn_icon"></i>
                  
                  <p class="btn_text">Next</p>
                  
              </a>
              <!-- popup table of content -->
              <a class="header_btn popup_btn" onclick="toggle_toc()">
                <i class="fa fa-list btn_icon"></i>
                  
                  <p class="btn_text">Index</p>
                  
              </a>
              
            </span>
          </ul>
        </nav>
        <!-- <hr /> -->
      </td>
    </tr>
  </table>
</div>
<!-- table of content -->

<div class="div_toc toc" id="popup_toc">
  
  <!-- generate toc -->
  <ul class="ul_toc" id="ul_toc"><li><a href="#chapter-4">Chapter 4</a><ul><li><a href="#nil-and-t">NIL and T</a></li></ul></li><li><a href="#chapter-5">Chapter 5</a><ul><li><a href="#mixing-different-parameter-types">Mixing Different Parameter Types</a></li><li><a href="#default-parameter-value">Default Parameter Value</a></li><li><a href="#arg-and-arg-supplied-p">ARG and ARG-SUPPLIED-P</a></li><li><a href="#anonymous-functions---lambda-expression">Anonymous Functions - LAMBDA Expression</a></li></ul></li><li><a href="#chapter-6">Chapter 6</a><ul><li><a href="#binding-forms">Binding Forms</a></li><li><a href="#differences-of-defvar-and-defparameter">Differences of DEFVAR and DEFPARAMETER</a></li><li><a href="#some-boring-tests">Some boring tests</a></li></ul></li><li><a href="#chapter-7">Chapter 7</a><ul><li><a href="#define-when-and-unless">Define WHEN and UNLESS</a></li><li><a href="#short-circuit-in-and--or">Short-circuit in AND &amp; OR</a></li><li><a href="#do-always-use-old-values-to-build-new-values">DO always use OLD values to build NEW values!</a></li></ul></li><li><a href="#chapter-8">Chapter 8</a><ul><li><a href="#macro-expansion-time--runtime">Macro Expansion Time &amp; Runtime</a></li><li><a href="#general-steps-to-writing-macros">General Steps to Writing Macros</a></li><li><a href="#-and-">, and ,@</a></li><li><a href="#leaks-and-rules-preventing-leaks">Leaks and Rules preventing Leaks</a></li></ul></li><li><a href="#chapter-9">Chapter 9</a></li><li><a href="#chapter-10">Chapter 10</a></li><li><a href="#comparisons">Comparisons.</a><ul><li><a href="#something-about-numbers">Something about Numbers</a></li><li><a href="#rem-and-mod">REM and MOD</a></li><li><a href="#1-1--incf-and-decf">1+, 1-, INCF and DECF</a></li></ul></li><li><a href="#characters">Characters</a></li><li><a href="#chapter-11">Chapter 11</a></li><li><a href="#complement--test-not">COMPLEMENT &amp; :test-not</a></li><li><a href="#copy-seq--reverse">COPY-SEQ &amp; REVERSE</a></li><li><a href="#chapter-12">Chapter 12</a><ul><li><a href="#useful-forms-of-recycling-functions">Useful Forms of Recycling Functions.</a></li></ul></li><li><a href="#chapter-13">Chapter 13</a></li><li><a href="#chapter-14">Chapter 14</a><ul><li><a href="#use-with-open-file-">Use WITH-OPEN-FILE !</a></li><li><a href="#other-kinds-of-io">Other Kinds of I/O</a></li></ul></li><li><a href="#chapter-15">Chapter 15</a></li><li><a href="#chapter-23">Chapter 23</a></li><li><a href="#common-lisp-portable-perl-compatible-regular-expression-cl-ppcre">Common Lisp Portable Perl-Compatible Regular Expression (CL-PPCRE)</a><ul><li><a href="#print-objects">Print Objects</a></li></ul></li><li><a href="#case-ccase-ecase">CASE CCASE ECASE</a><ul><li><a href="#source-code-1">Source Code</a></li></ul></li><li><a href="#html-generator">HTML Generator</a></li></ul>
</div>

<!-- toggle maximize -->

<script>
  var ctner_state = 0;
  var ctner = document.getElementById("ctner");
</script>

<!-- encrypt and decrypt -->


      <div class="div_article" id="div_atcl">
        <div class="hook" id="top_hook"></div>
        <article
          id="main_atcl"
          itemscope
          itemtype="http://schema.org/BlogPosting"
        >
          <h1 id="Practical Common Lisp">Practical Common Lisp</h1>
<div class="post_info">
  <!-- author -->
  
  <!-- date -->
  
  <!-- category -->
  
  <span>
    <i class="fa fa-archive"></i>
      Notes
  </span>
  
  <!-- tags -->
  
  <span>
    <i class="fa fa-tag"></i>
    
        Lisp
      
    
  </span>
  
</div>
<!-- abstract -->


<br />
<div class="content">
<h3 id="chapter-4">Chapter 4</h3>

<div class="message">
    Introduce to S-expressions,function references,special operators,macros,truth &amp; falsehood &amp; equality and formatting codes.
</div>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;;; Chapter 4 SYNTAX &amp; SEMANTICS</span>

<span class="c1">;; quote</span>
<span class="c1">;; Takes a single expression as its “argument” and simply returns it,special operator</span>
<span class="p">(</span><span class="k">quote</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1">;; Return: (+ 1 2)</span>

<span class="c1">;; (eq ARG0 ARG1)</span>
<span class="c1">;; Two objects are EQ if they’re identical. The object identity of numbers and characters depends on how those data types are implemented in a particular Lisp.</span>

<span class="c1">;; (eql ARG0 ARG1)</span>
<span class="c1">;; Behave like EQ except that it also is guaranteed to consider two objects of the same class representing the same numeric or character value to be equivalent.</span>
<span class="p">(</span><span class="nb">eql</span> <span class="mi">1</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="c1">;; Return: NIL</span>
<span class="p">(</span><span class="nb">eql</span> <span class="s">"c"</span> <span class="s">"c"</span><span class="p">)</span>
<span class="c1">;; Return: NIL</span>

<span class="c1">;; (equal ARG0 ARG1)</span>
<span class="c1">;; Loosens the discrimination of EQL to consider lists equivalent if they have the same structure and contents, recursively, according to EQUAL . EQUAL also considers strings equivalent if they contain the same characters.</span>
<span class="p">(</span><span class="nb">equal</span> <span class="s">"c"</span> <span class="s">"c"</span><span class="p">)</span>
<span class="c1">;; Return: T</span>

<span class="c1">;; (equalp ARG0 ARG1)</span>
<span class="c1">;; Behave like EQUAL but ignore differences in case.</span>
<span class="p">(</span><span class="nb">equal</span> <span class="s">"c"</span> <span class="s">"C"</span><span class="p">)</span>
<span class="c1">;; Return: t</span>
</code></pre></div></div>

<h4 id="nil-and-t">NIL and T</h4>
<p>NIL is the only object that’s both an atom and a list: in addition to falsehood, it’s also used to represent the empty list.The expressions nil, (), ‘nil, and ‘() all evaluate to the same thing—the unquoted forms are evaluated as a reference to the constant variable whose value is the symbol NIL , but in the quoted forms the QUOTE special operator evaluates to the symbol directly.</p>

<p>The symbol T is the canonical true value and can be used when you need to return a non- NIL value and don’t have anything else handy.For the same reason as NIL, both t and ‘t will evaluate to the same thing: the symbol T .</p>

<h3 id="chapter-5">Chapter 5</h3>

<div class="message">
Defining functions,4 parameter types,high-order functions(function as data),anonymous functions.
</div>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;;; Chapter 5 FUNCTIONS</span>

<span class="c1">;; (defun NAME ARGLIST &amp;optional DOCSTRING DECL &amp;rest BODY)</span>
<span class="c1">;; Define a function</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">hello-world</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"~a ,hello world!"</span> <span class="nv">x</span><span class="p">))</span>
<span class="c1">;; Return: HELLO-WORLD</span>

<span class="c1">;; (documentation X DOC-TYPE)</span>
<span class="c1">;; Get the documentation string of the object,function</span>
<span class="p">(</span><span class="nb">documentation</span> <span class="ss">'foo</span> <span class="ss">'function</span><span class="p">)</span>
<span class="c1">;; Return the DOCSTRING</span>

<span class="c1">;; return-from</span>
<span class="c1">;; Return from everywhere the specail operator is.</span>

<span class="c1">;; (funcall FUNCTION &amp;REST ARGUMENTS)</span>
<span class="c1">;; Use when you know the number of arguments you’re going to pass to the function at the time you write the code. The first argument to FUNCALL is the function object to be invoked, and the rest of the arguments are passed onto that function,special operator.</span>
<span class="p">(</span><span class="nb">funcall</span> <span class="ss">'list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
<span class="c1">;; Return the result of FUNCTION,in the case above,(1 2 3)</span>

<span class="c1">;; (apply FUNCTION &amp;rest ARGUMENTS)</span>
<span class="c1">;; (apply #'func func-args)==(func (first func-args) (second func-args) (third func-args) (fourth func-args........)),that is ,apply recieves a list as the lambda list of FUNCTION.</span>
<span class="p">(</span><span class="nb">apply</span> <span class="nf">#'</span><span class="nb">list</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>
<span class="p">(</span><span class="nb">apply</span> <span class="nf">#'</span><span class="nb">append</span> <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">3</span><span class="p">)))</span>
<span class="c1">;; Return: (1 2 3)</span>

<span class="c1">;; (exp ARG0)</span>
<span class="c1">;; Return e^ARG0</span>
<span class="p">(</span><span class="nb">exp</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">;; Return: 2.7182817</span>

<span class="c1">;; (lambda &amp;WHOLE WHOLE-FORM LAMBDALIST &amp;BODY BODY) [2 times]</span>
<span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">x</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1">;; Return: #&lt;FUNCTION :LAMBDA (X) (* X 2)&gt;</span>
</code></pre></div></div>

<h4 id="mixing-different-parameter-types">Mixing Different Parameter Types</h4>

<p>(required-parameters optional-parameters rest-parameters keyword-parameters)</p>

<p>Only keyword-parameters isn’t positional.</p>

<p>If both &amp;rest and &amp;key appear in a parameter list, then both things happen—all the remaining values, which include the keywords themselves, are gathered into a list that’s bound to the &amp;rest parameter, and the appropriate values are also bound to the &amp;key parameters. So, given this function:</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">defun</span> <span class="nv">foo</span> <span class="p">(</span><span class="k">&amp;rest</span> <span class="nb">rest</span> <span class="k">&amp;key</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="nb">rest</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))</span>
</code></pre></div></div>

<p>&gt; (foo :a 1 :b 2 :c 3)</p>

<p>((:A 1 :B 2 :C 3) 1 2 3)</p>

<h4 id="default-parameter-value">Default Parameter Value</h4>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;; With no parameters,assign width and height with 1; with one paramters,assign height with width presented.In other words,make squares...</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">rectangle-area</span> <span class="p">(</span><span class="k">&amp;optional</span> <span class="p">(</span><span class="nv">width</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nv">height</span> <span class="nv">width</span><span class="p">)))</span>
</code></pre></div></div>

<h4 id="arg-and-arg-supplied-p">ARG and ARG-SUPPLIED-P</h4>
<p>ARG-SUPPLIED-P is designed to know whether the value of an optional argument was supplied by the caller or is the default value.By convention, these variables are usually named the same as the actual parameter with a “-supplied-p” on the end. For example:</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">defun</span> <span class="nv">foo</span> <span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="k">&amp;optional</span> <span class="p">(</span><span class="nv">c</span> <span class="mi">3</span> <span class="nv">c-supplied-p</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">list</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">c-supplied-p</span><span class="p">))</span>
</code></pre></div></div>

<p>&gt; (foo 1 2)</p>

<p>(1 2 NIL)</p>

<p>&gt; (foo 1 2 3)</p>

<p>(1 2 3 T)</p>

<h4 id="anonymous-functions---lambda-expression">Anonymous Functions - LAMBDA Expression</h4>

<p>1.Anonymous functions can be useful when you need to pass a function as an argument to another function and the function you need to pass is simple enough to express inline.</p>

<p>2.The other important use of LAMBDA expressions is in making closures, functions that capture part of the environment where they’re created.</p>

<h3 id="chapter-6">Chapter 6</h3>

<div class="message">
Lexical variables, dynamic variables, closures, constants, assignments, generalized assignment, rotate and shift muiltiple variables.
</div>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;;; Chapter 6 VARIABLES</span>

<span class="c1">;; (LET ...) and (LET* ...) called BINDING FORMS ,and there are more binding forms in CL,etc. function definition.</span>

<span class="c1">;; (let VARLIST &amp;body BODY)</span>
<span class="c1">;; Introduce new variables in a binding form,special operator.</span>
<span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">a</span> <span class="mi">10</span><span class="p">)</span> <span class="p">(</span><span class="nv">b</span> <span class="mi">20</span><span class="p">)</span> <span class="nv">c</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">setf</span> <span class="nv">c</span> <span class="mi">30</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))</span>
<span class="c1">;; Return the last form in BODY,that is, 60.</span>

<span class="c1">;; (let * VARLIST &amp;body BODY)</span>
<span class="c1">;; Behave like LET but you can binding a variable with variable appears earlier in VARLIST.</span>
<span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">a</span> <span class="mi">10</span><span class="p">)</span> <span class="p">(</span><span class="nv">b</span> <span class="p">(</span><span class="nb">*</span> <span class="mi">2</span> <span class="nv">a</span><span class="p">))</span> <span class="p">(</span><span class="nv">c</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">b</span> <span class="mi">10</span><span class="p">)))</span>
  <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))</span>
<span class="c1">;; Return the last form in BODY,that is, 60.</span>
<span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">a</span> <span class="mi">10</span><span class="p">)</span> <span class="p">(</span><span class="nv">b</span> <span class="p">(</span><span class="nb">*</span> <span class="mi">2</span> <span class="nv">a</span><span class="p">))</span> <span class="p">(</span><span class="nv">c</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">b</span> <span class="mi">10</span><span class="p">)))</span>
  <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))</span>
<span class="c1">;; ERROR!</span>

<span class="c1">;; (defparameter VAR VAL &amp;OPTIONAL (DOC NIL DOCP))</span>
<span class="c1">;; Define a global variable.</span>
<span class="p">(</span><span class="nb">defparameter</span> <span class="vg">*var*</span> <span class="mi">100</span> <span class="s">"An useless variable."</span><span class="p">)</span>
<span class="c1">;; Return: *VAR*</span>

<span class="c1">;; (defvar VAR VAL &amp;OPTIONAL (DOC NIL DOCP))</span>
<span class="c1">;; Define a global variable.</span>
<span class="p">(</span><span class="nb">defvar</span> <span class="vg">*var~*</span> <span class="mi">100</span> <span class="s">"Another useless variable."</span><span class="p">)</span>
<span class="c1">;; Return: *VAR*</span>

<span class="c1">;; (defconstant NAME VALUE &amp;OPTIONAL DOCUMENTATION)</span>
<span class="c1">;; Define a constant.</span>
<span class="p">(</span><span class="nb">defconstant</span> <span class="nv">+const+</span> <span class="mi">100</span> <span class="s">"An Useless constant"</span><span class="p">)</span>
<span class="c1">;; Return: +CONST+</span>

<span class="c1">;; (setf &amp;REST ARGS $ENVIRONMENT ENV)</span>
<span class="c1">;; another form explaination: setf: (PLACE VAL PLAVE VAL ...)</span>
<span class="c1">;; Assign any place a value,macro.</span>
<span class="p">(</span><span class="nb">setf</span> <span class="vg">*var*</span> <span class="mi">200</span><span class="p">)</span>
<span class="c1">;; Return: 200</span>

<span class="c1">;; (aref ARRAY IDX)</span>
<span class="c1">;; Access ARRAYs,function</span>

<span class="c1">;; (gethash KEY HASHTABLE &amp;optional DEFAULT)</span>
<span class="c1">;; Access hashtables.</span>

<span class="c1">;; (incf PLACE &amp;OPTIONAL (DELTA 1) &amp;ENVIRONMENT ENV)</span>
<span class="c1">;; Increase PLACE by DELTA (default,1),macro based on SETF</span>
<span class="p">(</span><span class="nb">incf</span> <span class="vg">*var*</span><span class="p">)</span>
<span class="c1">;; Return: 201</span>
<span class="p">(</span><span class="nb">incf</span> <span class="vg">*var*</span> <span class="mi">3</span><span class="p">)</span>
<span class="c1">;; Return: 204</span>

<span class="c1">;; (decf PLACE &amp;OPTIONAL (DELTA 1) &amp;ENVIRONMENT ENV)</span>
<span class="c1">;; Decrease PLACE by DELTA (defualt,1),macro based on SETF</span>

<span class="c1">;; (random LIMIT &amp;optional *RANDOM-STATE*)</span>
<span class="p">(</span><span class="nb">random</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1">;; (rotatef &amp;REST ARGS &amp;ENVIRONMENT ENV)</span>
<span class="c1">;; ↓←←←↑</span>
<span class="c1">;; ↓   ↑</span>
<span class="c1">;; ↓→→→↑</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">defparameter</span> <span class="nv">count1</span> <span class="mi">1</span><span class="p">)</span>
<span class="nv">COUNT1</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">defparameter</span> <span class="nv">count2</span> <span class="mi">2</span><span class="p">)</span>
<span class="nv">COUNT2</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">defparameter</span> <span class="nv">count3</span> <span class="mi">3</span><span class="p">)</span>
<span class="nv">COUNT3</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">rotatef</span> <span class="nv">count1</span> <span class="nv">count2</span> <span class="nv">count3</span><span class="p">)</span>
<span class="nv">NIL</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">eval</span> <span class="nv">count1</span><span class="p">)</span>
<span class="mi">2</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">eval</span> <span class="nv">count2</span><span class="p">)</span>
<span class="mi">3</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">eval</span> <span class="nv">count3</span><span class="p">)</span>
<span class="mi">1</span>
<span class="c1">;; Return: NIL</span>

<span class="c1">;; (shiftf PLACE ... VAL)</span>
<span class="c1">;; PLACE←←←</span>
<span class="c1">;; ↓</span>
<span class="c1">;; Return</span>
</code></pre></div></div>

<h4 id="binding-forms">Binding Forms</h4>

<p>The scope of function parameters and LET variables—the area of the program where the variable name can be used to refer to the variable’s binding—is delimited by the form that introduces the variable. This form—the function definition or the LET —is called the binding form.</p>

<h4 id="differences-of-defvar-and-defparameter">Differences of DEFVAR and DEFPARAMETER</h4>

<p>In short, DEFVAR can use to define unbinded variables and bind a value to an unbinded variables.DEFPARAMETER always bind a variable (binded or unbinded) with a value.</p>

<p>The difference between the two forms is that DEFPARAMETER always assigns the initial value to the named variable while DEFVAR does so only if the variable is undefined. A DEFVAR form can also be used with no initial value to define a global variable without giving it a value. Such a variable is said to be unbound.</p>

<p>Practically speaking, you should use DEFVAR to define variables that will contain data you’d want to keep even if you made a change to the source code that uses the variable. For instance, suppose the two variables defined previously are part of an application for control- ling a widget factory. It’s appropriate to define the <em>count</em> variable with DEFVAR because the number of widgets made so far isn’t invalidated just because you make some changes to the widget-making code.</p>

<h4 id="some-boring-tests">Some boring tests</h4>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;; Test 1</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">defparameter</span> <span class="vg">*fn*</span> <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nb">count</span> <span class="mi">0</span><span class="p">))</span> <span class="nf">#'</span><span class="p">(</span><span class="k">lambda</span> <span class="p">()</span> <span class="p">(</span><span class="nb">setf</span> <span class="nb">count</span> <span class="p">(</span><span class="nb">1+</span> <span class="nb">count</span><span class="p">)))))</span>
<span class="vg">*FN*</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">funcall</span> <span class="vg">*fn*</span><span class="p">)</span>
<span class="mi">1</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">funcall</span> <span class="vg">*fn*</span><span class="p">)</span>
<span class="mi">2</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">funcall</span> <span class="vg">*fn*</span><span class="p">)</span>
<span class="mi">3</span>
<span class="nv">CL-USER&gt;</span> <span class="vg">*fn*</span> <span class="c1">;; Now *fn* is a function and in it's closure, count is increasing.</span>
<span class="err">#</span><span class="nv">&lt;CLOSURE</span> <span class="p">(</span><span class="nv">LAMBDA</span> <span class="p">())</span> <span class="nv">{1005FB5C8B}&gt;</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">defparameter</span> <span class="vg">*fn*</span> <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nb">count</span> <span class="mi">0</span><span class="p">))</span> <span class="nf">#'</span><span class="p">(</span><span class="k">lambda</span> <span class="p">()</span> <span class="p">(</span><span class="nb">setf</span> <span class="nb">count</span> <span class="p">(</span><span class="nb">1+</span> <span class="nb">count</span><span class="p">)))))</span>
<span class="vg">*FN*</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">funcall</span> <span class="vg">*fn*</span><span class="p">)</span>
<span class="mi">1</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">funcall</span> <span class="vg">*fn*</span><span class="p">)</span>
<span class="mi">2</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">funcall</span> <span class="vg">*fn*</span><span class="p">)</span>
<span class="mi">3</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">defparameter</span> <span class="nb">count</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">;; If you can.</span>
<span class="nv">COUNT</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">funcall</span> <span class="vg">*fn*</span><span class="p">)</span> <span class="c1">;; In *fn* closure, COUNT is 4</span>
<span class="mi">4</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">eval</span> <span class="nb">count</span><span class="p">)</span> <span class="c1">;; In global closure, COUNT is 1</span>
<span class="mi">1</span>

<span class="c1">;; Test 2</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">defparameter</span> <span class="nv">fn</span> <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nb">count</span> <span class="mi">0</span><span class="p">))</span> <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"~a"</span> <span class="nb">count</span><span class="p">)</span> <span class="nf">#'</span><span class="p">(</span><span class="k">lambda</span> <span class="p">()</span> <span class="p">(</span><span class="nb">setf</span> <span class="nb">count</span> <span class="p">(</span><span class="nb">1+</span> <span class="nb">count</span><span class="p">)))))</span>
<span class="mi">0</span>
<span class="nv">FN</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">funcall</span> <span class="nv">fn</span><span class="p">)</span>
<span class="mi">1</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">funcall</span> <span class="nv">fn</span><span class="p">)</span>
<span class="mi">2</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">funcall</span> <span class="nv">fn</span><span class="p">)</span>

<span class="c1">;; Test 3</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nb">count</span> <span class="mi">0</span><span class="p">))</span> <span class="p">(</span><span class="nb">setf</span> <span class="nb">count</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">2</span> <span class="nb">count</span><span class="p">))</span> <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"~a"</span> <span class="nb">count</span><span class="p">)</span> <span class="p">(</span><span class="nb">funcall</span> <span class="nf">#'</span><span class="p">(</span><span class="k">lambda</span> <span class="p">()</span> <span class="p">(</span><span class="nb">setf</span> <span class="nb">count</span> <span class="p">(</span><span class="nb">1+</span> <span class="nb">count</span><span class="p">)))))</span>
<span class="mi">2</span>
<span class="mi">3</span>

<span class="c1">;; Test 4</span>
<span class="p">(</span><span class="nb">defparameter</span> <span class="nv">fn</span> <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nb">count</span> <span class="mi">0</span><span class="p">))</span> <span class="p">(</span><span class="nb">setf</span> <span class="nb">count</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">2</span> <span class="nb">count</span><span class="p">))</span> <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"~a"</span> <span class="nb">count</span><span class="p">)</span> <span class="p">(</span><span class="nb">funcall</span> <span class="nf">#'</span><span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nb">count</span><span class="p">)</span> <span class="p">(</span><span class="nb">setf</span> <span class="nb">count</span> <span class="p">(</span><span class="nb">1+</span> <span class="nb">count</span><span class="p">)))</span> <span class="nb">count</span><span class="p">)</span> <span class="nf">#'</span><span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nb">count</span><span class="p">)</span> <span class="p">(</span><span class="nb">setf</span> <span class="nb">count</span> <span class="p">(</span><span class="nb">1+</span> <span class="nb">count</span><span class="p">)))))</span>
<span class="mi">2</span>
<span class="nv">NF</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">funcall</span> <span class="nv">fn</span> <span class="mi">3</span><span class="p">)</span>
<span class="mi">4</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">funcall</span> <span class="nv">fn</span> <span class="mi">3</span><span class="p">)</span>
<span class="mi">4</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">eval</span> <span class="ss">'fn</span><span class="p">)</span>
<span class="err">#</span><span class="nv">&lt;FUNCTION</span> <span class="p">(</span><span class="nv">LAMBDA</span> <span class="p">(</span><span class="nv">COUNT</span><span class="p">))</span> <span class="nv">{1006865B1B}&gt;</span>
</code></pre></div></div>
<h3 id="chapter-7">Chapter 7</h3>

<div class="message">
Conditional constructs, boolean logic operators, loopings, macros.
</div>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;;; Chapter 7 MACRO 1</span>

<span class="c1">;; 1.Conditional Constructs</span>

<span class="c1">;; (if TEST THEN &amp;OPTIONAL ELSE)</span>
<span class="c1">;; If TEST don't return NIL,execute THEN,otherwise execute ELSE,if exists,special operator.</span>
<span class="c1">;; THEN and ELSE must behave as exactly one form.</span>
<span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="s">"An useless string"</span> <span class="s">"An useful string"</span><span class="p">)</span>
<span class="c1">;; Return : "An usefull string"</span>

<span class="c1">;; (progn &amp;REST FORMS)</span>
<span class="c1">;; Executes any number of forms in order and returns the value of the last form.</span>
<span class="c1">;; Normally work with IF.</span>
<span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
    <span class="p">(</span><span class="k">progn</span>
      <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"Two little black birds sitting on a hill."</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"One named Jack, the other named Hélodie Jaqueline."</span><span class="p">)))</span>
<span class="c1">;; Print: Two little black birds sitting on a hill.One named Jack, the other named Hélodie Jaqueline.</span>
<span class="c1">;; Return: NIL</span>
<span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">x</span> <span class="s">"Alexander"</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"Two little black birds sitting on a hill."</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"One named Jack, the other named Hélodie ~d Jaqueline."</span> <span class="nv">x</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">eval</span> <span class="nv">x</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">+</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)))</span>
<span class="c1">;; Print: Two little black birds sitting on a hill.One named Jack, the other named Hélodie Alexander Jaqueline.</span>
<span class="c1">;; Return: 5</span>
<span class="p">(</span><span class="k">if</span> <span class="nv">T</span> <span class="p">(</span><span class="nb">defparameter</span> <span class="vg">*test-if*</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nb">defparameter</span> <span class="vg">*test-if*</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1">;; Return: *TEST-IF*</span>
<span class="p">(</span><span class="nb">eval</span> <span class="vg">*test-if*</span><span class="p">)</span>
<span class="c1">;; Return: 3</span>

<span class="c1">;; (when TEST &amp;BODY FORMS)</span>
<span class="c1">;; If TEST don't return NIL,execute FORMS,macro</span>
<span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"Two little black birds sitting on a hill."</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">+</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">+</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">))</span>
<span class="c1">;; Print: Two little black birds sitting on a hill.</span>
<span class="c1">;; Return: 7</span>

<span class="c1">;; (unless TEST &amp;BODY FORMS)</span>
<span class="c1">;; If TEST return NIL,execute FORMS,macro</span>
<span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"Two little black birds sitting on a hill."</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">+</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">+</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">))</span>
<span class="c1">;; Return: NIL</span>

<span class="c1">;; (cond</span>
<span class="c1">;;   (test-1 form*)</span>
<span class="c1">;;   ...</span>
<span class="c1">;;   (test-n form*)</span>
<span class="c1">;; The conditions are evaluated in the order the branches appear in the body until one of them evaluates to true. At that point, the remaining forms in that branch are evaluated, and the value of the last form in the branch is returned as the value of the COND as a whole. If the branch contains no forms after the condition, the value of the condition is returned instead.</span>
<span class="p">(</span><span class="nb">cond</span>
  <span class="p">((</span><span class="nb">=</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="s">"Impossible."</span><span class="p">)</span>
  <span class="p">((</span><span class="nb">=</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"Two little bir.."</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)))</span>
<span class="c1">;; Print: Two little bir..</span>
<span class="c1">;; Return: (3 4)</span>

<span class="c1">;; 2.Boolean Logic Operators</span>

<span class="c1">;; (not OBJECT)</span>
<span class="c1">;; Logical negation,function.</span>
<span class="p">(</span><span class="nb">not</span> <span class="no">nil</span><span class="p">)</span>
<span class="c1">;; Return: T</span>
<span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">=</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">))</span>
<span class="c1">;; Return: NIL</span>

<span class="c1">;; (and &amp;REST FORMS)</span>
<span class="c1">;; Logical conjunction,macro.</span>
<span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nb">=</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="mi">3</span> <span class="mi">3</span><span class="p">))</span>
<span class="c1">;; Return: NIL</span>

<span class="c1">;; (or &amp;REST FORMS)</span>
<span class="c1">;; Logical disjunction,macro.</span>
<span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nb">=</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="mi">3</span> <span class="mi">3</span><span class="p">))</span>
<span class="c1">;; Return: T</span>

<span class="c1">;; 3.Loooooooooooooooooooping</span>


<span class="c1">;; (dolist (VAR LISTFORM &amp;OPTIONAL RESULTFORM) &amp;BODY BODY)</span>
<span class="c1">;; Loops across the items of a list, executing the loop body with a variable holding the successive items of the list,macro.</span>
<span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">x</span> <span class="o">'</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span> <span class="p">(</span><span class="nb">print</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">evenp</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">return</span><span class="p">)))</span>
<span class="c1">;; Print: 1</span>
<span class="c1">;; Print: 2</span>
<span class="c1">;; Return: NIL</span>

<span class="c1">;; (dotimes (VAR COUNT &amp;OPTIONAL (RESULT NIL)) &amp;BODY BODY)</span>
<span class="c1">;; Loop for COUNT tims.COUNT must be a integer,macro.</span>
<span class="p">(</span><span class="nb">dotimes</span> <span class="p">(</span><span class="nv">x</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nb">print</span> <span class="nv">x</span><span class="p">))</span>
<span class="c1">;; Print: 0</span>
<span class="c1">;; Print: 1</span>
<span class="c1">;; Print: 2</span>
<span class="c1">;; Return: NIL</span>

<span class="c1">;; (do</span>
<span class="c1">;;   ((VAR INIT [STEP]) ...)</span>
<span class="c1">;;   (END-TEST [RESULT...])</span>
<span class="c1">;;   BODY...)</span>
<span class="c1">;; Bind any number of variables,</span>
<span class="c1">;; complete control over how they change on each step through the loop by [STEP],</span>
<span class="c1">;; determines when to end the loop and can provide a form to evaluate at the end of the loop to generate a return value for the DO expression as a whole.</span>
<span class="p">(</span><span class="nb">do</span> <span class="p">((</span><span class="nv">n</span> <span class="mi">0</span> <span class="p">(</span><span class="nb">1+</span> <span class="nv">n</span><span class="p">))</span>
     <span class="p">(</span><span class="nv">cur</span> <span class="mi">0</span> <span class="nv">next</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">next</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">cur</span> <span class="nv">next</span><span class="p">)))</span>
    <span class="p">((</span><span class="nb">=</span> <span class="mi">10</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">cur</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print</span> <span class="nv">cur</span><span class="p">))</span>
<span class="c1">;; Compute fibonacci sequence.</span>
<span class="c1">;; Print: 0</span>
<span class="c1">;; Print: 1</span>
<span class="c1">;; Print: 1</span>
<span class="c1">;; Print: 2</span>
<span class="c1">;; Print: 3</span>
<span class="c1">;; Print: 5</span>
<span class="c1">;; Print: 8</span>
<span class="c1">;; Print: 13</span>
<span class="c1">;; Print: 21</span>
<span class="c1">;; Print: 34</span>
<span class="c1">;; Return!: 55</span>

<span class="c1">;; (loop  &amp;ENVIRONMENT &amp;REST KEYWORDS-AND-FORMS)</span>
<span class="c1">;; A mightly but lispization loop,The symbols across, and, below, collecting, counting, finally, for, from, summing, then, and to are some of the loop keywords whose presence identifies these as instances of the extended LOOP, macro.</span>
<span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">i</span> <span class="nv">from</span> <span class="mi">1</span> <span class="nv">to</span> <span class="mi">10</span> <span class="nv">collecting</span> <span class="nv">i</span><span class="p">)</span>
<span class="c1">;; Return: (1 2 3 4 5 6 7 8 9 10)</span>
<span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">x</span> <span class="nv">below</span> <span class="mi">10</span> <span class="nv">summing</span> <span class="p">(</span><span class="nb">expt</span> <span class="nv">x</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1">;; Return: 285</span>
<span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">x</span> <span class="nv">across</span> <span class="s">"the quick brown fox jumps over the lazy dog"</span>
   <span class="nv">counting</span> <span class="p">(</span><span class="nb">find</span> <span class="nv">x</span> <span class="s">"aeiou"</span><span class="p">))</span>
<span class="c1">;; Return: 11</span>
<span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">i</span> <span class="nv">below</span> <span class="mi">10</span>
   <span class="nb">and</span> <span class="nv">a</span> <span class="nb">=</span> <span class="mi">0</span> <span class="nv">then</span> <span class="nv">b</span>
   <span class="nb">and</span> <span class="nv">b</span> <span class="nb">=</span> <span class="mi">1</span> <span class="nv">then</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">b</span> <span class="nv">a</span><span class="p">)</span>
   <span class="nv">finally</span> <span class="p">(</span><span class="nb">return</span> <span class="nv">a</span><span class="p">))</span>
<span class="c1">;; Return: 55, the 10th item of fibonacci sequence.</span>

<span class="c1">;; (expt BASE POWER)</span>
<span class="c1">;; Expornent arithmetic,function.</span>
<span class="p">(</span><span class="nb">expt</span> <span class="mi">2</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">;; Return: 32</span>
</code></pre></div></div>

<h4 id="define-when-and-unless">Define WHEN and UNLESS</h4>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">defmacro</span> <span class="nb">when</span> <span class="p">(</span><span class="kt">condition</span> <span class="k">&amp;rest</span> <span class="nv">body</span><span class="p">)</span>
<span class="o">`</span><span class="p">(</span><span class="k">if</span> <span class="o">,</span><span class="kt">condition</span> <span class="p">(</span><span class="k">progn</span> <span class="o">,@</span><span class="nv">body</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defmacro</span> <span class="nb">unless</span> <span class="p">(</span><span class="kt">condition</span> <span class="k">&amp;rest</span> <span class="nv">body</span><span class="p">)</span>
<span class="o">`</span><span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="o">,</span><span class="kt">condition</span><span class="p">)</span> <span class="p">(</span><span class="k">progn</span> <span class="o">,@</span><span class="nv">body</span><span class="p">)))</span>
</code></pre></div></div>

<h4 id="short-circuit-in-and--or">Short-circuit in AND &amp; OR</h4>

<p>Macro AND &amp; OR evaluate only as many of their subforms—in left-to-right order—as necessary to determine the overall truth value. Thus, AND stops and returns NIL as soon as one of its subforms evaluates to NIL . If all the subforms evaluate to non- NIL , it returns the value of the last subform. OR , on the other hand, stops as soon as one of its subforms evaluates to non- NIL and returns the resulting value. If none of the subforms evaluate to true, OR returns NIL .</p>

<h4 id="do-always-use-old-values-to-build-new-values">DO always use OLD values to build NEW values!</h4>

<p>At each step of the iteration the step forms for all the variables are evaluated before assigning any of the values to the variables. This means you can refer to any of the other loop variables in the step forms. 6 That is, in a loop like this:</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">do</span> <span class="p">((</span><span class="nv">n</span> <span class="mi">0</span> <span class="p">(</span><span class="nb">1+</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">cur</span> <span class="mi">0</span> <span class="nv">next</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">next</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">cur</span> <span class="nv">next</span><span class="p">)))</span>
  <span class="p">((</span><span class="nb">=</span> <span class="mi">10</span> <span class="nv">n</span><span class="p">)</span> <span class="nv">cur</span><span class="p">))</span>
</code></pre></div></div>

<p>the step forms (1+ n), next, and (+ cur next) are all evaluated using the OLD values of n, cur, and next.</p>
<h3 id="chapter-8">Chapter 8</h3>
<div class="message">
    Macro definition.
</div>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;;; Chapter 8 MACRO 2</span>

<span class="c1">;; (defmacro NAME ARGLIST &amp;OPTIONAL DOCSTRING DECL &amp;REST BODY)</span>
<span class="c1">;; Define macros.</span>
<span class="p">(</span><span class="nb">defmacro</span> <span class="nv">once-only</span> <span class="p">((</span><span class="k">&amp;rest</span> <span class="nv">names</span><span class="p">)</span> <span class="k">&amp;body</span> <span class="nv">body</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">gensyms</span> <span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">n</span> <span class="nv">in</span> <span class="nv">names</span> <span class="nv">collect</span> <span class="p">(</span><span class="nb">gensym</span><span class="p">))))</span>
    <span class="o">`</span><span class="p">(</span><span class="k">let</span> <span class="p">(</span><span class="o">,@</span><span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">g</span> <span class="nv">in</span> <span class="nv">gensyms</span> <span class="nv">collect</span> <span class="o">`</span><span class="p">(</span><span class="o">,</span><span class="nv">g</span> <span class="p">(</span><span class="nb">gensym</span><span class="p">))))</span>
       <span class="o">`</span><span class="p">(</span><span class="k">let</span> <span class="p">(</span><span class="o">,,@</span><span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">g</span> <span class="nv">in</span> <span class="nv">gensyms</span> <span class="nv">for</span> <span class="nv">n</span> <span class="nv">in</span> <span class="nv">names</span> <span class="nv">collect</span> <span class="o">``</span><span class="p">(</span><span class="o">,,</span><span class="nv">g</span> <span class="o">,,</span><span class="nv">n</span><span class="p">)))</span>
          <span class="o">,</span><span class="p">(</span><span class="k">let</span> <span class="p">(</span><span class="o">,@</span><span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">n</span> <span class="nv">in</span> <span class="nv">names</span> <span class="nv">for</span> <span class="nv">g</span> <span class="nv">in</span> <span class="nv">gensyms</span> <span class="nv">collect</span> <span class="o">`</span><span class="p">(</span><span class="o">,</span><span class="nv">n</span> <span class="o">,</span><span class="nv">g</span><span class="p">)))</span>
                <span class="o">,@</span><span class="nv">body</span><span class="p">)))))</span>
<span class="c1">;; Return: ONCE-ONLY</span>

<span class="c1">;; (gensym &amp;OPTIONAL (THING G))</span>
<span class="c1">;; Returns a unique symbol each time it’s called. This is a symbol that has never been read by the Lisp reader and never will be because it isn’t interned in any package, function.</span>
<span class="p">(</span><span class="nb">gensym</span><span class="p">)</span>
<span class="c1">;; Return: #:G721, perhaps...</span>

<span class="c1">;; (macroexpand-1 FORM &amp;OPTIONAL ENV)</span>
<span class="c1">;; Takes any Lisp expression as an argument and returns the result of doing one level of macro expansion,function.</span>
<span class="p">(</span><span class="nb">macroexpand-1</span> <span class="o">`</span><span class="p">(</span><span class="nv">once-only</span> <span class="ss">'a</span> <span class="ss">'b</span><span class="p">))</span>
<span class="c1">;;Return :</span>
<span class="p">(</span><span class="nv">LET</span> <span class="p">((</span><span class="ss">#:G730</span> <span class="p">(</span><span class="nv">GENSYM</span><span class="p">))</span> <span class="p">(</span><span class="ss">#:G731</span> <span class="p">(</span><span class="nv">GENSYM</span><span class="p">)))</span>
  <span class="o">`</span><span class="p">(</span><span class="nv">LET</span> <span class="p">((</span><span class="o">,</span><span class="ss">#:G730</span> <span class="o">,</span><span class="nv">QUOTE</span><span class="p">)</span> <span class="p">(</span><span class="o">,</span><span class="ss">#:G731</span> <span class="o">,</span><span class="nv">A</span><span class="p">))</span>
     <span class="o">,</span><span class="p">(</span><span class="nv">LET</span> <span class="p">((</span><span class="nv">QUOTE</span> <span class="ss">#:G730</span><span class="p">)</span> <span class="p">(</span><span class="nv">A</span> <span class="ss">#:G731</span><span class="p">))</span>
           <span class="ss">'B</span><span class="p">)))</span>
<span class="nv">T</span>
</code></pre></div></div>

<h4 id="macro-expansion-time--runtime">Macro Expansion Time &amp; Runtime</h4>

<p>The key to understanding macros is to be quite clear about the distinction between the code that generates code (macros) and the code that eventually makes up the program (everything else). When you write macros, you’re writing programs that will be used by the compiler to generate the code that will then be compiled. Only after all the macros have been fully expandedand the resulting code compiled can the program actually be run. The time when macros run is called macro expansion time; this is distinct from runtime, when regular code, including the code generated by macros, runs.</p>

<h4 id="general-steps-to-writing-macros">General Steps to Writing Macros</h4>

<ol>
  <li>Write a sample call to the macro and the code it should expand into, or vice versa.</li>
  <li>Write code that generates the handwritten expansion from the arguments in the
sample call.</li>
  <li>Make sure the macro abstraction doesn’t “leak.”</li>
</ol>

<h4 id="-and-">, and ,@</h4>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">CL-USER&gt;</span> <span class="o">`</span><span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="o">,</span><span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>
<span class="p">(</span><span class="nv">LIST</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>
<span class="nv">CL-USER&gt;</span> <span class="o">`</span><span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="o">,@</span><span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">))</span>
<span class="p">(</span><span class="nv">LIST</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="leaks-and-rules-preventing-leaks">Leaks and Rules preventing Leaks</h4>

<p>LEAKS:</p>

<ol>
  <li>Multiple evaluate for a form (value) which should be execute only 1 time (identical one).</li>
  <li>Disruption to sequence of evaluate the formal parameter.</li>
  <li>A binding may cause conflicts to value name.</li>
</ol>

<p>RULES:</p>

<ol>
  <li>Unless there’s a particular reason to do otherwise, include any subforms in the expansion in positions that will be evaluated in the same order as the subforms appear in the macro call.</li>
  <li>Unless there’s a particular reason to do otherwise, make sure subforms are evaluated only once by creating a variable in the expansion to hold the value of evaluating the argument form and then using that variable anywhere else the value is needed in the expansion.</li>
  <li>Use GENSYM at macro expansion time to create variable names used in the expansion.
    <h3 id="chapter-9">Chapter 9</h3>
  </li>
</ol>

<div class="message">
    Practice: unit test framework.
</div>

<ul>
  <li>
    <p>Wait… I have done no offence, one more time, I have done no offence.</p>
  </li>
  <li>
    <p>You have done, repetition.Wish you a better eternity.</p>
  </li>
</ul>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="p">(</span><span class="nb">defvar</span> <span class="vg">*test-name*</span> <span class="no">nil</span><span class="p">)</span>

<span class="p">(</span><span class="nb">defmacro</span> <span class="nv">deftest</span> <span class="p">(</span><span class="nv">name</span> <span class="nv">parameters</span> <span class="k">&amp;body</span> <span class="nv">body</span><span class="p">)</span>
  <span class="s">"Define a test function. Within a test function we can call
  other test functions or use 'check' to run individual test
  cases."</span>
  <span class="o">`</span><span class="p">(</span><span class="nb">defun</span> <span class="o">,</span><span class="nv">name</span> <span class="o">,</span><span class="nv">parameters</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="vg">*test-name*</span> <span class="p">(</span><span class="nb">append</span> <span class="vg">*test-name*</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">',name</span><span class="p">))))</span>
     <span class="o">,@</span><span class="nv">body</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defmacro</span> <span class="nv">check</span> <span class="p">(</span><span class="k">&amp;body</span> <span class="nv">forms</span><span class="p">)</span>
  <span class="s">"Run each expression in 'forms' as a test case."</span>
  <span class="o">`</span><span class="p">(</span><span class="nv">combine-results</span>
   <span class="o">,@</span><span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">f</span> <span class="nv">in</span> <span class="nv">forms</span> <span class="nv">collect</span> <span class="o">`</span><span class="p">(</span><span class="nv">report-result</span> <span class="o">,</span><span class="nv">f</span> <span class="ss">',f</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">defmacro</span> <span class="nv">combine-results</span> <span class="p">(</span><span class="k">&amp;body</span> <span class="nv">forms</span><span class="p">)</span>
  <span class="s">"Combine the results (as booleans) of evaluating 'forms' in order."</span>
  <span class="p">(</span><span class="nv">with-gensyms</span> <span class="p">(</span><span class="nv">result</span><span class="p">)</span>
    <span class="o">`</span><span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="o">,</span><span class="nv">result</span> <span class="no">t</span><span class="p">))</span>
      <span class="o">,@</span><span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">f</span> <span class="nv">in</span> <span class="nv">forms</span> <span class="nv">collect</span> <span class="o">`</span><span class="p">(</span><span class="nb">unless</span> <span class="o">,</span><span class="nv">f</span> <span class="p">(</span><span class="nb">setf</span> <span class="o">,</span><span class="nv">result</span> <span class="no">nil</span><span class="p">)))</span>
      <span class="o">,</span><span class="nv">result</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">report-result</span> <span class="p">(</span><span class="nv">result</span> <span class="nv">form</span><span class="p">)</span>
  <span class="s">"Report the results of a single test case. Called by 'check'."</span>
  <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"~:[FAIL~;pass~] ... ~a: ~a~%"</span> <span class="nv">result</span> <span class="vg">*test-name*</span> <span class="nv">form</span><span class="p">)</span>
<span class="nv">result</span><span class="p">)</span>
</code></pre></div></div>
<h3 id="chapter-10">Chapter 10</h3>

<div class="message">
Rationals, floating-point numbers, complex numbers, basic math, characters, strings and their comparisons.
</div>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;;; Chapter 10 NUMBERS &amp; CHARACTERS &amp;STRINGS</span>

<span class="c1">;; (+ &amp;REST NUMBERS)</span>
<span class="c1">;; (- NUMBER &amp;REST MORE-NUMBERS)</span>
<span class="c1">;; (* &amp;REST NUMBERS)</span>
<span class="c1">;; (/ NUMBER &amp;REST MORE-NUMBERS)</span>
<span class="c1">;; (1+ NUMBER)</span>
<span class="c1">;; (1- NUMBER)</span>
<span class="c1">;; (&lt; NUMBER &amp;REST MORE-NUMBERS)</span>
<span class="c1">;; (&gt; NUMBER &amp;REST MORE-NUMBERS)</span>
<span class="c1">;; (= NUMBER &amp;REST MORE-NUMBERS)</span>
<span class="c1">;; (/= NUMBER &amp;REST MORE-NUMBERS)</span>
<span class="c1">;; (&lt;= NUMBER &amp;REST MORE-NUMBERS)</span>
<span class="c1">;; (&gt;= NUMBER &amp;REST MORE-NUMBERS)</span>
<span class="c1">;; (min NUMBER &amp;REST MORE-NUMBERS)</span>
<span class="c1">;; (max NUMBER &amp;REST MORE-NUMBERS)</span>
<span class="c1">;; (zerop NUMBER)</span>
<span class="c1">;; (minusp NUMBER)</span>
<span class="c1">;; (plusp NUMBER)</span>
<span class="c1">;; (evenp NUMBER)</span>
<span class="c1">;; (oddp NUMBER)</span>

<span class="c1">;; (log NUMBER &amp;OPTIONAL (BASE NIL BASE-P))</span>
<span class="c1">;; Logarithms.</span>

<span class="c1">;; (exp NUMBER)</span>
<span class="c1">;; (expt BASE POWER)</span>
<span class="c1">;; Exponentiation.</span>

<span class="c1">;; (sin NUMBER)</span>
<span class="c1">;; (cos NUMBER)</span>
<span class="c1">;; (tan NUMBER)</span>
<span class="c1">;; (asin NUMBER)</span>
<span class="c1">;; (acos NUMBER)</span>
<span class="c1">;; (atan NUMBER)</span>
<span class="c1">;; Basic trigonometric functions, and their inverses.</span>

<span class="c1">;; (sinh NUMBER)</span>
<span class="c1">;; (cosh NUMBER)</span>
<span class="c1">;; (tanh NUMBER)</span>
<span class="c1">;; (asinh NUMBER)</span>
<span class="c1">;; (acosh NUMBER)</span>
<span class="c1">;; (atanh NUMBER)</span>
<span class="c1">;; Hyperbolic functions and their inverses.</span>

<span class="c1">;; (floor NUMBER &amp;OPTIONAL (DIVISOR 1))</span>
<span class="c1">;; Truncates toward negative infinity, returning the largest integer less than or equal to the argument.</span>
<span class="p">(</span><span class="nb">floor</span> <span class="mf">1.6</span><span class="p">)</span>
<span class="c1">;; Return: 1</span>
<span class="c1">;; Return: 0.6</span>
<span class="p">(</span><span class="nb">floor</span> <span class="mf">5.5</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">;; Return: 2</span>
<span class="c1">;; Return: 1.5</span>

<span class="c1">;; (ceiling NUMBER &amp;OPTIONAL (DIVISOR 1))</span>
<span class="c1">;; Truncates toward positive infinity, returning the smallest integer greater than or equal to the argument.</span>
<span class="p">(</span><span class="nb">ceiling</span> <span class="mf">2.4</span><span class="p">)</span>
<span class="c1">;; Return: 3</span>
<span class="c1">;; Return: -0.5999999</span>

<span class="c1">;; (truncate NUMBER &amp;OPTIONAL (DIVISOR 1))</span>
<span class="c1">;; Truncates toward zero, making it equivalent to FLOOR for positive arguments and to CEILING for negative arguments.</span>

<span class="c1">;; (ROUND NUMBER &amp;OPTIONAL (DIVISOR 1))</span>
<span class="c1">;; Rounds to the nearest integer. If the argument is exactly halfway between two integers, it rounds to the nearest even integer.</span>

<span class="c1">;; (mod NUMBER DIVISOR)</span>
<span class="c1">;; Return the modulus.</span>
<span class="p">(</span><span class="nb">mod</span> <span class="mi">10</span> <span class="mi">-3</span><span class="p">)</span>
<span class="mi">-2</span>

<span class="c1">;; (rem NUMBER DIVISOR)</span>
<span class="c1">;; Return the remainder.</span>
<span class="p">(</span><span class="nb">rem</span> <span class="mi">10</span> <span class="mi">-3</span><span class="p">)</span>
<span class="mi">1</span>
</code></pre></div></div>

<h3 id="comparisons">Comparisons.</h3>

<table>
    <thead>
        <tr>
            <td>numbers</td>
            <td>char-case-sensitive</td>
            <td>char-case-insensitive</td>
            <td>str-case-sensitive</td>
            <td>str-case-insensitive</td>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>=</td>
            <td>CHAR=</td>
            <td>CHAR-EQUAL</td>
            <td>STRING=</td>
            <td>STRING-EQUAL</td>
        </tr>
        <tr>
            <td>=</td>
            <td>CHAR=</td>
            <td>CHAR-NOT-EQUAL</td>
            <td>STRING=</td>
            <td>STRING-NOT-EQUAL</td>
        </tr>
        <tr>
            <td>&lt;</td>
            <td>CHAR&lt;</td>
            <td>CHAR-LESSP</td>
            <td>STRING&lt;</td>
            <td>STRING-LESSP</td>
        </tr>
        <tr>
            <td>&gt;</td>
            <td>CHAR&gt;</td>
            <td>CHAR-GREATERP</td>
            <td>STRING&gt;</td>
            <td>STRING-GREATERP</td>
        </tr>
        <tr>
            <td>&lt;=</td>
            <td>CHAR&lt;=</td>
            <td>CHAR-NOT-GREATERP</td>
            <td>STRING&lt;=</td>
            <td>STRING-NOT-GREATERP</td>
        </tr>
        <tr>
            <td>&gt;=</td>
            <td>CHAR&gt;=</td>
            <td>CHAR-NOT-LESSP</td>
            <td>STRING&gt;=</td>
            <td>STRING-NOTE-LESSP</td>
        </tr>
    </tbody>
</table>

<p>1.The functions &lt; , &gt; , &lt;= , and &gt;= order rationals and floating-point numbers (in other words, the real numbers.) Like = and /= , these functions can be called with more than two arguments, in which case each argument is compared to the argument to its right.</p>

<p>2.Like = , CHAR= can take any number of arguments and returns true only if they’re all the same character.</p>

<p>3.The string comparators can compare only two strings. That’s because they also take keyword arguments that allow you to restrict the comparison to a substring of either or both strings. The arguments—:start1, :end1, :start2, and :end2—specify the starting (inclusive) and ending (exclusive) indices of substrings in the first and second string arguments.</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">string=</span> <span class="s">"foobarbaz"</span> <span class="s">"quuxbarfoo"</span> <span class="ss">:start1</span> <span class="mi">3</span> <span class="ss">:end1</span> <span class="mi">6</span> <span class="ss">:start2</span> <span class="mi">4</span> <span class="ss">:end2</span> <span class="mi">7</span><span class="p">)</span>
<span class="c1">;; Return: T</span>

<span class="p">(</span><span class="nb">string/=</span> <span class="s">"lisp"</span> <span class="s">"lissome"</span><span class="p">)</span>
<span class="c1">;; Return: 3, the index.</span>

<span class="p">(</span><span class="nb">string&lt;</span> <span class="s">"lisp"</span> <span class="s">"lisper"</span><span class="p">)</span>
<span class="c1">;; Return: 4, the index.</span>
</code></pre></div></div>

<h4 id="something-about-numbers">Something about Numbers</h4>

<p>Binary number: #B or #b</p>

<p>Octal number: #O or #o</p>

<p>Hexadecimal: #X or #x</p>

<p>Others base: #nR and n is the base from 2 to 36. (0-Z)</p>

<p>The digits in a floating-point number are always treated as base 10 digits—the #B, #X, #O, and #R syntaxes work only with rationals.</p>

<p>Complex numbers: #c(real-part imaginary-part)</p>

<h4 id="rem-and-mod">REM and MOD</h4>

<p>Two related functions are MOD and REM , which return the modulus and remainder of a truncating division on real numbers. These two functions are related to the FLOOR and TRUNCATE functions as follows:</p>

<p>(+ (* (floor(/ x y)) y) (mod x y)) ≡ x</p>

<p>(+ (* (truncate (/ x y)) y) (rem x y)) ≡ x</p>

<p>Thus, for positive quotients they’re equivalent, but for negative quotients they produce different results.</p>

<h4 id="1-1--incf-and-decf">1+, 1-, INCF and DECF</h4>

<p>1+ and 1- are just functions that return a new value, but INCF and DECF modify a place.</p>

<h3 id="characters">Characters</h3>

<p>#\x → x</p>

<p>#\Space</p>

<p>#\Newline</p>

<p>#\Tab</p>

<p>#\Rubout</p>

<p>#\Linefeed</p>

<p>#\Return</p>

<p>#\Backspace</p>
<h3 id="chapter-11">Chapter 11</h3>

<div class="message">
    Vectors and hashtables.
    </div>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;;; Chapter 11 VECTOR &amp; HASHTABLE</span>

<span class="c1">;; (vector $REST OBJECTS)</span>
<span class="c1">;; Make fixed-size vectors containing specific values, functions.</span>
<span class="p">(</span><span class="nb">vector</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">;; Return: #(1 2)</span>

<span class="c1">;; (make-array DIMENSIONS &amp;KEY (ELEMENT-TYPE T) (INITIAL-ELEMENT NIL INITIAL-ELEMENT-P) (INITIAL-CONTENTS NIL INITIAL-CONTENTS-P) ADJUSTABLE FILL-POINTER DISPLACED-TO DISPLACED-INDEX-OFFSET)</span>
<span class="c1">;; Create arrays of any dimensionality as well as both fixed-size and resizable vectors, functions.</span>
<span class="p">(</span><span class="nb">make-array</span> <span class="mi">5</span> <span class="ss">:fill-pointer</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1">;; Return: #()</span>

<span class="c1">;; (vector-push NEW-ELEMENT ARRAY)</span>
<span class="c1">;; Add an element to the end of a resizable vector, adds the element at the current value of the fill pointer and then increments the fill pointer by one, returning the index where the new element was added, funtions.</span>
<span class="c1">;; (vector-pop ARRAY)</span>
<span class="c1">;; Returns the most recently pushed item, decrementing the fill pointer in the process, functions.</span>
<span class="c1">;; (vector-push-extend NEW-ELEMENT ARRAY &amp;OPTIONAL MIN-EXTENSION)</span>
<span class="c1">;; Works just like VECTOR-PUSH except it will automatically expand the array if you try to push an element onto a full vector—one whose fill pointer is equal to the size of the underlying storage, macro.</span>

<span class="c1">;; (length SEQUENCE)</span>
<span class="c1">;; Return the size of a sequence, function.</span>

<span class="c1">;; (elt SEQUENCE INDEX)</span>
<span class="c1">;; Takes a sequence and an integer index between zero (inclusive) and the length of the sequence (exclusive) and returns the corresponding element, functions.</span>

<span class="c1">;; Functions to count,search,remove and replace:</span>
<span class="c1">;; (count ITEM SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) (END NIL) (KEY NIL) (TEST #'EQL TEST-P) (TEST-NOT NIL TEST-NOT-P))</span>
<span class="c1">;; Return: Number of times item appears in sequence</span>
<span class="c1">;; (find ITEM SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) END KEY TEST TEST-NOT)</span>
<span class="c1">;; Return: Item or NIL.</span>
<span class="c1">;; (position ITEM SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) END KEY TEST TEST-NOT)</span>
<span class="c1">;; Return: Index into sequence or NIL</span>
<span class="c1">;; (remove ITEM SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (TEST #'EQL) (TEST-NOT NIL) (START 0) (END NIL) (COUNT NIL) (KEY NIL))</span>
<span class="c1">;; Return: Sequence with instances of item removed</span>
<span class="c1">;; (substitute NEW OLD SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (TEST #'EQL) (TEST-NOT NIL) (START 0) (COUNT NIL) (END NIL) (KEY NIL))</span>
<span class="c1">;; Return: Sequence with instances of item replaced with new item</span>
<span class="c1">;; Arguments:</span>
<span class="c1">;; :test : pass a function that accepts two arguments and returns a boolean. If provided,it will be used to compare item to each element instead of the default object equality test, EQL</span>
<span class="c1">;; :key : pass a one-argument function to be called on each element of the sequence to extract a key value, which will then be compared to the item in the place of the element itself.</span>
<span class="c1">;; :start &amp; :end : Limit the effects of these functions to a particular subsequence of the sequence argument.</span>
<span class="c1">;; :from-end : If is provided as a non-NIL, the elements of the sequence will be examined in reverse order.</span>
<span class="c1">;; :count : Used to specify how many elements to remove or substitute.</span>

<span class="c1">;; other functions:</span>
<span class="c1">;; (count-if PRED SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) (END NIL) (KEY NIL))</span>
<span class="c1">;; (count-if-not PRED SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) (END NIL) (KEY NIL))</span>
<span class="c1">;; (find-if PREDICATE SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) END KEY)</span>
<span class="c1">;; (find-if-not PREDICATE SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) END KEY)</span>
<span class="c1">;; (position-if PREDICATE SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) END KEY)</span>
<span class="c1">;; (position-if-not PREDICATE SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) END KEY)</span>
<span class="c1">;; (remove-if PREDICATE SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) (END NIL) (COUNT NIL) (KEY NIL))</span>
<span class="c1">;; (remove-if-not PREDICATE SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) (END NIL) (COUNT NIL) (KEY NIL))</span>
<span class="c1">;;(substitute-if NEW PREDICATE SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) (END NIL) (COUNT NIL) (KEY NIL))</span>
<span class="c1">;; (substitute-if-not NEW PREDICATE SEQUENCE &amp;REST ARGS &amp;KEY FROM-END (START 0) (END NIL) (COUNT NIL) (KEY NIL))</span>
<span class="c1">;; In the place of the item argument, they all take a function to be called on each element of the sequence, that is PRED must be that function.</span>

<span class="c1">;; (remove-duplicates SEQUENCE &amp;REST ARGS &amp;KEY (TEST #'EQL) (TEST-NOT NIL) (START 0) (END NIL) FROM-END (KEY NIL))</span>
<span class="c1">;; Removes all but one instance of each duplicated element.</span>

<span class="c1">;; (copy-seq SEQUENCE)</span>
<span class="c1">;; (reverse SEQUENCE)</span>
<span class="c1">;; (concatenate OUTPUT-TYPE-SPEC &amp;REST SEQUENCES)</span>

<span class="c1">;; (sort SEQUENCE PREDICATE &amp;REST ARGS &amp;KEY KEY)</span>
<span class="c1">;; (stable-sort SEQUENCE PREDICATE &amp;REST ARGS &amp;KEY KEY)</span>

<span class="c1">;; (merge SEQUENCE PREDICATE &amp;REST ARGS &amp;KEY KEY)</span>

<span class="c1">;; (fill SEQUENCE ITEM &amp;KEY (START 0) END)</span>
<span class="c1">;; Set multiple elements of a sequence to a single value</span>

<span class="c1">;; (subseq SENQUENCE START &amp;OPTIONAL END)</span>
<span class="c1">;; Extracts a subsequence starting at a particular index and continuing to a particular ending index or the end of the sequence.</span>

<span class="c1">;; (search SEQUENCE1 SEQUENCE2 &amp;REST ARGS &amp;KEY FROM-END (TEST #'EQL) (TEST-NOT NIL) (START1 0) (END1 NIL) (START2 0) (END2 NIL) (KEY NIL))</span>
<span class="c1">;; Works like POSITION except the first argument is a sequence rather than a single item.</span>

<span class="c1">;; (mismatch SEQUENCE1 SEQUENCE2 &amp;REST ARGS &amp;KEY FROM-END (TEST #'EQL) (TEST-NOT NIL) (START1 0) (END1 NIL) (START2 0) (END2 NIL) (KEY NIL))</span>
<span class="c1">;; Find where two sequences with a common prefix first diverge</span>

<span class="c1">;; (every PRED FIRSET-SEQ &amp;REST MORE-SEQS)</span>
<span class="c1">;; (some PRED FIRST-SEQ &amp;REST MORE-SEQS)</span>
<span class="c1">;; (notany PRED FIRST-SEQ &amp;REST MORE-SEQS)</span>
<span class="c1">;; (notevery PRED FIRST-SEQ &amp;REST MORE-SEQS)</span>
<span class="c1">;; Iterate over sequences testing a boolean predicate. The first argument to all these functions is the predicate, and the remaining arguments are sequences. The predicate should take as many arguments as the number of sequences passed. The elements of the sequences are passed to the predicate one element from each sequence—until one of the sequences runs out of elements or the overall termination test is met: EVERY terminates, returning false, as soon as the predicate fails. If the predicate is always satisfied, it returns true. SOME returns the first non- NIL value returned by the predicate or returns false if the predicate is never satisfied. NOTANY returns false as soon as the predicate is satisfied or true if it never is. And NOTEVERY returns true as soon as the predicate fails or false if the predicate is always satisfied. Here are some examples of testing just one sequence.</span>

<span class="c1">;; (map RESULT-TYPE FUNCTION FIRST-SEQUENCE &amp;REST MORE-SEQUENCE)</span>
<span class="c1">;; Takes a n-argument function and n sequences, returns a new sequence containing the result of applying the function to subsequent elements of the sequences, function.</span>
<span class="p">(</span><span class="nb">map</span> <span class="ss">'vector</span> <span class="nf">#'</span><span class="nb">*</span> <span class="o">#(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">)</span> <span class="o">#(</span><span class="mi">10</span> <span class="mi">9</span> <span class="mi">8</span> <span class="mi">7</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1">;; Return: #(10 18 24 28 30)</span>

<span class="c1">;; (map-into RESULT-SEQUENCE FUNCTION &amp;REST SEQUENCE)</span>
<span class="c1">;; Places the results into a sequence passed as the first argument</span>
<span class="p">(</span><span class="nb">map-into</span> <span class="o">#(</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span>  <span class="nf">#'</span><span class="nb">+</span> <span class="o">#(</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span> <span class="o">#(</span><span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">1</span><span class="p">))</span>
<span class="c1">;; Return: #(5 7 9)</span>

<span class="c1">;; (Reduce FUNCTION SEQUENCE &amp;REST ARGS &amp;KEY (KEY NIL) FROM-END (START 0) (END NIL) (INITIAL-VALUE NIL IVP))</span>
<span class="c1">;; Maps over a single sequence, applying a two-argument function first to the first two elements of the sequence and then to the value returned by the function and subsequent elements of the sequence.</span>
<span class="p">(</span><span class="nb">reduce</span> <span class="nf">#'</span><span class="nb">+</span> <span class="o">#(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span><span class="p">))</span>
<span class="c1">;; Return: 55</span>

<span class="c1">;; (make-hash-table &amp;KEY (TEST 'EQL) (SIZE +MIN-HASH-TABLE-SIZE+) (REHASH-SIZE 1.5) (REHASH-THRESHOLD 1) (HASH-FUNCTION NIL) (WEAKNESS NIL) (SYNCHRONIZED)</span>
<span class="c1">;; Makes a hash table that considers two keys equivalent if they’re the same object according to EQL . This is a good default unless you want to use strings as keys, since two strings with the same contents aren’t necessarily EQL.MAKE-HASH-TABLE ’s :test can’t be used to specify an arbitrary function—only the values EQ , EQL , EQUAL , and EQUALP .</span>

<span class="c1">;; (gethash KEY HASH-TABLE &amp;OPTIONAL DEFAUTL)</span>
<span class="c1">;; GETHASH function provides access to the elements of a hash table. It takes two arguments—a key and the hash table—and returns the value, if any, stored in the hash table under that key or NIL.</span>

<span class="c1">;; (remhash KEY HASH-TABLE)</span>
<span class="c1">;; Delete one item.</span>

<span class="c1">;; (clrhash HASH-TABLE)</span>
<span class="c1">;; Completely clear a hash table of all its key/value pairs</span>

<span class="c1">;; (maphash FUNCTION HASH-TABLE)</span>
<span class="c1">;; Takes a two-argument function and a hash table and invokes the function once for each key/value pair in the hash table.</span>
</code></pre></div></div>

<h3 id="complement--test-not">COMPLEMENT &amp; :test-not</h3>

<p>Another parameter, :test-not parameter, specifies a two-argument predicate to be used like a :test argument except with the boolean result logically reversed. This parameter is deprecated, however, in preference for using the COMPLEMENT function. COMPLEMENT takes a function argument and returns a function that takes the same number of arguments as the original and returns the logical complement of the original function. Thus, you can, and should, write this:</p>

<p>(count x sequence :test (complement #’some-test))</p>

<p>rather than the following:</p>

<p>(count x sequence :test-not #’some-test)</p>

<h3 id="copy-seq--reverse">COPY-SEQ &amp; REVERSE</h3>

<p>Neither function copies the elements themselves—only the returned sequence is a new object.</p>
<h3 id="chapter-12">Chapter 12</h3>

<div class="message">
    List, for-side-effect and recycling operatings.
</div>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;;; Chapter 12 LIST</span>

<span class="p">(</span><span class="nb">cons</span> <span class="nv">CAR</span> <span class="nv">CDR</span><span class="p">)</span>

<span class="p">(</span><span class="nb">car</span> <span class="nv">LIST</span><span class="p">)</span>

<span class="p">(</span><span class="nb">cdr</span> <span class="nv">LIST</span><span class="p">)</span>

<span class="p">(</span><span class="nb">rplaca</span> <span class="nv">CONS</span> <span class="nv">NEWCAR</span><span class="p">)</span>

<span class="p">(</span><span class="nb">rplacd</span> <span class="nv">CONS</span> <span class="nv">NEWCDR</span><span class="p">)</span>

<span class="p">(</span><span class="nb">first</span> <span class="nv">LIST</span><span class="p">)</span>
<span class="p">(</span><span class="nb">second</span> <span class="nv">LIST</span><span class="p">)</span>
<span class="o">...</span>
<span class="p">(</span><span class="nb">tenth</span> <span class="nv">LIST</span><span class="p">)</span>
<span class="p">(</span><span class="nb">nth</span> <span class="nv">N</span> <span class="nv">LIST</span><span class="p">)</span>

<span class="p">(</span><span class="nb">cadr</span> <span class="nv">X</span><span class="p">)</span>
<span class="p">(</span><span class="nb">cdar</span> <span class="nv">X</span><span class="p">)</span>
<span class="p">(</span><span class="nb">caaar</span> <span class="nv">X</span><span class="p">)</span>
<span class="o">...</span>
<span class="p">(</span><span class="nb">cdddr</span> <span class="nv">X</span><span class="p">)</span>
<span class="p">(</span><span class="nb">caaaar</span> <span class="nv">X</span><span class="p">)</span>
<span class="o">...</span>
<span class="p">(</span><span class="nb">cddddr</span> <span class="nv">X</span><span class="p">)</span>

<span class="p">(</span><span class="nb">rest</span> <span class="nv">LIST</span><span class="p">)</span>

<span class="p">(</span><span class="nb">append</span> <span class="nv">&amp;REST</span> <span class="nv">SENQUENCES</span><span class="p">)</span>
<span class="c1">;; Takes any number of list arguments and returns a new list containing the elements of all its arguments.</span>
<span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="p">))</span>
<span class="c1">;; Return: (1 2 3 4 4 5 6 7)</span>

<span class="c1">;; Recycling Functions:</span>
<span class="c1">;; nsubstitute   : subsititute</span>
<span class="p">(</span><span class="nb">nsubstitute</span> <span class="nv">NEW</span> <span class="nv">OLD</span> <span class="nv">SEQUENCE</span> <span class="nv">&amp;REST</span> <span class="nv">ARGS</span> <span class="nv">&amp;KEY</span> <span class="nv">FROM-END</span> <span class="p">(</span><span class="nv">TEST</span> <span class="nf">#'</span><span class="nv">EQL</span><span class="p">)</span> <span class="p">(</span><span class="nv">TEST-NOT</span> <span class="nv">NIL</span><span class="p">)</span> <span class="p">(</span><span class="nv">END</span> <span class="nv">NIL</span><span class="p">)</span> <span class="p">(</span><span class="nv">COUNT</span> <span class="nv">NIL</span><span class="p">)</span> <span class="p">(</span><span class="nv">KEY</span> <span class="nv">NIL</span><span class="p">)</span> <span class="p">(</span><span class="nv">START</span> <span class="mi">0</span><span class="p">))</span>
<span class="c1">;; nreverse : reverse</span>
<span class="p">(</span><span class="nb">nreverse</span> <span class="nv">SEQUENCE</span><span class="p">)</span>
<span class="c1">;; nconc : append</span>
<span class="p">(</span><span class="nb">nconc</span> <span class="nv">&amp;REST</span> <span class="nv">LISTS</span><span class="p">)</span>
<span class="c1">;; delete, delete-if, delete-if-not, delete-dupulicate : remove, remove-if, remove-if-not, remove-duplicate</span>

<span class="c1">;; List-manipulation functions:</span>
<span class="p">(</span><span class="nb">last</span> <span class="nv">LIST</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">N</span> <span class="mi">1</span><span class="p">))</span>
<span class="c1">;; Returns the last cons cell in a list. With an integer, argument returns the last n cons cells.</span>
<span class="p">(</span><span class="nb">butlast</span> <span class="nv">LIST</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">N</span> <span class="mi">1</span><span class="p">))</span>
<span class="c1">;; Returns a copy of the list, excluding the last cons cell. With an integer argument, excludes the last n cells.</span>
<span class="p">(</span><span class="nb">nbutlast</span> <span class="nv">LIST</span> <span class="nv">&amp;OPTIANAL</span> <span class="p">(</span><span class="nv">N</span> <span class="mi">1</span><span class="p">))</span>
<span class="c1">;; The recycling version of BUTLAST ; may modify and return the list but has no reliable side effects.</span>
<span class="p">(</span><span class="nb">ldiff</span> <span class="nv">LIST</span> <span class="nv">OBJECT</span><span class="p">)</span>
<span class="c1">;; Returns a copy of a list up to a given cons cell.</span>
<span class="p">(</span><span class="nb">tailp</span> <span class="nv">OBJECT</span> <span class="nv">LIST</span><span class="p">)</span>
<span class="c1">;; Returns true if a given object is a cons cell that’s part of the structure of a list.</span>
<span class="p">(</span><span class="nb">list*</span> <span class="nv">ARG</span> <span class="nv">&amp;REST</span> <span class="nv">OTHERS</span><span class="p">)</span>
<span class="c1">;; Builds a list to hold all but the last of its arguments and then makes the last argument the CDR of the last cell in the list. In other words, a cross between LIST and APPEND .</span>
<span class="p">(</span><span class="nb">make-list</span> <span class="nv">SIZE</span> <span class="nv">&amp;KEY</span> <span class="nv">INITIAL-ELEMENTS</span><span class="p">)</span>
<span class="c1">;; Builds an n item list. The initial elements of the list are NIL or the value specified with the :initial-element keyword argument.</span>
<span class="p">(</span><span class="nb">revappend</span> <span class="nv">X</span> <span class="nv">Y</span><span class="p">)</span>
<span class="c1">;; Combination of REVERSE and APPEND ; reverses first argument as with REVERSE and then appends the second argument.</span>
<span class="p">(</span><span class="nb">nreconc</span> <span class="nv">X</span> <span class="nv">Y</span><span class="p">)</span>
<span class="c1">;; Recycling version of REVAPPEND ; reverses first argument as if by NREVERSE and then appends the second argument. No reliable side effects.</span>
<span class="p">(</span><span class="nb">consp</span> <span class="nv">OBJECT</span><span class="p">)</span>
<span class="c1">;; Predicate to test whether an object is a cons cell.</span>
<span class="p">(</span><span class="nb">atom</span> <span class="nv">OBJECT</span><span class="p">)</span>
<span class="c1">;; Predicate to test whether an object is not a cons cell.</span>
<span class="p">(</span><span class="nb">listp</span> <span class="nv">OBEJCT</span><span class="p">)</span>
<span class="c1">;; Predicate to test whether an object is either a cons cell or NIL .</span>
<span class="p">(</span><span class="nb">null</span> <span class="nv">OBEJCT</span><span class="p">)</span>
<span class="c1">;; Predicate to test whether an object is NIL . Functionally equivalent to NOT but stylistically preferable when testing for an empty list as opposed to boolean false.</span>

<span class="p">(</span><span class="nb">mapcar</span> <span class="nv">FUNCTION</span> <span class="nv">LIST</span> <span class="nv">&amp;REST</span> <span class="nv">MORE-LIST</span><span class="p">)</span>
<span class="c1">;; Its first argument is the function to apply, and subsequent arguments are the lists whose elements will provide the arguments to the function. the function is applied to successive elements of the list arguments, taking one element from each list per application of the function. The results of each function call are collected into a new list.</span>
<span class="p">(</span><span class="nb">maplist</span> <span class="nv">FUNCTION</span> <span class="nv">LIST</span> <span class="nv">&amp;REST</span> <span class="nv">MORE-LIST</span><span class="p">)</span>
<span class="c1">;; Except instead of passing the elements of the list to the function,it passes the actual cons cells.</span>
<span class="p">(</span><span class="nb">mapcan</span> <span class="nv">FUNCTION</span> <span class="nv">LIST</span> <span class="nv">&amp;REST</span> <span class="nv">MORE-LIST</span><span class="p">)</span>
<span class="p">(</span><span class="nb">mapcon</span> <span class="nv">FUNCTION</span> <span class="nv">LIST</span> <span class="nv">&amp;REST</span> <span class="nv">MORE-LIST</span><span class="p">)</span>
<span class="c1">;; Work like MAPCAR and MAPLIST except for the way they build up their result. While MAPCAR and MAPLIST build a completely new list to hold the results of the function calls, MAPCAN and MAPCON build their result by splicing together the results—which must be lists—as if by NCONC .</span>
<span class="p">(</span><span class="nb">mapc</span> <span class="nv">FUNCTION</span> <span class="nv">LIST</span> <span class="nv">&amp;REST</span> <span class="nv">MORE-LIST</span><span class="p">)</span>
<span class="p">(</span><span class="nb">mapl</span> <span class="nv">FUNCTION</span> <span class="nv">LIST</span> <span class="nv">&amp;REST</span> <span class="nv">MORE-LIST</span><span class="p">)</span>
<span class="c1">;; Control constructs disguised as functions—they simply return their first list argument, so they’re useful only when the side effects of the mapped function do something interesting.</span>
</code></pre></div></div>

<h4 id="useful-forms-of-recycling-functions">Useful Forms of Recycling Functions.</h4>

<p>1.PUSH &amp; NREVERSE
The most common recycling idiom is to build up a list to be returned from a function by “consing” onto the front of a list, usually by PUSH ing elements onto a list stored in a local variable and then returning the result of NREVERSE ing it.</p>

<p>This is an efficient way to build a list because each PUSH has to create only one cons cell and modify a local variable and the NREVERSE just has to zip down the list reassigning the CDR s. Because the list is created entirely within the function, there’s no danger any code outside the function has a reference to any of its cons cells. Here’s a function that uses this idiom to build a list of the first n numbers, starting at zero:</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">defun</span> <span class="nv">upto</span> <span class="p">(</span><span class="nb">max</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">result</span> <span class="no">nil</span><span class="p">))</span>
    <span class="p">(</span><span class="nb">dotimes</span> <span class="p">(</span><span class="nv">i</span> <span class="nb">max</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">push</span> <span class="nv">i</span> <span class="nv">result</span><span class="p">))</span>
    <span class="p">(</span><span class="nb">nreverse</span> <span class="nv">result</span><span class="p">)))</span>

<span class="p">(</span><span class="nv">upto</span> <span class="mi">10</span><span class="p">)</span>
<span class="c1">;; Return: (0 1 2 3 4 5 6 7 8 9)</span>
</code></pre></div></div>

<p>2.SETF &amp; DELETE
The next most common recycling idiom 9 is to immediately reassign the value returned by the recycling function back to the place containing the potentially recycled value.</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">setf</span> <span class="nv">foo</span> <span class="p">(</span><span class="nb">delete</span> <span class="no">nil</span> <span class="nv">foo</span><span class="p">))</span>
</code></pre></div></div>

<p>Sets the value of foo to its old value except with all the NIL s removed. However, even this idiom must be used with some care—if foo shares structure with lists referenced elsewhere, using DELETE instead of REMOVE can destroy the structure of those other lists.</p>
<h3 id="chapter-13">Chapter 13</h3>

<div class="message">
    Trees, Sets, Lookup Lists: alists, plists.
</div>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;;; Chapter 13 COMPLEX CONS CELLS:TREE,SETS...</span>

<span class="c1">;; Trees:</span>

<span class="p">(</span><span class="nb">copy-list</span> <span class="nv">LIST</span> <span class="p">)</span>
<span class="p">(</span><span class="nb">copy-tree</span> <span class="nv">TREE</span> <span class="nv">&amp;OPTIONAL</span> <span class="nv">VECP</span><span class="p">)</span>
<span class="c1">;; Generate a new list/tree.Note that, the two functions copy the cons cells that make up the list structure only.</span>

<span class="p">(</span><span class="nb">subst</span> <span class="nv">NEW</span> <span class="nv">OLD</span> <span class="nv">TREE</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span> <span class="p">(</span><span class="nv">TEST</span> <span class="nf">#'</span><span class="nv">EQL</span> <span class="nv">TESTP</span><span class="p">)</span> <span class="p">(</span><span class="nv">TEST-NOT</span> <span class="nf">#'</span><span class="nv">EQL</span> <span class="nv">NOTP</span><span class="p">))</span>
<span class="c1">;; Substitute all the items of a tree to a new one.</span>
<span class="p">(</span><span class="nb">subst</span> <span class="mi">8</span> <span class="mi">3</span> <span class="o">'</span><span class="p">(</span><span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">1</span> <span class="p">(</span><span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="p">(</span><span class="mi">5</span> <span class="mi">4</span><span class="p">))</span> <span class="p">(</span><span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)))</span>
<span class="c1">;; Return: (8 8 8 8 1 (2 8) (4 5 6 (5 4)) (8 2 1))</span>
<span class="p">(</span><span class="nb">substitute</span> <span class="mi">8</span> <span class="mi">3</span> <span class="o">'</span><span class="p">(</span><span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">1</span> <span class="p">(</span><span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="p">(</span><span class="mi">5</span> <span class="mi">4</span><span class="p">))</span> <span class="p">(</span><span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">))</span> <span class="ss">:from-end</span> <span class="no">t</span> <span class="ss">:count</span> <span class="mi">3</span><span class="p">)</span>
<span class="c1">;; Return: (3 8 8 8 1 (2 3) (4 5 6 (5 4)) (3 2 1)), just like processing a list.</span>

<span class="p">(</span><span class="nb">subst-if</span> <span class="nv">NEW</span> <span class="nv">TEST</span> <span class="nv">TREE</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span><span class="p">)</span>
<span class="p">(</span><span class="nb">subst-if-not</span> <span class="nv">NEW</span> <span class="nv">TEST</span> <span class="nv">TREE</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span><span class="p">)</span>
<span class="p">(</span><span class="nb">nsubst</span>  <span class="nv">NEW</span> <span class="nv">OLD</span> <span class="nv">TREE</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span> <span class="p">(</span><span class="nv">TEST</span> <span class="nf">#'</span><span class="nv">EQL</span> <span class="nv">TESTP</span><span class="p">)</span> <span class="p">(</span><span class="nv">TEST-NOT</span> <span class="nf">#'</span><span class="nv">EQL</span> <span class="nv">NOTP</span><span class="p">))</span>
<span class="p">(</span><span class="nb">nsubst-if</span>  <span class="nv">NEW</span> <span class="nv">TEST</span> <span class="nv">TREE</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span><span class="p">)</span>
<span class="p">(</span><span class="nb">nsubst-if-not</span>  <span class="nv">NEW</span> <span class="nv">TEST</span> <span class="nv">TREE</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span><span class="p">)</span>

<span class="c1">;; Sets:</span>

<span class="p">(</span><span class="nb">adjoin</span> <span class="nv">ITEM</span> <span class="nv">LIST</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span> <span class="p">(</span><span class="nv">TEST</span> <span class="nf">#'</span><span class="nv">EQL</span> <span class="nv">TESTP</span><span class="p">)</span> <span class="p">(</span><span class="nv">TEST-NOT</span> <span class="nv">NIL</span> <span class="nv">NOTP</span><span class="p">))</span>
<span class="c1">;; To build up a set, you can use the function ADJOIN . ADJOIN takes an item and a list senting a set and returns a list representing the set containing the item and all the items in the original set.</span>
<span class="p">(</span><span class="nb">defparameter</span> <span class="vg">*set*</span> <span class="p">())</span>
<span class="p">(</span><span class="nb">setf</span> <span class="vg">*set*</span> <span class="p">(</span><span class="nb">adjoin</span> <span class="mi">1</span> <span class="vg">*set*</span><span class="p">))</span>


<span class="p">(</span><span class="nb">pushnew</span> <span class="nv">OBJ</span> <span class="nv">PLACE</span> <span class="nv">&amp;REST</span> <span class="nv">KEYS</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span> <span class="nv">TEST</span> <span class="nv">TEST-NOT</span> <span class="nv">&amp;ENVIRONMENT</span> <span class="nv">ENV</span><span class="p">)</span>
<span class="c1">;; A macro to change a tree.</span>
<span class="p">(</span><span class="nb">pushnew</span> <span class="mi">2</span> <span class="vg">*set*</span><span class="p">)</span>
<span class="c1">;; Return: (2 1)</span>

<span class="p">(</span><span class="nb">member</span> <span class="nv">ITEM</span> <span class="nv">LIST</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span> <span class="p">(</span><span class="nv">TEST</span> <span class="nv">NIL</span> <span class="nv">TESTP</span><span class="p">)</span> <span class="p">(</span><span class="nv">TEST-NOT</span> <span class="nv">NIL</span> <span class="nv">NOTP</span><span class="p">))</span>
<span class="p">(</span><span class="nb">member-if</span> <span class="nv">TEST</span> <span class="nv">LIST</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span><span class="p">)</span>
<span class="p">(</span><span class="nb">member-if-not</span> <span class="nv">TEST</span> <span class="nv">LIST</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span><span class="p">)</span>
<span class="c1">;; Just like FIND, FIND-IF, FIND-IF-NOT</span>

<span class="p">(</span><span class="nb">intersection</span> <span class="nv">LIST1</span> <span class="nv">LIST2</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span> <span class="p">(</span><span class="nv">TEST</span> <span class="nf">#'</span><span class="nv">EQL</span> <span class="nv">TESTP</span><span class="p">)</span> <span class="p">(</span><span class="nv">TEST-NOT</span> <span class="nv">NIL</span> <span class="nv">NOTP</span><span class="p">))</span>
<span class="c1">;; Returns a list containing all the elements found in both arguments.</span>
<span class="p">(</span><span class="nb">union</span> <span class="nv">LIST1</span> <span class="nv">LIST2</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span> <span class="p">(</span><span class="nv">TEST</span> <span class="nf">#'</span><span class="nv">EQL</span> <span class="nv">TESTP</span><span class="p">)</span> <span class="p">(</span><span class="nv">TEST-NOT</span> <span class="nv">NIL</span> <span class="nv">NOTP</span><span class="p">))</span>
<span class="c1">;; Returns a list containing one instance of each unique element from the two arguments. 3</span>
<span class="p">(</span><span class="nb">set-difference</span> <span class="nv">LIST1</span> <span class="nv">LIST2</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span> <span class="p">(</span><span class="nv">TEST</span> <span class="nf">#'</span><span class="nv">EQL</span> <span class="nv">TESTP</span><span class="p">)</span> <span class="p">(</span><span class="nv">TEST-NOT</span> <span class="nv">NIL</span> <span class="nv">NOTP</span><span class="p">))</span>
<span class="c1">;; Returns a list containing all the elements from the first argument that don’t appear in the second argument.</span>
<span class="p">(</span><span class="nb">set-exclusive-or</span> <span class="nv">LIST1</span> <span class="nv">LIST2</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span> <span class="p">(</span><span class="nv">TEST</span> <span class="nf">#'</span><span class="nv">EQL</span> <span class="nv">TESTP</span><span class="p">)</span> <span class="p">(</span><span class="nv">TEST-NOT</span> <span class="nf">#'</span><span class="nv">EQL</span> <span class="nv">NOTP</span><span class="p">))</span>
<span class="c1">;; Returns a list containing those elements appearing in only one or the other of the two argument lists but not in both.</span>
<span class="p">(</span><span class="nb">subsetp</span> <span class="nv">LIST1</span> <span class="nv">LIST2</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span> <span class="p">(</span><span class="nv">TEST</span> <span class="nf">#'</span><span class="nv">EQL</span> <span class="nv">TESTP</span><span class="p">)</span> <span class="p">(</span><span class="nv">TEST-NOT</span> <span class="nv">NIL</span> <span class="nv">NOTP</span><span class="p">))</span>
<span class="c1">;; Takes two lists and the usual :key and :test keyword arguments and returns true if the first list is a subset of the second</span>

<span class="c1">;; Lookup Tables,Alists and Plists.</span>



<span class="p">(</span><span class="nb">assoc</span> <span class="nv">ITEM</span> <span class="nv">ALIST</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span> <span class="p">(</span><span class="nv">TEST</span> <span class="nv">NIL</span> <span class="nv">TESTP</span><span class="p">)</span> <span class="p">(</span><span class="nv">TEST-NOT</span> <span class="nv">NIL</span> <span class="nv">NOTP</span><span class="p">))</span>
<span class="c1">;; The main lookup function for alists, takes a key and an alist and returns the FIRST cons cell whose CAR matches the key or NIL if no match is found.</span>
<span class="p">(</span><span class="nb">assoc-if</span> <span class="nv">PRED</span> <span class="nv">ALIST</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span><span class="p">)</span>
<span class="p">(</span><span class="nb">assoc-if-not</span> <span class="nv">PRED</span> <span class="nv">ALIST</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span><span class="p">)</span>
<span class="p">(</span><span class="nb">rassoc</span> <span class="nv">ITEM</span> <span class="nv">ALIST</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span> <span class="p">(</span><span class="nv">TEST</span> <span class="nv">NIL</span> <span class="nv">TESTP</span><span class="p">)</span> <span class="p">(</span><span class="nv">TEST-NOT</span> <span class="nv">NIL</span> <span class="nv">NOTP</span><span class="p">))</span>
<span class="p">(</span><span class="nb">rassoc-if</span> <span class="nv">PRED</span> <span class="nv">ALIST</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span><span class="p">)</span>
<span class="p">(</span><span class="nb">rassoc-if-not</span> <span class="nv">PRED</span> <span class="nv">ALIST</span> <span class="nv">&amp;KEY</span> <span class="nv">KEY</span><span class="p">)</span>
<span class="p">(</span><span class="nb">copy-alist</span> <span class="nv">ALIST</span><span class="p">)</span>

<span class="p">(</span><span class="nb">pairlis</span>  <span class="nv">KEYS</span> <span class="nv">DATA</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">ALIST</span> <span class="ss">'NIL</span><span class="p">))</span>
<span class="c1">;; Generate a alist with two lists.</span>
<span class="p">(</span><span class="nb">pairlis</span> <span class="o">'</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span> <span class="nv">e</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1">;; Return: ((E . 5) (D . 4) (C . 3) (B . 2) (A . 1))</span>

<span class="p">(</span><span class="nb">acons</span> <span class="nv">KEY</span> <span class="nv">DATUM</span> <span class="nv">ALIST</span><span class="p">)</span>
<span class="c1">;; Add a key-value pair at the begin of a plist.</span>
<span class="c1">;; (cons (cons 'new-key 'new-value) alist) = (acons 'new-key 'new-value alist)</span>

<span class="p">(</span><span class="nb">get-properties</span> <span class="nv">PLACE</span> <span class="nv">INDICATOR-LIST</span><span class="p">)</span>
<span class="c1">;; Get key/value pairs from plist rapidly.</span>

<span class="p">(</span><span class="nb">remprop</span> <span class="nv">SYMBOL</span> <span class="nv">PROPNAME</span><span class="p">)</span>
<span class="c1">;; Remove a property in plist by symbol.</span>
<span class="c1">;; (remprop 'symbol 'key)≡(remf (symbol-plist 'symbol key))</span>

<span class="p">(</span><span class="nb">destructuring-bind</span> <span class="nv">LAMBDA-LIST</span> <span class="nv">EXPRESSION</span> <span class="nv">&amp;BODY</span> <span class="nv">BODY</span><span class="p">)</span>
<span class="p">(</span><span class="nb">destructuring-bind</span> <span class="p">(</span><span class="nv">x</span> <span class="p">(</span><span class="nv">y1</span> <span class="k">&amp;optional</span> <span class="nv">y2</span><span class="p">)</span> <span class="nv">z</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">2</span> <span class="mi">20</span><span class="p">)</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">:x</span> <span class="nv">x</span> <span class="ss">:y1</span> <span class="nv">y1</span> <span class="ss">:y2</span> <span class="nv">y2</span> <span class="ss">:z</span> <span class="nv">z</span><span class="p">))</span>
<span class="c1">;; Return: (:X 1 :Y1 2 :Y2 20 :Z 3)</span>
<span class="p">(</span><span class="nb">destructuring-bind</span> <span class="p">(</span><span class="k">&amp;whole</span> <span class="nv">whole</span> <span class="k">&amp;key</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">:z</span> <span class="mi">1</span> <span class="ss">:y</span> <span class="mi">2</span> <span class="ss">:x</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">:x</span> <span class="nv">x</span> <span class="ss">:y</span> <span class="nv">y</span> <span class="ss">:z</span> <span class="nv">z</span> <span class="ss">:whole</span> <span class="nv">whole</span><span class="p">))</span>
<span class="c1">;; Return: (:X 3 :Y 2 :Z 1 :WHOLE (:Z 1 :Y 2 :X 3))</span>
</code></pre></div></div>
<h3 id="chapter-14">Chapter 14</h3>

<div class="message">
File I/O, pathnames, interacting with file system, other kinds of I/O.
</div>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;;; Chapter 14 FILE &amp; I/O</span>

<span class="p">(</span><span class="nb">open</span> <span class="nv">FILENAME</span> <span class="nv">&amp;KEY</span> <span class="p">(</span><span class="nv">DIRECTION</span> <span class="nv">INPUT</span><span class="p">)</span> <span class="p">(</span><span class="nv">ELEMENT-TYPE</span> <span class="ss">'BASE-CHAR</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">IF-EXISTS</span> <span class="nv">NIL</span> <span class="nv">IF-EXISTS-GIVEN</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">IF-DOES-NOT-EXIST</span> <span class="nv">NIL</span> <span class="nv">IF-DOES-NOT-EXIST-GIVEN</span><span class="p">)</span> <span class="p">(</span><span class="nv">EXTERNAL-FORMAT</span> <span class="nv">DEFAULT</span><span class="p">)</span> <span class="nv">&amp;AUX</span>
      <span class="p">(</span><span class="nv">DIRECTION</span> <span class="nv">DIRECTION</span><span class="p">)</span> <span class="p">(</span><span class="nv">IF-DOES-NOT-EXIST</span> <span class="nv">IF-DOES-NOT-EXIST</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">IF-EXISTS</span> <span class="nv">IF-EXISTS</span><span class="p">))</span>
<span class="c1">;; Produce a stream from which you can read a file’s contents with the OPEN function.</span>
<span class="c1">;; To read the raw bytes, you need to pass OPEN an :element-type argument of '(unsigned-byte 8). 3 You can pass the resulting stream to the function READ-BYTE , which will return an integer between 0 and 255 each time it’s called.</span>
<span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">in</span> <span class="p">(</span><span class="nb">open</span> <span class="s">"/some/file/name.txt"</span><span class="p">)))</span>
  <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"~a~%"</span> <span class="p">(</span><span class="nb">read-line</span> <span class="nv">in</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">close</span> <span class="nv">in</span><span class="p">))</span>

<span class="p">(</span><span class="nb">read-line</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">STREAM</span> <span class="vg">*STANDARD-INPUT*</span><span class="p">)</span> <span class="p">(</span><span class="nv">EOF-ERROR-P</span> <span class="nv">T</span><span class="p">)</span> <span class="nv">EOF-VALUE</span> <span class="nv">RECURSIVE-P</span><span class="p">)</span>
<span class="p">(</span><span class="nb">read-char</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">STREAM</span> <span class="vg">*STANDARD-INPUT*</span><span class="p">)</span> <span class="p">(</span><span class="nv">EOF-ERROR-P</span> <span class="nv">T</span><span class="p">)</span> <span class="nv">EOF-VALUE</span> <span class="nv">RECURSIVE-P</span><span class="p">)</span>
<span class="p">(</span><span class="nb">read</span>  <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">STREAM</span> <span class="vg">*STANDARD-INPUT*</span><span class="p">)</span> <span class="p">(</span><span class="nv">EOF-ERROR-P</span> <span class="nv">T</span><span class="p">)</span> <span class="p">(</span><span class="nv">EOF-VALUE</span> <span class="nv">NIL</span><span class="p">)</span> <span class="p">(</span><span class="nv">RECURSIVE-P</span> <span class="nv">NIL</span><span class="p">))</span>
<span class="c1">;; Read a s-expressions from a stream.</span>
<span class="p">(</span><span class="nb">read-byte</span> <span class="nv">STREAM</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">EOF-ERROR-P</span> <span class="nv">T</span><span class="p">)</span> <span class="nv">EOF-VALUE</span><span class="p">)</span>
<span class="p">(</span><span class="nb">write-char</span> <span class="nv">CHARACTER</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">STREAM</span> <span class="vg">*STANDARD-OUTPUT*</span><span class="p">))</span>
<span class="p">(</span><span class="nb">write-line</span> <span class="nv">STRING</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">STREAM</span> <span class="vg">*STANDARD-OUTPUT*</span><span class="p">)</span> <span class="nv">&amp;KEY</span> <span class="p">(</span><span class="nv">START</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">END</span><span class="p">)</span>
<span class="p">(</span><span class="nb">write-string</span>  <span class="nv">STRING</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">STREAM</span> <span class="vg">*STANDARD-OUTPUT*</span><span class="p">)</span> <span class="nv">&amp;KEY</span> <span class="p">(</span><span class="nv">START</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">END</span><span class="p">)</span>
<span class="p">(</span><span class="nb">terpri</span>  <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">STREAM</span> <span class="vg">*STANDARD-OUTPUT*</span><span class="p">))</span>
<span class="c1">;; Short for “terminate print”—unconditionally a newline character.</span>
<span class="p">(</span><span class="nb">fresh-line</span>  <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">STREAM</span> <span class="vg">*STANDARD-OUTPUT*</span><span class="p">))</span>
<span class="c1">;; Prints a newline character unless the stream is at the beginning of a line.</span>
<span class="c1">;; Output S-EXPRESSIONS:</span>
<span class="p">(</span><span class="nb">print</span> <span class="nv">OBJECT</span> <span class="nv">&amp;OPTIONAL</span> <span class="nv">STREAM</span><span class="p">)</span>
<span class="c1">;; Prints an s-expression preceded by an end-of-line and followed by a space.</span>
<span class="p">(</span><span class="nb">prin1</span> <span class="nv">OBJECT</span> <span class="nv">&amp;OPTIONAL</span> <span class="nv">STREAM</span><span class="p">)</span>
<span class="c1">;; Prints just the s-expression.</span>
<span class="p">(</span><span class="nb">pprint</span> <span class="nv">OBJECT</span> <span class="nv">&amp;OPTIONAL</span> <span class="nv">STREAM</span><span class="p">)</span>
<span class="c1">;; Prints s-expressions like PRINT and PRIN1 but using the “pretty printer,” which tries to print its output in an aesthetically pleasing way.</span>
<span class="p">(</span><span class="nb">princ</span> <span class="nv">OBJECT</span> <span class="nv">&amp;OPTIONAL</span> <span class="nv">STREAM</span><span class="p">)</span>
<span class="c1">;; Prints Lisp objects, but in a way designed for human consumption. For instance, PRINC prints strings without quotation marks.</span>
<span class="p">(</span><span class="nb">write-sequence</span> <span class="nv">SEQ</span> <span class="nv">STREAM</span> <span class="nv">&amp;KEY</span> <span class="p">(</span><span class="nv">STRAT</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">END</span> <span class="nv">NIL</span><span class="p">))</span>
<span class="c1">;; Accepts both binary and character streams as long as all the elements of the sequence are of an appropriate type for the stream, either characters or bytes.</span>
<span class="p">(</span><span class="nb">read-sequence</span> <span class="nv">SEQ</span> <span class="nv">STREAM</span> <span class="nv">&amp;KEY</span> <span class="p">(</span><span class="nv">START</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">END</span><span class="p">)</span>
<span class="p">(</span><span class="nb">close</span> <span class="nv">STREAM</span> <span class="nv">&amp;KEY</span> <span class="nv">ABORT</span><span class="p">)</span>
<span class="c1">;; Close a file stream after reading it, function.</span>

<span class="p">(</span><span class="nb">with-open-file</span> <span class="p">(</span><span class="nv">STREAM</span> <span class="nv">FILESPEC</span> <span class="nv">&amp;REST</span> <span class="nv">OPTIONS</span><span class="p">)</span> <span class="nv">&amp;BODY</span> <span class="nv">BODY</span><span class="p">)</span>
<span class="p">(</span><span class="nb">with-open-file</span> <span class="p">(</span><span class="nc">stream</span> <span class="s">"/path/to/file"</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"~a~%"</span> <span class="p">(</span><span class="nb">read-line</span> <span class="nc">stream</span><span class="p">)))</span>
<span class="c1">;; Read a line from the file.</span>
<span class="p">(</span><span class="nb">with-open-file</span> <span class="p">(</span><span class="nc">stream</span> <span class="s">"/path/to/file"</span> <span class="ss">:direction</span> <span class="ss">:output</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">format</span> <span class="nc">stream</span> <span class="s">"Some text"</span><span class="p">))</span>
<span class="c1">;; Write something to a file.</span>

<span class="p">(</span><span class="nb">pathname</span> <span class="nv">PATHSPEC</span><span class="p">)</span>
<span class="c1">;; Takes a pathname designator and returns an equivalent pathname object. When the designator is already a pathname, it’s simply returned.</span>
<span class="p">(</span><span class="nb">pathname</span> <span class="s">"/path/to/file"</span><span class="p">)</span>
<span class="c1">;; Return: #P"/path/to/file", #P indicates that is a pathname object.</span>

<span class="p">(</span><span class="nb">pathname-directory</span> <span class="nv">PATHNAME</span> <span class="nv">&amp;KEY</span> <span class="p">(</span><span class="nv">CASE</span> <span class="nv">LOCAL</span><span class="p">))</span>
<span class="p">(</span><span class="nb">pathname-directory</span> <span class="s">"/path/to/file"</span><span class="p">)</span>
<span class="c1">;; Return: (:ABSOLUTE "path" "to")</span>
<span class="p">(</span><span class="nb">pathname-directory</span> <span class="s">"path/to/file"</span><span class="p">)</span>
<span class="c1">;; Return: (:RELATIVE "path" "to")</span>
<span class="p">(</span><span class="nb">pathname-name</span> <span class="nv">PATHNAME</span> <span class="nv">&amp;KEY</span> <span class="p">(</span><span class="nv">CASE</span> <span class="nv">LOCAL</span><span class="p">))</span>
<span class="p">(</span><span class="nb">pathname-type</span> <span class="nv">PATHNAME</span> <span class="nv">&amp;KEY</span> <span class="p">(</span><span class="nv">CASE</span> <span class="nv">LOCAL</span><span class="p">))</span>
<span class="p">(</span><span class="nb">pathname-host</span> <span class="nv">PATHNAME</span> <span class="nv">&amp;KEY</span> <span class="p">(</span><span class="nv">CASE</span> <span class="nv">LOCAL</span><span class="p">))</span>
<span class="p">(</span><span class="nb">pathname-device</span> <span class="nv">PATHNAME</span> <span class="nv">&amp;KEY</span> <span class="p">(</span><span class="nv">CASE</span> <span class="nv">LOCAL</span><span class="p">))</span>
<span class="c1">;; On Windows either PATHNAME-HOST or PATHNAME-DEVICE will return the drive letter.</span>
<span class="p">(</span><span class="nb">pathname-version</span> <span class="nv">PATHNAME</span><span class="p">)</span>

<span class="p">(</span><span class="nb">namestring</span> <span class="nv">PATHNAME</span><span class="p">)</span>
<span class="c1">;; The inverse function of PATHNAME, and it has a funcion family like PATHNAME outlined below:</span>
<span class="p">(</span><span class="nb">directory-namestring</span> <span class="nv">PATHNAME</span><span class="p">)</span>
<span class="p">(</span><span class="nb">file-namestring</span> <span class="nv">PATHNAME</span><span class="p">)</span>

<span class="p">(</span><span class="nb">make-pathname</span> <span class="nv">&amp;KEY</span> <span class="nv">HOST</span> <span class="p">(</span><span class="nv">DEVICE</span> <span class="nv">NIL</span> <span class="nv">DEVP</span><span class="p">)</span> <span class="p">(</span><span class="nv">DIRECTORY</span> <span class="nv">NIL</span> <span class="nv">DIRP</span><span class="p">)</span>
               <span class="p">(</span><span class="nv">NAME</span> <span class="nv">NIL</span> <span class="nv">NAMEP</span><span class="p">)</span> <span class="p">(</span><span class="nv">TYPE</span> <span class="nv">NIL</span> <span class="nv">TYPEP</span><span class="p">)</span> <span class="p">(</span><span class="nv">VERSION</span> <span class="nv">NIL</span> <span class="nv">VERSIONP</span><span class="p">)</span> <span class="nv">DEFAULTS</span> <span class="p">(</span><span class="nv">CASE</span> <span class="nv">LOCAL</span><span class="p">))</span>
<span class="c1">;; Construct arbitrary pathnames</span>
<span class="p">(</span><span class="nb">make-pathname</span> <span class="ss">:device</span> <span class="s">"c"</span> <span class="ss">:directory</span> <span class="o">'</span><span class="p">(</span><span class="ss">:absolute</span> <span class="s">"foo"</span> <span class="s">"bar"</span><span class="p">)</span> <span class="ss">:name</span> <span class="s">"baz"</span><span class="p">)</span>
<span class="c1">;; Return in Linux amd64: #P"/foo/bar/baz"</span>

<span class="p">(</span><span class="nb">merge-pathnames</span> <span class="nv">PATHNAME</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">DEFAULTS</span> <span class="vg">*DEFAULT-PATHNAME-DEFAULTS*</span><span class="p">)</span> <span class="p">(</span><span class="nv">DEFAULT-VERSION</span> <span class="nv">NEWEST</span><span class="p">))</span>
<span class="c1">;; Takes two pathnames and merges them, filling in any NIL components in the first pathname with the corresponding value from the second pathname</span>
<span class="p">(</span><span class="nb">enough-namestring</span> <span class="nv">PATHNAME</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">DEFAULTS</span> <span class="vg">*DEFAULT-PATHNAME-DEFAULTS*</span><span class="p">))</span>
<span class="c1">;; The inverse function of MERGE-PATHNAMES</span>
<span class="p">(</span><span class="nb">merge-pathnames</span> <span class="ss">#p"foo/bar.html"</span> <span class="ss">#p"/www/html/"</span><span class="p">)</span>
<span class="c1">;; Return: #p"/www/html/foo/bar.html"</span>
<span class="p">(</span><span class="nv">enough-pathnames</span> <span class="ss">#p"/www/html/foo/bar.html"</span> <span class="ss">#p"/www/html"</span><span class="p">)</span>
<span class="c1">;; Return: #p"foo/bar.html"</span>

<span class="c1">;; Interacting with File System</span>
<span class="p">(</span><span class="nb">probe-file</span> <span class="nv">PATHSPEC</span><span class="p">)</span>
<span class="c1">;; Test whether a file exists in the file system corresponding to a pathname designator, a pathname, namestring, or file stream, function.</span>
<span class="p">(</span><span class="nb">directory</span> <span class="nv">PATHSPEC</span> <span class="nv">&amp;KEY</span> <span class="p">(</span><span class="nv">RESOLVE-SYMLINKS</span> <span class="nv">T</span><span class="p">))</span>
<span class="c1">;; List all the files and directories in the path represented by designator PATHSPEC.</span>
<span class="p">(</span><span class="nb">delete-file</span> <span class="nv">FILE</span><span class="p">)</span>
<span class="p">(</span><span class="nb">rename-file</span> <span class="nv">FILE</span> <span class="nv">NEW-NAME</span><span class="p">)</span>
<span class="p">(</span><span class="nb">ensure-directories-exist</span> <span class="nv">PATHSPEC</span> <span class="nv">&amp;KEY</span> <span class="nv">VERBOSE</span> <span class="p">(</span><span class="nv">MODE</span> <span class="mi">511</span><span class="p">))</span>
<span class="p">(</span><span class="nb">with-open-file</span> <span class="p">(</span><span class="nv">out</span> <span class="p">(</span><span class="nb">ensure-directories-exist</span> <span class="nv">name</span><span class="p">)</span> <span class="ss">:direction</span> <span class="ss">:output</span><span class="p">)</span>
  <span class="o">...</span>
  <span class="p">)</span>
<span class="p">(</span><span class="nb">file-write-date</span> <span class="nv">PATHSPEC</span><span class="p">)</span>
<span class="p">(</span><span class="nb">file-author</span> <span class="nv">PATHSPEC</span><span class="p">)</span>
<span class="p">(</span><span class="nb">file-length</span> <span class="nv">PATHSPEC</span><span class="p">)</span>
<span class="p">(</span><span class="nb">file-position</span> <span class="nv">STREAM</span> <span class="nv">&amp;OPTIONAL</span> <span class="nv">POSITION</span><span class="p">)</span>

<span class="c1">;; Work with STRING-STREAM</span>
<span class="p">(</span><span class="nc">string-stream</span><span class="p">)</span>
<span class="p">(</span><span class="nb">make-string-input-stream</span> <span class="nv">STRING</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">START</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">END</span><span class="p">)</span>
<span class="p">(</span><span class="nb">make-string-output-stream</span> <span class="nv">&amp;KEY</span> <span class="p">(</span><span class="nv">ELEMENT-TYPE</span> <span class="ss">'CHARACTER</span><span class="p">)</span> <span class="nv">&amp;AUX</span> <span class="p">(</span><span class="nv">BUFFER</span> <span class="p">(</span><span class="nv">MAKE-STRING</span> <span class="vg">*STRING-OUTPUT-STREAM-BUFFER-INITIAL-SIZE*</span><span class="p">)))</span>
<span class="p">(</span><span class="nb">get-output-stream-string</span> <span class="nv">STREAM</span><span class="p">)</span>
<span class="p">(</span><span class="nb">with-input-from-string</span>  <span class="p">(</span><span class="nv">VAR</span> <span class="nv">STRING</span> <span class="nv">&amp;KEY</span> <span class="nv">INDEX</span> <span class="nv">START</span> <span class="nv">END</span><span class="p">)</span> <span class="nv">&amp;BODY</span> <span class="nv">FORMS-DECLS</span><span class="p">)</span>
<span class="p">(</span><span class="nv">with-output-from-string</span> <span class="p">(</span><span class="nv">stream-symbol</span><span class="p">)</span> <span class="nv">&amp;BODY</span><span class="p">)</span>
<span class="p">(</span><span class="nc">broadcast-stream</span><span class="p">)</span>
<span class="p">(</span><span class="nb">make-broadcast-stream</span> <span class="nv">&amp;REST-STREAMS</span><span class="p">)</span>
<span class="p">(</span><span class="nv">concatented-stream</span><span class="p">)</span>
<span class="p">(</span><span class="nc">two-way-stream</span><span class="p">)</span>
<span class="p">(</span><span class="nc">echo-stream</span><span class="p">)</span>
<span class="p">(</span><span class="nb">make-two-way-stream</span> <span class="nv">INPUT-STREAM</span> <span class="nv">OUTPUT-STREAM</span><span class="p">)</span>
<span class="p">(</span><span class="nb">make-echo-stream</span> <span class="nv">INPUT-STREAM</span> <span class="nv">OUTPUT-STREAM</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="use-with-open-file-">Use WITH-OPEN-FILE !</h4>
<p>You’ll probably use WITH-OPEN-FILE for 90–99 percent of the file I/O you do—the only time you need to use raw OPEN and CLOSE calls is if you need to open a file in a function and keep the stream around after the function returns. In that case, you must take care to eventually close the stream yourself, or you’ll leak file descriptors and may eventually end up unable to open any more files.</p>

<h4 id="other-kinds-of-io">Other Kinds of I/O</h4>
<p>In addition to file streams, Common Lisp supports other kinds of streams, which can also be used with the various reading, writing, and printing I/O functions. For instance, you can read data from, or write data to, a string using STRING-STREAM s, which you can create with the functions MAKE-STRING-INPUT-STREAM and MAKE-STRING-OUTPUT-STREAM .</p>

<p>MAKE-STRING-INPUT-STREAM takes a string and optional start and end indices to bound the area of the string from which data should be read and returns a character stream that you can pass to any of the character-based input functions such as READ-CHAR , READ-LINE , or READ . For example, if you have a string containing a floating-point literal in Common Lisp’s syntax, you can convert it to a float like this:</p>
<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">s</span> <span class="p">(</span><span class="nb">make-string-input-stream</span> <span class="s">"1.23"</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">unwind-protect</span> <span class="p">(</span><span class="nb">read</span> <span class="nv">s</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">close</span> <span class="nv">s</span><span class="p">)))</span>
</code></pre></div></div>

<p>Similarly, MAKE-STRING-OUTPUT-STREAM creates a stream you can use with FORMAT ,
PRINT , WRITE-CHAR , WRITE-LINE , and so on. It takes no arguments. Whatever you write, a
string output stream will be accumulated into a string that can then be obtained with the function
GET-OUTPUT-STREAM-STRING . Each time you call GET-OUTPUT-STREAM-STRING , the stream’s
internal string is cleared so you can reuse an existing string output stream.</p>

<p>However, you’ll rarely use these functions directly, because the macros
WITH-INPUT-FROM-STRING and WITH-OUTPUT-TO-STRING provide a more convenient
interface. WITH-INPUT-FROM-STRING is similar to WITH-OPEN-FILE —it creates a string input
stream from a given string and then executes the forms in its body with the stream bound to the
variable you provide. For instance, instead of the LET form with the explicit UNWIND-PROTECT ,
you’d probably write this:</p>
<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">with-input-from-string</span> <span class="p">(</span><span class="nv">s</span> <span class="s">"1.23"</span><span class="p">)</span>
<span class="p">(</span><span class="nb">read</span> <span class="nv">s</span><span class="p">))</span>
</code></pre></div></div>
<p>The WITH-OUTPUT-TO-STRING macro is similar: it binds a newly created string output
stream to a variable you name and then executes its body. After all the body forms have been
executed, WITH-OUTPUT-TO-STRING returns the value that would be returned by
GET-OUTPUT-STREAM-STRING .</p>
<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">with-output-to-string</span> <span class="p">(</span><span class="nv">out</span><span class="p">)</span>
<span class="p">(</span><span class="nb">format</span> <span class="nv">out</span> <span class="s">"hello, world "</span><span class="p">)</span>
<span class="p">(</span><span class="nb">format</span> <span class="nv">out</span> <span class="s">"~s"</span> <span class="p">(</span><span class="nb">list</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)))</span>
<span class="s">"hello, world (1 2 3)"</span>
</code></pre></div></div>
<p>The other kinds of streams defined in the language standard provide various kinds of
stream “plumbing,” allowing you to plug together streams in almost any configuration. A
BROADCAST-STREAM is an output stream that sends any data written to it to a set of output
streams provided as arguments to its constructor function, MAKE-BROADCAST-STREAM . 14
Conversely, a CONCATENATED-STREAM is an input stream that takes its input from a set of input
streams, moving from stream to stream as it hits the end of each stream.
CONCATENATED-STREAM s are constructed with the function MAKE-CONCATENATED-STREAM ,
which takes any number of input streams as arguments.</p>

<p>Two kinds of bidirectional streams that can plug together streams in a couple ways are
TWO-WAY-STREAM and ECHO-STREAM . Their constructor functions, MAKE-TWO-WAY-STREAM and
MAKE-ECHO-STREAM , both take two arguments, an input stream and an output stream, and
return a stream of the appropriate type, which you can use with both input and output functions.</p>

<p>In a TWO-WAY-STREAM every read you perform will return data read from the underlying
input stream, and every write will send data to the underlying output stream. An ECHO-STREAM
works essentially the same way except that all the data read from the underlying input stream
is also echoed to the output stream. Thus, the output stream of an ECHO-STREAM stream will
contain a transcript of both sides of the conversation.</p>

<p>Using these five kinds of streams, you can build almost any topology of stream plumbing
you want.</p>

<p>Finally, although the Common Lisp standard doesn’t say anything about networking APIs,
most implementations support socket programming and typically implement sockets as
another kind of stream, so you can use all the regular I/O functions with them.</p>

<p>Now you’re ready to move on to building a library that smoothes over some of the differences
between how the basic pathname functions behave in different Common Lisp implementations.</p>
<h3 id="chapter-15">Chapter 15</h3>

<div class="message">
    A portable pathname library.
</div>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;;; Chapter 15</span>

<span class="p">(</span><span class="nb">wild-pathname-p</span> <span class="nv">PATHNAME</span> <span class="nv">&amp;OPTIONAL</span> <span class="nv">FIELD-KEY</span><span class="p">)</span>
<span class="c1">;; Test whether the passing PATHNAME have wild keywords, that is.</span>

<span class="p">(</span><span class="nb">butlast</span> <span class="nv">LIST</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">N</span> <span class="mi">1</span><span class="p">))</span>
<span class="p">(</span><span class="nb">nbutlast</span> <span class="nv">LIST</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">N</span> <span class="mi">1</span><span class="p">))</span>
<span class="c1">;; Returns a copy of list from which the last n conses have been omitted. If n is not supplied, its value is 1. If there are fewer than n conses in list, nil is returned and, in the case of nbutlast, list is not modified.</span>

<span class="p">(</span><span class="nb">constantly</span> <span class="nv">VALUE</span><span class="p">)</span>
<span class="c1">;; Returns a function that accepts any number of arguments, that has no side-effects, and that always returns value.</span>
<span class="p">(</span><span class="nb">mapcar</span> <span class="p">(</span><span class="nb">constantly</span> <span class="mi">3</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">))</span>
<span class="c1">;; Return: (3 3 3 3)</span>
</code></pre></div></div>

<h1 id="features-and-read-time-conditionalization">*FEATURES* and Read-Time Conditionalization</h1>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">defun</span> <span class="nv">foo</span> <span class="p">()</span>
  <span class="o">#+</span><span class="nv">allegro</span> <span class="p">(</span><span class="nv">do-one-thing</span><span class="p">)</span>
  <span class="o">#+</span><span class="nv">sbcl</span> <span class="p">(</span><span class="nv">do-another-thing</span><span class="p">)</span>
  <span class="o">#+</span><span class="nv">clisp</span> <span class="p">(</span><span class="nv">something-else</span><span class="p">)</span>
  <span class="o">#+</span><span class="nv">cmu</span> <span class="p">(</span><span class="nv">yet-another-version</span><span class="p">)</span>
  <span class="o">#-</span><span class="p">(</span><span class="nb">or</span> <span class="nv">allegro</span> <span class="nv">sbcl</span> <span class="nv">clisp</span> <span class="nv">cmu</span><span class="p">)</span> <span class="p">(</span><span class="nb">error</span> <span class="s">"Not implemented"</span><span class="p">))</span>
</code></pre></div></div>

<p>… and the information is kept in *FEATURES*. *FEATURES* and #+ #- were understood by Lisp Reader.</p>

<h1 id="source-code">Source Code</h1>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">in-package</span> <span class="ss">#:com.gigamonkeys.pathnames</span><span class="p">)</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">list-directory</span> <span class="p">(</span><span class="nv">dirname</span><span class="p">)</span>
  <span class="s">"Return a list of the contents of the directory named by dirname.
Names of subdirectories will be returned in `directory normal
form'. Unlike CL:DIRECTORY, LIST-DIRECTORY does not accept
wildcard pathnames; `dirname' should simply be a pathname that
names a directory. It can be in either file or directory form."</span>
  <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">wild-pathname-p</span> <span class="nv">dirname</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">error</span> <span class="s">"Can only list concrete directory names."</span><span class="p">))</span>

  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">wildcard</span> <span class="p">(</span><span class="nv">directory-wildcard</span> <span class="nv">dirname</span><span class="p">)))</span>

    <span class="o">#+</span><span class="p">(</span><span class="nb">or</span> <span class="nv">sbcl</span> <span class="nv">cmu</span> <span class="nv">lispworks</span><span class="p">)</span>
    <span class="c1">;; SBCL, CMUCL, and Lispworks return subdirectories in directory</span>
    <span class="c1">;; form just the way we want.</span>
    <span class="p">(</span><span class="nb">directory</span> <span class="nv">wildcard</span><span class="p">)</span>

    <span class="o">#+</span><span class="nv">openmcl</span>
    <span class="c1">;; OpenMCl by default doesn't return subdirectories at all. But</span>
    <span class="c1">;; when prodded to do so with the special argument :directories,</span>
    <span class="c1">;; it returns them in directory form.</span>
    <span class="p">(</span><span class="nb">directory</span> <span class="nv">wildcard</span> <span class="ss">:directories</span> <span class="no">t</span><span class="p">)</span>

    <span class="o">#+</span><span class="nv">allegro</span>
    <span class="c1">;; Allegro normally return directories in file form but we can</span>
    <span class="c1">;; change that with the :directories-are-files argument.</span>
    <span class="p">(</span><span class="nb">directory</span> <span class="nv">wildcard</span> <span class="ss">:directories-are-files</span> <span class="no">nil</span><span class="p">)</span>

    <span class="o">#+</span><span class="nv">clisp</span>
    <span class="c1">;; CLISP has a particularly idiosyncratic view of things. But we</span>
    <span class="c1">;; can bludgeon even it into doing what we want.</span>
    <span class="p">(</span><span class="nb">nconc</span>
     <span class="c1">;; CLISP won't list files without an extension when :type is</span>
     <span class="c1">;; wild so we make a special wildcard for it.</span>
     <span class="p">(</span><span class="nb">directory</span> <span class="nv">wildcard</span><span class="p">)</span>
     <span class="c1">;; And CLISP doesn't consider subdirectories to match unless</span>
     <span class="c1">;; there is a :wild in the directory component.</span>
     <span class="p">(</span><span class="nb">directory</span> <span class="p">(</span><span class="nv">clisp-subdirectories-wildcard</span> <span class="nv">wildcard</span><span class="p">)))</span>

    <span class="o">#-</span><span class="p">(</span><span class="nb">or</span> <span class="nv">sbcl</span> <span class="nv">cmu</span> <span class="nv">lispworks</span> <span class="nv">openmcl</span> <span class="nv">allegro</span> <span class="nv">clisp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">error</span> <span class="s">"list-directory not implemented"</span><span class="p">)))</span>




<span class="p">(</span><span class="nb">defun</span> <span class="nv">file-exists-p</span> <span class="p">(</span><span class="nb">pathname</span><span class="p">)</span>
  <span class="s">"Similar to CL:PROBE-FILE except it always returns directory names
in `directory normal form'. Returns truename which will be in
`directory form' if file named is, in fact, a directory."</span>

  <span class="o">#+</span><span class="p">(</span><span class="nb">or</span> <span class="nv">sbcl</span> <span class="nv">lispworks</span> <span class="nv">openmcl</span><span class="p">)</span>
  <span class="c1">;; These implementations do "The Right Thing" as far as we are</span>
  <span class="c1">;; concerned. They return a truename of the file or directory if it</span>
  <span class="c1">;; exists and the truename of a directory is in directory normal</span>
  <span class="c1">;; form.</span>
  <span class="p">(</span><span class="nb">probe-file</span> <span class="nb">pathname</span><span class="p">)</span>

  <span class="o">#+</span><span class="p">(</span><span class="nb">or</span> <span class="nv">allegro</span> <span class="nv">cmu</span><span class="p">)</span>
  <span class="c1">;; These implementations accept the name of a directory in either</span>
  <span class="c1">;; form and return the name in the form given. However the name of a</span>
  <span class="c1">;; file must be given in file form. So we try first with a directory</span>
  <span class="c1">;; name which will return NIL if either the file doesn't exist at</span>
  <span class="c1">;; all or exists and is not a directory. Then we try with a file</span>
  <span class="c1">;; form name.</span>
  <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nb">probe-file</span> <span class="p">(</span><span class="nv">pathname-as-directory</span> <span class="nb">pathname</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">probe-file</span> <span class="nb">pathname</span><span class="p">))</span>

  <span class="o">#+</span><span class="nv">clisp</span>
  <span class="c1">;; Once again CLISP takes a particularly unforgiving approach,</span>
  <span class="c1">;; signalling ERRORs at the slightest provocation.</span>

  <span class="c1">;; pathname in file form and actually a file      -- (probe-file file)      ==&gt; truename</span>
  <span class="c1">;; pathname in file form and doesn't exist        -- (probe-file file)      ==&gt; NIL</span>
  <span class="c1">;; pathname in dir form and actually a directory  -- (probe-directory file) ==&gt; truename</span>
  <span class="c1">;; pathname in dir form and doesn't exist         -- (probe-directory file) ==&gt; NIL</span>

  <span class="c1">;; pathname in file form and actually a directory -- (probe-file file)      ==&gt; ERROR</span>
  <span class="c1">;; pathname in dir form and actually a file       -- (probe-directory file) ==&gt; ERROR</span>
  <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nb">ignore-errors</span>
        <span class="c1">;; PROBE-FILE will return the truename if file exists and is a</span>
        <span class="c1">;; file or NIL if it doesn't exist at all. If it exists but is</span>
        <span class="c1">;; a directory PROBE-FILE will signal an error which we</span>
        <span class="c1">;; ignore.</span>
        <span class="p">(</span><span class="nb">probe-file</span> <span class="p">(</span><span class="nv">pathname-as-file</span> <span class="nb">pathname</span><span class="p">)))</span>
      <span class="p">(</span><span class="nb">ignore-errors</span>
        <span class="c1">;; PROBE-DIRECTORY returns T if the file exists and is a</span>
        <span class="c1">;; directory or NIL if it doesn't exist at all. If it exists</span>
        <span class="c1">;; but is a file, PROBE-DIRECTORY will signal an error.</span>
        <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">directory-form</span> <span class="p">(</span><span class="nv">pathname-as-directory</span> <span class="nb">pathname</span><span class="p">)))</span>
          <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">ext:probe-directory</span> <span class="nv">directory-form</span><span class="p">)</span>
            <span class="nv">directory-form</span><span class="p">))))</span>


    <span class="o">#-</span><span class="p">(</span><span class="nb">or</span> <span class="nv">sbcl</span> <span class="nv">cmu</span> <span class="nv">lispworks</span> <span class="nv">openmcl</span> <span class="nv">allegro</span> <span class="nv">clisp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">error</span> <span class="s">"list-directory not implemented"</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">directory-wildcard</span> <span class="p">(</span><span class="nv">dirname</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">make-pathname</span>
   <span class="ss">:name</span> <span class="ss">:wild</span>
   <span class="ss">:type</span> <span class="o">#-</span><span class="nv">clisp</span> <span class="ss">:wild</span> <span class="o">#+</span><span class="nv">clisp</span> <span class="no">nil</span>
   <span class="ss">:defaults</span> <span class="p">(</span><span class="nv">pathname-as-directory</span> <span class="nv">dirname</span><span class="p">)))</span>

<span class="o">#+</span><span class="nv">clisp</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">clisp-subdirectories-wildcard</span> <span class="p">(</span><span class="nv">wildcard</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">make-pathname</span>
   <span class="ss">:directory</span> <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nb">pathname-directory</span> <span class="nv">wildcard</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">:wild</span><span class="p">))</span>
   <span class="ss">:name</span> <span class="no">nil</span>
   <span class="ss">:type</span> <span class="no">nil</span>
   <span class="ss">:defaults</span> <span class="nv">wildcard</span><span class="p">))</span>


<span class="p">(</span><span class="nb">defun</span> <span class="nv">directory-pathname-p</span> <span class="p">(</span><span class="nv">p</span><span class="p">)</span>
  <span class="s">"Is the given pathname the name of a directory? This function can
usefully be used to test whether a name returned by LIST-DIRECTORIES
or passed to the function in WALK-DIRECTORY is the name of a directory
in the file system since they always return names in `directory normal
form'."</span>
  <span class="p">(</span><span class="k">flet</span> <span class="p">((</span><span class="nv">component-present-p</span> <span class="p">(</span><span class="nv">value</span><span class="p">)</span>
           <span class="p">(</span><span class="nb">and</span> <span class="nv">value</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">eql</span> <span class="nv">value</span> <span class="ss">:unspecific</span><span class="p">)))))</span>
    <span class="p">(</span><span class="nb">and</span>
     <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nv">component-present-p</span> <span class="p">(</span><span class="nb">pathname-name</span> <span class="nv">p</span><span class="p">)))</span>
     <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nv">component-present-p</span> <span class="p">(</span><span class="nb">pathname-type</span> <span class="nv">p</span><span class="p">)))</span>
     <span class="nv">p</span><span class="p">)))</span>


<span class="p">(</span><span class="nb">defun</span> <span class="nv">file-pathname-p</span> <span class="p">(</span><span class="nv">p</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">directory-pathname-p</span> <span class="nv">p</span><span class="p">)</span> <span class="nv">p</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">pathname-as-directory</span> <span class="p">(</span><span class="nv">name</span><span class="p">)</span>
  <span class="s">"Return a pathname reperesenting the given pathname in
`directory normal form', i.e. with all the name elements in the
directory component and NIL in the name and type components. Can
not be used on wild pathnames because there's not portable way to
convert wildcards in the name and type into a single directory
component. Returns its argument if name and type are both nil or
:unspecific."</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nb">pathname</span> <span class="p">(</span><span class="nb">pathname</span> <span class="nv">name</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">wild-pathname-p</span> <span class="nb">pathname</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">error</span> <span class="s">"Can't reliably convert wild pathnames."</span><span class="p">))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nv">directory-pathname-p</span> <span class="nv">name</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">make-pathname</span>
       <span class="ss">:directory</span> <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nb">pathname-directory</span> <span class="nb">pathname</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">:relative</span><span class="p">))</span>
                          <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">file-namestring</span> <span class="nb">pathname</span><span class="p">)))</span>
       <span class="ss">:name</span>      <span class="no">nil</span>
       <span class="ss">:type</span>      <span class="no">nil</span>
       <span class="ss">:defaults</span> <span class="nb">pathname</span><span class="p">)</span>
      <span class="nb">pathname</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">pathname-as-file</span> <span class="p">(</span><span class="nv">name</span><span class="p">)</span>
  <span class="s">"Return a pathname reperesenting the given pathname in `file form',
i.e. with the name elements in the name and type component. Can't
convert wild pathnames because of problems mapping wild directory
component into name and type components. Returns its argument if
it is already in file form."</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nb">pathname</span> <span class="p">(</span><span class="nb">pathname</span> <span class="nv">name</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">wild-pathname-p</span> <span class="nb">pathname</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">error</span> <span class="s">"Can't reliably convert wild pathnames."</span><span class="p">))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">directory-pathname-p</span> <span class="nv">name</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nb">directory</span> <span class="p">(</span><span class="nb">pathname-directory</span> <span class="nb">pathname</span><span class="p">))</span>
             <span class="p">(</span><span class="nv">name-and-type</span> <span class="p">(</span><span class="nb">pathname</span> <span class="p">(</span><span class="nb">first</span> <span class="p">(</span><span class="nb">last</span> <span class="nb">directory</span><span class="p">)))))</span>
        <span class="p">(</span><span class="nb">make-pathname</span>
         <span class="ss">:directory</span> <span class="p">(</span><span class="nb">butlast</span> <span class="nb">directory</span><span class="p">)</span>
         <span class="ss">:name</span> <span class="p">(</span><span class="nb">pathname-name</span> <span class="nv">name-and-type</span><span class="p">)</span>
         <span class="ss">:type</span> <span class="p">(</span><span class="nb">pathname-type</span> <span class="nv">name-and-type</span><span class="p">)</span>
         <span class="ss">:defaults</span> <span class="nb">pathname</span><span class="p">))</span>
      <span class="nb">pathname</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">walk-directory</span> <span class="p">(</span><span class="nv">dirname</span> <span class="nv">fn</span> <span class="k">&amp;key</span> <span class="nv">directories</span> <span class="p">(</span><span class="nv">test</span> <span class="p">(</span><span class="nb">constantly</span> <span class="no">t</span><span class="p">)))</span>
  <span class="s">"Walk a directory invoking `fn' on each pathname found. If `test' is
supplied fn is invoked only on pathnames for which `test' returns
true. If `directories' is t invokes `test' and `fn' on directory
pathnames as well."</span>
  <span class="p">(</span><span class="k">labels</span>
      <span class="p">((</span><span class="nv">walk</span> <span class="p">(</span><span class="nv">name</span><span class="p">)</span>
         <span class="p">(</span><span class="nb">cond</span>
           <span class="p">((</span><span class="nv">directory-pathname-p</span> <span class="nv">name</span><span class="p">)</span>
            <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">and</span> <span class="nv">directories</span> <span class="p">(</span><span class="nb">funcall</span> <span class="nv">test</span> <span class="nv">name</span><span class="p">))</span>
              <span class="p">(</span><span class="nb">funcall</span> <span class="nv">fn</span> <span class="nv">name</span><span class="p">))</span>
            <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">x</span> <span class="p">(</span><span class="nv">list-directory</span> <span class="nv">name</span><span class="p">))</span> <span class="p">(</span><span class="nv">walk</span> <span class="nv">x</span><span class="p">)))</span>
           <span class="p">((</span><span class="nb">funcall</span> <span class="nv">test</span> <span class="nv">name</span><span class="p">)</span> <span class="p">(</span><span class="nb">funcall</span> <span class="nv">fn</span> <span class="nv">name</span><span class="p">)))))</span>
    <span class="p">(</span><span class="nv">walk</span> <span class="p">(</span><span class="nv">pathname-as-directory</span> <span class="nv">dirname</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">directory-p</span> <span class="p">(</span><span class="nv">name</span><span class="p">)</span>
  <span class="s">"Is `name' the name of an existing directory."</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nb">truename</span> <span class="p">(</span><span class="nv">file-exists-p</span> <span class="nv">name</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">and</span> <span class="nb">truename</span> <span class="p">(</span><span class="nv">directory-pathname-p</span> <span class="nv">name</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">file-p</span> <span class="p">(</span><span class="nv">name</span><span class="p">)</span>
  <span class="s">"Is `name' the name of an existing file, i.e. not a directory."</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nb">truename</span> <span class="p">(</span><span class="nv">file-exists-p</span> <span class="nv">name</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">and</span> <span class="nb">truename</span> <span class="p">(</span><span class="nv">file-pathname-p</span> <span class="nv">name</span><span class="p">))))</span>

</code></pre></div></div>
<h3 id="chapter-23">Chapter 23</h3>

<div class="message">
    A spam filter.
</div>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">print-unreadable-object</span> <span class="p">(</span><span class="nv">OBJECT</span> <span class="nv">STREAM</span> <span class="nv">&amp;KEY</span> <span class="nv">TYPE</span> <span class="nv">IDENTITY</span><span class="p">)</span> <span class="nv">&amp;BODY</span> <span class="nv">BODY</span><span class="p">)</span>
<span class="c1">;; Outputs a printed representation of object on stream, beginning with ``#&lt;'' and ending with ``&gt;''. Everything output to stream by the body forms is enclosed in the the angle brackets. If type is true, the output from forms is preceded by a brief description of the object's type and a space character. If identity is true, the output from forms is followed by a space character and a representation of the object's identity, typically a storage address.</span>
<span class="p">(</span><span class="nb">defmethod</span> <span class="nb">print-object</span> <span class="p">((</span><span class="nv">obj</span> <span class="nv">airplane</span><span class="p">)</span> <span class="nc">stream</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print-unreadable-object</span> <span class="p">(</span><span class="nv">obj</span> <span class="nc">stream</span> <span class="ss">:type</span> <span class="no">t</span> <span class="ss">:identity</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">princ</span> <span class="p">(</span><span class="nv">tail-number</span> <span class="nv">obj</span><span class="p">)</span> <span class="nc">stream</span><span class="p">)))</span>
<span class="p">(</span><span class="nb">prin1-to-string</span> <span class="nv">my-airplane</span><span class="p">)</span>
<span class="nv">=&gt;</span>  <span class="s">"#&lt;Airplane NW0773 36000123135&gt;"</span>
<span class="nv">OR=&gt;</span>  <span class="s">"#&lt;FAA:AIRPLANE NW0773 17&gt;"</span>

<span class="p">(</span><span class="nb">float</span> <span class="nv">NUMBER</span> <span class="nv">&amp;OPTIONAL</span> <span class="p">(</span><span class="nv">OTHER</span> <span class="nv">NIL</span> <span class="nv">OTHER-P</span><span class="p">))</span>
<span class="c1">;; Converts a real number to a float. If a prototype (OTHER) is supplied, a float is returned that is mathematically equal to number but has the same format as prototype.</span>
<span class="p">(</span><span class="nb">eql</span> <span class="p">(</span><span class="nb">float</span> <span class="mf">1.0</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="mf">1.0d0</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="nv">T</span>

<span class="p">(</span><span class="nb">aref</span> <span class="nv">ARRAY</span> <span class="nv">&amp;REST</span> <span class="nv">SUBSCRIPTS</span><span class="p">)</span>
<span class="c1">;; Accesses the array element specified by the subscripts. If no subscripts are supplied and array is zero rank, aref accesses the sole element of array.</span>
<span class="p">(</span><span class="nb">aref</span> <span class="p">(</span><span class="k">setq</span> <span class="nv">beta</span> <span class="p">(</span><span class="nb">make-array</span> <span class="o">'</span><span class="p">(</span><span class="mi">2</span> <span class="mi">4</span><span class="p">)</span>
                             <span class="ss">:element-type</span> <span class="o">'</span><span class="p">(</span><span class="kt">unsigned-byte</span> <span class="mi">2</span><span class="p">)</span>
                             <span class="ss">:initial-contents</span> <span class="o">'</span><span class="p">((</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))))</span>
      <span class="mi">0</span> <span class="mi">2</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="mi">2</span>
<span class="c1">;; The third element of the first row, (0 1 2 3).</span>

<span class="p">(</span><span class="nb">assert</span> <span class="nv">TEST-FORM</span> <span class="nv">&amp;OPTIONAL</span> <span class="nv">PLACES</span> <span class="nv">DATUM</span> <span class="nv">&amp;REST</span> <span class="nv">ARGUMENTS</span> <span class="nv">&amp;ENVIRONMENT</span> <span class="nv">ENV</span><span class="p">)</span>
<span class="c1">;; Assures that test-form evaluates to true. If test-form evaluates to false, assert signals a correctable error (denoted by datum and arguments). Continuing from this error using the continue restart makes it possible for the user to alter the values of the places before assert evaluates test-form again. If the value of test-form is non-nil, assert returns nil.</span>
</code></pre></div></div>

<h3 id="common-lisp-portable-perl-compatible-regular-expression-cl-ppcre">Common Lisp Portable Perl-Compatible Regular Expression (CL-PPCRE)</h3>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nv">cl-ppcre:all-matches-as-strings</span> <span class="s">"[a-zA-Z]{3,}"</span> <span class="nv">text</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="print-objects">Print Objects</h4>

<p>Printing of all objects is implemented in terms of a generic function PRINT-OBJECT. To make implementing such methods easier, Common Lisp provides the macro PRINT-UNREADABLE-OBJECT. The main reason to use PRINT-UNREADABLE-OBJECT is that it takes care of signaling the appropriate error if someone tries to print your object readably, such as with the ~S FORMAT directive.</p>

<h3 id="case-ccase-ecase">CASE CCASE ECASE</h3>

<p><em>case</em></p>

<p>case keyform {normal-clause}* [otherwise-clause]</p>

<p>If no normal-clause matches, and there is an otherwise-clause, then that otherwise-clause automatically matches; the forms in that clause are evaluated as an implicit progn, and the values it returns are returned as the value of the case.</p>

<p>If there is no otherwise-clause, case returns nil.</p>

<p><em>ccase</em>
ccase keyplace {normal-clause}*</p>

<p>If no normal-clause matches, a correctable error of type type-error is signaled. The offending datum is the test-key and the expected type is type equivalent to (member key1 key2 …). The store-value restart can be used to correct the error.</p>

<p>If the store-value restart is invoked, its argument becomes the new test-key, and is stored in keyplace as if by (setf keyplace test-key). Then ccase starts over, considering each clause anew.</p>

<p>The subforms of keyplace might be evaluated again if none of the cases holds.</p>

<p><em>ecase</em></p>

<p>ecase keyform {normal-clause}*</p>

<p>If no normal-clause matches, a non-correctable error of type type-error is signaled. The offending datum is the test-key and the expected type is type equivalent to (member key1 key2 …).</p>

<p>Note that in contrast with ccase, the caller of ecase may rely on the fact that ecase does not return if a normal-clause does not match.</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">defun</span> <span class="nv">test-case</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">case</span> <span class="nv">x</span>
     <span class="p">((</span><span class="nv">i</span> <span class="nv">uno</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
     <span class="p">((</span><span class="nv">ii</span> <span class="nv">dos</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
     <span class="p">((</span><span class="nv">iii</span> <span class="nv">tres</span><span class="p">)</span> <span class="mi">3</span><span class="p">)</span>
     <span class="p">((</span><span class="nv">iv</span> <span class="nv">cuatro</span><span class="p">)</span> <span class="mi">4</span><span class="p">)))</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">test-ccase</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">ccase</span> <span class="nv">x</span>
     <span class="p">((</span><span class="nv">i</span> <span class="nv">uno</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
     <span class="p">((</span><span class="nv">ii</span> <span class="nv">dos</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
     <span class="p">((</span><span class="nv">iii</span> <span class="nv">tres</span><span class="p">)</span> <span class="mi">3</span><span class="p">)</span>
     <span class="p">((</span><span class="nv">iv</span> <span class="nv">cuatro</span><span class="p">)</span> <span class="mi">4</span><span class="p">)))</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">test-ecase</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
   <span class="p">(</span><span class="nb">ccase</span> <span class="nv">x</span>
     <span class="p">((</span><span class="nv">i</span> <span class="nv">uno</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
     <span class="p">((</span><span class="nv">ii</span> <span class="nv">dos</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
     <span class="p">((</span><span class="nv">iii</span> <span class="nv">tres</span><span class="p">)</span> <span class="mi">3</span><span class="p">)</span>
     <span class="p">((</span><span class="nv">iv</span> <span class="nv">cuatro</span><span class="p">)</span> <span class="mi">4</span><span class="p">)))</span>

<span class="p">(</span><span class="nv">test-case</span> <span class="nv">dos</span><span class="p">)</span> <span class="nv">=&gt;</span> <span class="mi">2</span>
<span class="p">(</span><span class="nv">test-ccase</span> <span class="nv">iiii</span><span class="p">)</span> <span class="nv">=&gt;</span> <span class="nv">ERROR</span>
<span class="p">(</span><span class="nv">test-ecae</span> <span class="nv">iiii</span><span class="p">)</span> <span class="nv">=&gt;</span> <span class="nv">ERROR</span>
</code></pre></div></div>

<h4 id="source-code-1">Source Code</h4>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">defvar</span> <span class="vg">*feature-database*</span> <span class="p">(</span><span class="nb">make-hash-table</span> <span class="ss">:test</span> <span class="nf">#'</span><span class="nb">equal</span><span class="p">))</span>
<span class="p">(</span><span class="nb">defvar</span> <span class="vg">*total-spams*</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">(</span><span class="nb">defvar</span> <span class="vg">*total-hams*</span> <span class="mi">0</span><span class="p">)</span>

<span class="p">(</span><span class="nb">defparameter</span> <span class="vg">*max-ham-score*</span> <span class="mf">.4</span><span class="p">)</span>
<span class="p">(</span><span class="nb">defparameter</span> <span class="vg">*min-spam-score*</span> <span class="mf">.6</span><span class="p">)</span>

<span class="p">(</span><span class="nb">defparameter</span> <span class="vg">*max-chars*</span> <span class="p">(</span><span class="nb">*</span> <span class="mi">10</span> <span class="mi">1024</span><span class="p">))</span>
<span class="p">(</span><span class="nb">defparameter</span> <span class="vg">*corpus*</span> <span class="p">(</span><span class="nb">make-array</span> <span class="mi">1000</span> <span class="ss">:adjustable</span> <span class="no">t</span> <span class="ss">:fill-pointer</span> <span class="mi">0</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">classify</span> <span class="p">(</span><span class="nv">text</span><span class="p">)</span>
  <span class="s">"Classify the text of a message as SPAM, HAM, or UNSURE."</span>
  <span class="p">(</span><span class="nv">classification</span> <span class="p">(</span><span class="nv">score</span> <span class="p">(</span><span class="nv">extract-features</span> <span class="nv">text</span><span class="p">))))</span>


<span class="p">(</span><span class="nb">defclass</span> <span class="nv">word-feature</span> <span class="p">()</span>
  <span class="p">((</span><span class="nv">word</span>
    <span class="ss">:initarg</span> <span class="ss">:word</span>
    <span class="ss">:accessor</span> <span class="nv">word</span>
    <span class="ss">:initform</span> <span class="p">(</span><span class="nb">error</span> <span class="s">"Must supply :word"</span><span class="p">)</span>
    <span class="ss">:documentation</span> <span class="s">"The word this feature represents."</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">spam-count</span>
    <span class="ss">:initarg</span> <span class="ss">:spam-count</span>
    <span class="ss">:accessor</span> <span class="nv">spam-count</span>
    <span class="ss">:initform</span> <span class="mi">0</span>
    <span class="ss">:documentation</span> <span class="s">"Number of spams we have seen this feature in."</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">ham-count</span>
    <span class="ss">:initarg</span> <span class="ss">:ham-count</span>
    <span class="ss">:accessor</span> <span class="nv">ham-count</span>
    <span class="ss">:initform</span> <span class="mi">0</span>
    <span class="ss">:documentation</span> <span class="s">"Number of hams we have seen this feature in."</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">intern-feature</span> <span class="p">(</span><span class="nv">word</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nb">gethash</span> <span class="nv">word</span> <span class="vg">*feature-database*</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">setf</span> <span class="p">(</span><span class="nb">gethash</span> <span class="nv">word</span> <span class="vg">*feature-database*</span><span class="p">)</span>
            <span class="p">(</span><span class="nb">make-instance</span> <span class="ss">'word-feature</span> <span class="ss">:word</span> <span class="nv">word</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">extract-words</span> <span class="p">(</span><span class="nv">text</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">delete-duplicates</span>
   <span class="p">(</span><span class="nv">cl-ppcre:all-matches-as-strings</span> <span class="s">"[a-zA-Z]{3,}"</span> <span class="nv">text</span><span class="p">)</span>
   <span class="ss">:test</span> <span class="nf">#'</span><span class="nb">string=</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">extract-features</span> <span class="p">(</span><span class="nv">text</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">mapcar</span> <span class="nf">#'</span><span class="nv">intern-feature</span> <span class="p">(</span><span class="nv">extract-words</span> <span class="nv">text</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defmethod</span> <span class="nb">print-object</span> <span class="p">((</span><span class="nv">object</span> <span class="nv">word-feature</span><span class="p">)</span> <span class="nc">stream</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print-unreadable-object</span> <span class="p">(</span><span class="nv">object</span> <span class="nc">stream</span> <span class="ss">:type</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">with-slots</span> <span class="p">(</span><span class="nv">word</span> <span class="nv">ham-count</span> <span class="nv">spam-count</span><span class="p">)</span> <span class="nv">object</span>
      <span class="p">(</span><span class="nb">format</span> <span class="nc">stream</span> <span class="s">"~s :hams ~d :spams ~d"</span> <span class="nv">word</span> <span class="nv">ham-count</span> <span class="nv">spam-count</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">train</span> <span class="p">(</span><span class="nv">text</span> <span class="k">type</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">feature</span> <span class="p">(</span><span class="nv">extract-features</span> <span class="nv">text</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">increment-count</span> <span class="nv">feature</span> <span class="k">type</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">increment-total-count</span> <span class="k">type</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">increment-count</span> <span class="p">(</span><span class="nv">feature</span> <span class="k">type</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">ecase</span> <span class="k">type</span>
    <span class="nv">n</span>    <span class="p">(</span><span class="nv">ham</span> <span class="p">(</span><span class="nb">incf</span> <span class="p">(</span><span class="nv">ham-count</span> <span class="nv">feature</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">spam</span> <span class="p">(</span><span class="nb">incf</span> <span class="p">(</span><span class="nv">spam-count</span> <span class="nv">feature</span><span class="p">)))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">increment-total-count</span> <span class="p">(</span><span class="k">type</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">ecase</span> <span class="k">type</span>
    <span class="p">(</span><span class="nv">ham</span> <span class="p">(</span><span class="nb">incf</span> <span class="vg">*total-hams*</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">spam</span> <span class="p">(</span><span class="nb">incf</span> <span class="vg">*total-spams*</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">clear-database</span> <span class="p">()</span>
  <span class="p">(</span><span class="nb">setf</span>
   <span class="vg">*feature-database*</span> <span class="p">(</span><span class="nb">make-hash-table</span> <span class="ss">:test</span> <span class="nf">#'</span><span class="nb">equal</span><span class="p">)</span>
   <span class="vg">*total-spams*</span> <span class="mi">0</span>
   <span class="vg">*total-hams*</span> <span class="mi">0</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">spam-probability</span> <span class="p">(</span><span class="nv">feature</span><span class="p">)</span>
  <span class="s">"Basic probability that a feature with the given relative
frequencies will appear in a spam assuming spams and hams are
otherwise equally probable. One of the two frequencies must be
non-zero."</span>
  <span class="p">(</span><span class="nb">with-slots</span> <span class="p">(</span><span class="nv">spam-count</span> <span class="nv">ham-count</span><span class="p">)</span> <span class="nv">feature</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">spam-frequency</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">spam-count</span> <span class="p">(</span><span class="nb">max</span> <span class="mi">1</span> <span class="vg">*total-spams*</span><span class="p">)))</span>
          <span class="p">(</span><span class="nv">ham-frequency</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">ham-count</span> <span class="p">(</span><span class="nb">max</span> <span class="mi">1</span> <span class="vg">*total-hams*</span><span class="p">))))</span>
      <span class="p">(</span><span class="nb">/</span> <span class="nv">spam-frequency</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">spam-frequency</span> <span class="nv">ham-frequency</span><span class="p">)))))</span>


<span class="p">(</span><span class="nb">defun</span> <span class="nv">bayesian-spam-probability</span> <span class="p">(</span><span class="nv">feature</span> <span class="k">&amp;optional</span>
                                            <span class="p">(</span><span class="nv">assumed-probability</span> <span class="mi">1/2</span><span class="p">)</span>
                                            <span class="p">(</span><span class="nv">weight</span> <span class="mi">1</span><span class="p">))</span>
  <span class="s">"Bayesian adjustment of a given probability given the number of
data points that went into it, an assumed probability, and a
weight we give that assumed probability."</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">basic-probability</span> <span class="p">(</span><span class="nv">spam-probability</span> <span class="nv">feature</span><span class="p">))</span>
        <span class="p">(</span><span class="nv">data-points</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nv">spam-count</span> <span class="nv">feature</span><span class="p">)</span> <span class="p">(</span><span class="nv">ham-count</span> <span class="nv">feature</span><span class="p">))))</span>
    <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">weight</span> <span class="nv">assumed-probability</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">*</span> <span class="nv">data-points</span> <span class="nv">basic-probability</span><span class="p">))</span>
       <span class="p">(</span><span class="nb">+</span> <span class="nv">weight</span> <span class="nv">data-points</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">score</span> <span class="p">(</span><span class="nv">features</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">spam-probs</span> <span class="p">())</span> <span class="p">(</span><span class="nv">ham-probs</span> <span class="p">())</span> <span class="p">(</span><span class="nv">number-of-probs</span> <span class="mi">0</span><span class="p">))</span>
    <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">feature</span> <span class="nv">features</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">untrained-p</span> <span class="nv">feature</span><span class="p">)</span>
        <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">spam-prob</span> <span class="p">(</span><span class="nb">float</span> <span class="p">(</span><span class="nv">bayesian-spam-probability</span> <span class="nv">feature</span><span class="p">)</span> <span class="mf">0.0d0</span><span class="p">)))</span>
          <span class="p">(</span><span class="nb">push</span> <span class="nv">spam-prob</span> <span class="nv">spam-probs</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">push</span> <span class="p">(</span><span class="nb">-</span> <span class="mf">1.0d0</span> <span class="nv">spam-prob</span><span class="p">)</span> <span class="nv">ham-probs</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">incf</span> <span class="nv">number-of-probs</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">h</span> <span class="p">(</span><span class="nb">-</span> <span class="mi">1</span> <span class="p">(</span><span class="nv">fisher</span> <span class="nv">spam-probs</span> <span class="nv">number-of-probs</span><span class="p">)))</span>
          <span class="p">(</span><span class="nv">s</span> <span class="p">(</span><span class="nb">-</span> <span class="mi">1</span> <span class="p">(</span><span class="nv">fisher</span> <span class="nv">ham-probs</span> <span class="nv">number-of-probs</span><span class="p">))))</span>
      <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nb">-</span> <span class="mi">1</span> <span class="nv">h</span><span class="p">)</span> <span class="nv">s</span><span class="p">)</span> <span class="mf">2.0d0</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">untrained-p</span> <span class="p">(</span><span class="nv">feature</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">with-slots</span> <span class="p">(</span><span class="nv">spam-count</span> <span class="nv">ham-count</span><span class="p">)</span> <span class="nv">feature</span>
    <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nb">zerop</span> <span class="nv">spam-count</span><span class="p">)</span> <span class="p">(</span><span class="nb">zerop</span> <span class="nv">ham-count</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">fisher</span> <span class="p">(</span><span class="nv">probs</span> <span class="nv">number-of-probs</span><span class="p">)</span>
  <span class="s">"The Fisher computation described by Robinson."</span>
  <span class="p">(</span><span class="nv">inverse-chi-square</span>
   <span class="p">(</span><span class="nb">*</span> <span class="mi">-2</span> <span class="p">(</span><span class="nb">reduce</span> <span class="nf">#'</span><span class="nb">+</span> <span class="nv">probs</span> <span class="ss">:key</span> <span class="nf">#'</span><span class="nb">log</span><span class="p">))</span>
   <span class="p">(</span><span class="nb">*</span> <span class="mi">2</span> <span class="nv">number-of-probs</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">inverse-chi-square</span> <span class="p">(</span><span class="nv">value</span> <span class="nv">degrees-of-freedom</span><span class="p">)</span>
  <span class="s">"Probability that chi-square &gt;= value with given degrees-of-freedom.
Based on Gary Robinson's Python implementation."</span>
  <span class="p">(</span><span class="nb">assert</span> <span class="p">(</span><span class="nb">evenp</span> <span class="nv">degrees-of-freedom</span><span class="p">))</span>
  <span class="c1">;; Due to rounding errors in the multiplication and exponentiation</span>
  <span class="c1">;; the sum computed in the loop may end up a shade above 1.0 which</span>
  <span class="c1">;; we can't have since it's supposed to represent a probability.</span>
  <span class="p">(</span><span class="nb">min</span>
   <span class="p">(</span><span class="nb">loop</span> <span class="nv">with</span> <span class="nv">m</span> <span class="nb">=</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">value</span> <span class="mi">2</span><span class="p">)</span>
      <span class="nv">for</span> <span class="nv">i</span> <span class="nv">below</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">degrees-of-freedom</span> <span class="mi">2</span><span class="p">)</span>
      <span class="nv">for</span> <span class="nv">prob</span> <span class="nb">=</span> <span class="p">(</span><span class="nb">exp</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">m</span><span class="p">))</span> <span class="nv">then</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">prob</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">m</span> <span class="nv">i</span><span class="p">))</span>
      <span class="nv">summing</span> <span class="nv">prob</span><span class="p">)</span>
   <span class="mf">1.0</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">classification</span> <span class="p">(</span><span class="nv">score</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">values</span>
   <span class="p">(</span><span class="nb">cond</span>
     <span class="p">((</span><span class="nb">&lt;=</span> <span class="nv">score</span> <span class="vg">*max-ham-score*</span><span class="p">)</span> <span class="ss">'ham</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">&gt;=</span> <span class="nv">score</span> <span class="vg">*min-spam-score*</span><span class="p">)</span> <span class="ss">'spam</span><span class="p">)</span>
     <span class="p">(</span><span class="no">t</span> <span class="ss">'unsure</span><span class="p">))</span>
   <span class="nv">score</span><span class="p">))</span>


<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;;; Test rig</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">add-file-to-corpus</span> <span class="p">(</span><span class="nv">filename</span> <span class="k">type</span> <span class="nv">corpus</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">vector-push-extend</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">filename</span> <span class="k">type</span><span class="p">)</span> <span class="nv">corpus</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">add-directory-to-corpus</span> <span class="p">(</span><span class="nv">dir</span> <span class="k">type</span> <span class="nv">corpus</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">filename</span> <span class="p">(</span><span class="nv">list-directory</span> <span class="nv">dir</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">add-file-to-corpus</span> <span class="nv">filename</span> <span class="k">type</span> <span class="nv">corpus</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">test-classifier</span> <span class="p">(</span><span class="nv">corpus</span> <span class="nv">testing-fraction</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">clear-database</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">shuffled</span> <span class="p">(</span><span class="nv">shuffle-vector</span> <span class="nv">corpus</span><span class="p">))</span>
         <span class="p">(</span><span class="nv">size</span> <span class="p">(</span><span class="nb">length</span> <span class="nv">corpus</span><span class="p">))</span>
         <span class="p">(</span><span class="nv">train-on</span> <span class="p">(</span><span class="nb">floor</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">size</span> <span class="p">(</span><span class="nb">-</span> <span class="mi">1</span> <span class="nv">testing-fraction</span><span class="p">)))))</span>
    <span class="p">(</span><span class="nv">train-from-corpus</span> <span class="nv">shuffled</span> <span class="ss">:start</span> <span class="mi">0</span> <span class="ss">:end</span> <span class="nv">train-on</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">test-from-corpus</span> <span class="nv">shuffled</span> <span class="ss">:start</span> <span class="nv">train-on</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">train-from-corpus</span> <span class="p">(</span><span class="nv">corpus</span> <span class="k">&amp;key</span> <span class="p">(</span><span class="nv">start</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">end</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">idx</span> <span class="nv">from</span> <span class="nv">start</span> <span class="nv">below</span> <span class="p">(</span><span class="nb">or</span> <span class="nv">end</span> <span class="p">(</span><span class="nb">length</span> <span class="nv">corpus</span><span class="p">))</span> <span class="nb">do</span>
        <span class="p">(</span><span class="nb">destructuring-bind</span> <span class="p">(</span><span class="nv">file</span> <span class="k">type</span><span class="p">)</span> <span class="p">(</span><span class="nb">aref</span> <span class="nv">corpus</span> <span class="nv">idx</span><span class="p">)</span>
          <span class="p">(</span><span class="nv">train</span> <span class="p">(</span><span class="nv">start-of-file</span> <span class="nv">file</span> <span class="vg">*max-chars*</span><span class="p">)</span> <span class="k">type</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">test-from-corpus</span> <span class="p">(</span><span class="nv">corpus</span> <span class="k">&amp;key</span> <span class="p">(</span><span class="nv">start</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">end</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">idx</span> <span class="nv">from</span> <span class="nv">start</span> <span class="nv">below</span> <span class="p">(</span><span class="nb">or</span> <span class="nv">end</span> <span class="p">(</span><span class="nb">length</span> <span class="nv">corpus</span><span class="p">))</span> <span class="nv">collect</span>
        <span class="p">(</span><span class="nb">destructuring-bind</span> <span class="p">(</span><span class="nv">file</span> <span class="k">type</span><span class="p">)</span> <span class="p">(</span><span class="nb">aref</span> <span class="nv">corpus</span> <span class="nv">idx</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">multiple-value-bind</span> <span class="p">(</span><span class="nv">classification</span> <span class="nv">score</span><span class="p">)</span>
              <span class="p">(</span><span class="nv">classify</span> <span class="p">(</span><span class="nv">start-of-file</span> <span class="nv">file</span> <span class="vg">*max-chars*</span><span class="p">))</span>
            <span class="p">(</span><span class="nb">list</span>
             <span class="ss">:file</span> <span class="nv">file</span>
             <span class="ss">:type</span> <span class="k">type</span>
             <span class="ss">:classification</span> <span class="nv">classification</span>
             <span class="ss">:score</span> <span class="nv">score</span><span class="p">)))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">nshuffle-vector</span> <span class="p">(</span><span class="nb">vector</span><span class="p">)</span>
  <span class="s">"Shuffle a vector in place using Fisher-Yates algorithm."</span>
  <span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">idx</span> <span class="nv">downfrom</span> <span class="p">(</span><span class="nb">1-</span> <span class="p">(</span><span class="nb">length</span> <span class="nb">vector</span><span class="p">))</span> <span class="nv">to</span> <span class="mi">1</span>
        <span class="nv">for</span> <span class="nv">other</span> <span class="nb">=</span> <span class="p">(</span><span class="nb">random</span> <span class="p">(</span><span class="nb">1+</span> <span class="nv">idx</span><span class="p">))</span>
        <span class="nb">do</span> <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">idx</span> <span class="nv">other</span><span class="p">)</span>
             <span class="p">(</span><span class="nb">rotatef</span> <span class="p">(</span><span class="nb">aref</span> <span class="nb">vector</span> <span class="nv">idx</span><span class="p">)</span> <span class="p">(</span><span class="nb">aref</span> <span class="nb">vector</span> <span class="nv">other</span><span class="p">))))</span>
  <span class="nb">vector</span><span class="p">)</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">shuffle-vector</span> <span class="p">(</span><span class="nb">vector</span><span class="p">)</span>
  <span class="s">"Return a shuffled copy of vector."</span>
  <span class="p">(</span><span class="nv">nshuffle-vector</span> <span class="p">(</span><span class="nb">copy-seq</span> <span class="nb">vector</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">start-of-file</span> <span class="p">(</span><span class="nv">file</span> <span class="nv">max-chars</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">with-open-file</span> <span class="p">(</span><span class="nv">in</span> <span class="nv">file</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nb">length</span> <span class="p">(</span><span class="nb">min</span> <span class="p">(</span><span class="nb">file-length</span> <span class="nv">in</span><span class="p">)</span> <span class="nv">max-chars</span><span class="p">))</span>
           <span class="p">(</span><span class="nv">text</span> <span class="p">(</span><span class="nb">make-string</span> <span class="nb">length</span><span class="p">))</span>
           <span class="p">(</span><span class="nb">read</span> <span class="p">(</span><span class="nb">read-sequence</span> <span class="nv">text</span> <span class="nv">in</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nb">read</span> <span class="nb">length</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">subseq</span> <span class="nv">text</span> <span class="mi">0</span> <span class="nb">read</span><span class="p">)</span>
        <span class="nv">text</span><span class="p">))))</span>


<span class="p">(</span><span class="nb">defun</span> <span class="nv">result-type</span> <span class="p">(</span><span class="nv">result</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">destructuring-bind</span> <span class="p">(</span><span class="k">&amp;key</span> <span class="k">type</span> <span class="nv">classification</span> <span class="k">&amp;allow-other-keys</span><span class="p">)</span> <span class="nv">result</span>
    <span class="p">(</span><span class="nb">ecase</span> <span class="k">type</span>
      <span class="p">(</span><span class="nv">ham</span>
       <span class="p">(</span><span class="nb">ecase</span> <span class="nv">classification</span>
         <span class="p">(</span><span class="nv">ham</span> <span class="ss">'correct</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">spam</span> <span class="ss">'false-positive</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">unsure</span> <span class="ss">'missed-ham</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">spam</span>
       <span class="p">(</span><span class="nb">ecase</span> <span class="nv">classification</span>
         <span class="p">(</span><span class="nv">ham</span> <span class="ss">'false-negative</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">spam</span> <span class="ss">'correct</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">unsure</span> <span class="ss">'missed-spam</span><span class="p">))))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">false-positive-p</span> <span class="p">(</span><span class="nv">result</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">eql</span> <span class="p">(</span><span class="nv">result-type</span> <span class="nv">result</span><span class="p">)</span> <span class="ss">'false-positive</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">false-negative-p</span> <span class="p">(</span><span class="nv">result</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">eql</span> <span class="p">(</span><span class="nv">result-type</span> <span class="nv">result</span><span class="p">)</span> <span class="ss">'false-negative</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">missed-ham-p</span> <span class="p">(</span><span class="nv">result</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">eql</span> <span class="p">(</span><span class="nv">result-type</span> <span class="nv">result</span><span class="p">)</span> <span class="ss">'missed-ham</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">missed-spam-p</span> <span class="p">(</span><span class="nv">result</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">eql</span> <span class="p">(</span><span class="nv">result-type</span> <span class="nv">result</span><span class="p">)</span> <span class="ss">'missed-spam</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">correct-p</span> <span class="p">(</span><span class="nv">result</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">eql</span> <span class="p">(</span><span class="nv">result-type</span> <span class="nv">result</span><span class="p">)</span> <span class="ss">'correct</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">analyze-results</span> <span class="p">(</span><span class="nv">results</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">keys</span> <span class="o">'</span><span class="p">(</span><span class="nv">total</span> <span class="nv">correct</span> <span class="nv">false-positive</span>
                 <span class="nv">false-negative</span> <span class="nv">missed-ham</span> <span class="nv">missed-spam</span><span class="p">))</span>
         <span class="p">(</span><span class="nv">counts</span> <span class="p">(</span><span class="nb">loop</span> <span class="nv">for</span> <span class="nv">x</span> <span class="nv">in</span> <span class="nv">keys</span> <span class="nv">collect</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">x</span> <span class="mi">0</span><span class="p">))))</span>
    <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">item</span> <span class="nv">results</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">incf</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">assoc</span> <span class="ss">'total</span> <span class="nv">counts</span><span class="p">)))</span>
      <span class="p">(</span><span class="nb">incf</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">assoc</span> <span class="p">(</span><span class="nv">result-type</span> <span class="nv">item</span><span class="p">)</span> <span class="nv">counts</span><span class="p">))))</span>
    <span class="p">(</span><span class="nb">loop</span> <span class="nv">with</span> <span class="nv">total</span> <span class="nb">=</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">assoc</span> <span class="ss">'total</span> <span class="nv">counts</span><span class="p">))</span>
          <span class="nv">for</span> <span class="p">(</span><span class="nv">label</span> <span class="o">.</span> <span class="nb">count</span><span class="p">)</span> <span class="nv">in</span> <span class="nv">counts</span>
          <span class="nb">do</span> <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"~&amp;~@(~a~):~20t~5d~,5t: ~6,2f%~%"</span>
                     <span class="nv">label</span> <span class="nb">count</span> <span class="p">(</span><span class="nb">*</span> <span class="mi">100</span> <span class="p">(</span><span class="nb">/</span> <span class="nb">count</span> <span class="nv">total</span><span class="p">))))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">explain-classification</span> <span class="p">(</span><span class="nv">file</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">text</span> <span class="p">(</span><span class="nv">start-of-file</span> <span class="nv">file</span> <span class="vg">*max-chars*</span><span class="p">))</span>
         <span class="p">(</span><span class="nv">features</span> <span class="p">(</span><span class="nv">extract-features</span> <span class="nv">text</span><span class="p">))</span>
         <span class="p">(</span><span class="nv">score</span> <span class="p">(</span><span class="nv">score</span> <span class="nv">features</span><span class="p">))</span>
         <span class="p">(</span><span class="nv">classification</span> <span class="p">(</span><span class="nv">classification</span> <span class="nv">score</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">show-summary</span> <span class="nv">file</span> <span class="nv">text</span> <span class="nv">classification</span> <span class="nv">score</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">feature</span> <span class="p">(</span><span class="nv">sorted-interesting</span> <span class="nv">features</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">show-feature</span> <span class="nv">feature</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">show-summary</span> <span class="p">(</span><span class="nv">file</span> <span class="nv">text</span> <span class="nv">classification</span> <span class="nv">score</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"~&amp;~a"</span> <span class="nv">file</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"~2%~a~2%"</span> <span class="nv">text</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"Classified as ~a with score of ~,5f~%"</span> <span class="nv">classification</span> <span class="nv">score</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">show-feature</span> <span class="p">(</span><span class="nv">feature</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">with-slots</span> <span class="p">(</span><span class="nv">word</span> <span class="nv">ham-count</span> <span class="nv">spam-count</span><span class="p">)</span> <span class="nv">feature</span>
    <span class="p">(</span><span class="nb">format</span>
     <span class="no">t</span> <span class="s">"~&amp;~2t~a~30thams: ~5d; spams: ~5d;~,10tprob: ~,f~%"</span>
     <span class="nv">word</span> <span class="nv">ham-count</span> <span class="nv">spam-count</span> <span class="p">(</span><span class="nv">bayesian-spam-probability</span> <span class="nv">feature</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">sorted-interesting</span> <span class="p">(</span><span class="nv">features</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">sort</span> <span class="p">(</span><span class="nb">remove-if</span> <span class="nf">#'</span><span class="nv">untrained-p</span> <span class="nv">features</span><span class="p">)</span> <span class="nf">#'</span><span class="nb">&lt;</span> <span class="ss">:key</span> <span class="nf">#'</span><span class="nv">bayesian-spam-probability</span><span class="p">))</span>

</code></pre></div></div>

<h2 id="acl-notes">ACL Notes</h2>
<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;; 1. LEXICAL CLOUJURE!</span>

<span class="c1">;; 2. VALUES! Muiltiple return value.</span>

<span class="c1">;; 3. Macro Characters.</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">read-from-string</span> <span class="s">"'a"</span><span class="p">))</span>
<span class="nv">QUOTE</span>

<span class="c1">;; 4. SYMBOLS.</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">symbol-name</span> <span class="ss">'abc</span><span class="p">)</span>
<span class="s">"ABC"</span>
<span class="c1">;; Any sequences of characters between vertical bar is regarded as symbols.</span>
<span class="nv">CL-USER&gt;</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'|Relax|</span> <span class="ss">'|you|</span> <span class="ss">'|GUYS|</span> <span class="ss">'|123|</span> <span class="ss">'|Ansi Common Lisp|</span><span class="p">)</span>
<span class="p">(</span><span class="nv">|Relax|</span> <span class="nv">|you|</span> <span class="nv">GUYS</span> <span class="nv">|123|</span> <span class="nv">|Ansi Common Lisp|</span><span class="p">)</span>

<span class="c1">;; The first time a symbol introduced in a package, it would be INTERNed into the packages, usually, COMMON-LISP-USER. Uninterned symbols is called GENSYMS.</span>

<span class="c1">;; 5. EVAL</span>
<span class="c1">;; EVAL processes on raw list. The raw list will be either compiled next step or interperted, resulting a low performance.</span>
<span class="c1">;; Evaluate without lexical context, causing LET and LET* lose efficacy.</span>

<span class="c1">;; 6. Two Models *</span>

<span class="c1">;; (1) Message-passing model</span>

<span class="c1">;; (2) Generic function model</span>

<span class="c1">;; 6. Interactive VS. Interpreted</span>

<span class="c1">;; 7. Debugging</span>

<span class="c1">;; Break loops.</span>

<span class="c1">;; Traces and backtraces</span>

<span class="p">(</span><span class="nb">trace</span> <span class="nv">foo</span><span class="p">)</span>
<span class="p">(</span><span class="nb">untrace</span> <span class="nv">foo</span><span class="p">)</span>

<span class="c1">;; When nothing happens</span>

<span class="c1">;; No value/Unbound</span>

<span class="c1">;; Unexpected nils.</span>

<span class="p">(</span><span class="nb">ecase</span> <span class="o">...</span><span class="p">)</span>

<span class="c1">;; Renaming</span>

<span class="c1">;; Keywords as optional parameters</span>

<span class="c1">;; Misdeclarations</span>
</code></pre></div></div>
<h3 id="html-generator">HTML Generator</h3>
<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;;;; An Example of Bottom-up Programming</span>

<span class="c1">;;; Html Utilities</span>
<span class="p">(</span><span class="nb">defmacro</span> <span class="nv">as</span> <span class="p">(</span><span class="nv">tag</span> <span class="nv">content</span><span class="p">)</span>
  <span class="o">`</span><span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"&lt;~(~A~)&gt;~A&lt;/~(~A~)&gt;"</span>
           <span class="ss">',tag</span> <span class="o">,</span><span class="nv">content</span> <span class="ss">',tag</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defmacro</span> <span class="nv">with</span> <span class="p">(</span><span class="nv">tag</span> <span class="k">&amp;rest</span> <span class="nv">body</span><span class="p">)</span>
  <span class="o">`</span><span class="p">(</span><span class="k">progn</span>
     <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"~&amp;&lt;~(~A~)&gt;~%"</span> <span class="ss">',tag</span><span class="p">)</span>
     <span class="o">,@</span><span class="nv">body</span>
     <span class="p">(</span><span class="nb">format</span> <span class="no">t</span> <span class="s">"~&amp;&lt;/~(~A~)&gt;~%"</span> <span class="ss">',tag</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">brs</span> <span class="p">(</span><span class="k">&amp;optional</span> <span class="p">(</span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">fresh-line</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">dotimes</span> <span class="p">(</span><span class="nv">i</span> <span class="nv">n</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">princ</span> <span class="s">"&lt;br&gt;"</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">terpri</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">html-file</span> <span class="p">(</span><span class="nv">base</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">format</span> <span class="no">nil</span> <span class="s">"~(~A~).html"</span> <span class="nv">base</span><span class="p">))</span>

<span class="p">(</span><span class="nb">defmacro</span> <span class="nv">page</span> <span class="p">(</span><span class="nv">name</span> <span class="nv">title</span> <span class="k">&amp;rest</span> <span class="nv">body</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">ti</span> <span class="p">(</span><span class="nb">gensym</span><span class="p">)))</span>
    <span class="o">`</span><span class="p">(</span><span class="nb">with-open-file</span> <span class="p">(</span><span class="vg">*standard-output*</span>
                      <span class="p">(</span><span class="nv">html-file</span> <span class="o">,</span><span class="nv">name</span><span class="p">)</span>
                      <span class="ss">:direction</span> <span class="ss">:output</span>
                      <span class="ss">:if-exist</span> <span class="ss">:supersede</span><span class="p">)</span>
       <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="o">,</span><span class="nv">ti</span> <span class="o">,</span><span class="nv">title</span><span class="p">))</span>
         <span class="p">(</span><span class="nv">as</span> <span class="nv">title</span> <span class="o">,</span><span class="nv">ti</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">with</span> <span class="nv">center</span>
               <span class="p">(</span><span class="nv">as</span> <span class="nv">h2</span> <span class="p">(</span><span class="nb">string-upcase</span> <span class="o">,</span><span class="nv">ti</span><span class="p">)))</span>
         <span class="p">(</span><span class="nv">brs</span> <span class="mi">3</span><span class="p">)</span>
         <span class="o">,@</span><span class="nv">body</span><span class="p">))))</span>
</code></pre></div></div>

</div> <div class="post_list">

</div> 

        </article>
        
      </div>
    </div>
  </body>
</html>
